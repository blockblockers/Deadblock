const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PuzzleSelect-BbNAWsei.js","assets/FloatingPieces-CkGA4VAV.js","assets/timer-CKvbxT7p.js","assets/alert-circle-DwjqkFl6.js","assets/SpeedPuzzleScreen-rYlulggE.js","assets/play-CKcjBX8x.js","assets/DifficultySelector-z7FNP3aQ.js","assets/WeeklyChallengeMenu-BqhD-qPz.js","assets/weeklyChallengeService-C2IcVwpV.js","assets/calendar-UBey0MGi.js","assets/clock-DH6CZMwC.js","assets/WeeklyChallengeScreen-CcMY13-p.js","assets/WeeklyLeaderboard-B1Apot1g.js","assets/PlayerStatsModal-DSH7rXvy.js","assets/pen--CaqYySY.js","assets/trending-up-D4E_By2q.js","assets/OnlineMenu-Zq3I1gHM.js","assets/gameSync-C85scV0-.js","assets/inviteService-DhtWqPFk.js","assets/rematchService-B9FdZ2Mv.js","assets/ViewPlayerProfile-Ds208_10.js","assets/skip-forward-CzNewA36.js","assets/SpectatorView-WDgcaXPl.js","assets/alert-triangle-CdR1lECF.js","assets/search-2i7mNli-.js","assets/share-2-R-aqbu5s.js","assets/MatchmakingScreen-BnYnTXTP.js","assets/OnlineGameScreen-DNkQDosp.js","assets/UserProfile-BElF1E3B.js","assets/Leaderboard-Cfx2t2ZS.js","assets/GameReplay-DyvkTJ-H.js"])))=>i.map(i=>d[i]);
function Ng(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Un=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ri(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var xf={exports:{}},_a={},wf={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $i=Symbol.for("react.element"),Cg=Symbol.for("react.portal"),Pg=Symbol.for("react.fragment"),Ag=Symbol.for("react.strict_mode"),Tg=Symbol.for("react.profiler"),Og=Symbol.for("react.provider"),Ig=Symbol.for("react.context"),Rg=Symbol.for("react.forward_ref"),$g=Symbol.for("react.suspense"),zg=Symbol.for("react.memo"),Lg=Symbol.for("react.lazy"),jd=Symbol.iterator;function Mg(t){return t===null||typeof t!="object"?null:(t=jd&&t[jd]||t["@@iterator"],typeof t=="function"?t:null)}var bf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_f=Object.assign,Sf={};function Es(t,e,r){this.props=t,this.context=e,this.refs=Sf,this.updater=r||bf}Es.prototype.isReactComponent={};Es.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Es.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kf(){}kf.prototype=Es.prototype;function cu(t,e,r){this.props=t,this.context=e,this.refs=Sf,this.updater=r||bf}var uu=cu.prototype=new kf;uu.constructor=cu;_f(uu,Es.prototype);uu.isPureReactComponent=!0;var Nd=Array.isArray,Ef=Object.prototype.hasOwnProperty,du={current:null},jf={key:!0,ref:!0,__self:!0,__source:!0};function Nf(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Ef.call(e,n)&&!jf.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:$i,type:t,key:i,ref:o,props:s,_owner:du.current}}function Dg(t,e){return{$$typeof:$i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hu(t){return typeof t=="object"&&t!==null&&t.$$typeof===$i}function Ug(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Cd=/\/+/g;function Za(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ug(""+t.key):e.toString(36)}function bo(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $i:case Cg:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+Za(o,0):n,Nd(s)?(r="",t!=null&&(r=t.replace(Cd,"$&/")+"/"),bo(s,e,r,"",function(u){return u})):s!=null&&(hu(s)&&(s=Dg(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Cd,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",Nd(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+Za(i,l);o+=bo(i,e,r,c,s)}else if(c=Mg(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+Za(i,l++),o+=bo(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Hi(t,e,r){if(t==null)return t;var n=[],s=0;return bo(t,n,"","",function(i){return e.call(r,i,s++)}),n}function Bg(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vt={current:null},_o={transition:null},Fg={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:_o,ReactCurrentOwner:du};function Cf(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:Hi,forEach:function(t,e,r){Hi(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Hi(t,function(){e++}),e},toArray:function(t){return Hi(t,function(e){return e})||[]},only:function(t){if(!hu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=Es;he.Fragment=Pg;he.Profiler=Tg;he.PureComponent=cu;he.StrictMode=Ag;he.Suspense=$g;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fg;he.act=Cf;he.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=_f({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=du.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Ef.call(e,c)&&!jf.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:$i,type:t.type,key:s,ref:i,props:n,_owner:o}};he.createContext=function(t){return t={$$typeof:Ig,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Og,_context:t},t.Consumer=t};he.createElement=Nf;he.createFactory=function(t){var e=Nf.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:Rg,render:t}};he.isValidElement=hu;he.lazy=function(t){return{$$typeof:Lg,_payload:{_status:-1,_result:t},_init:Bg}};he.memo=function(t,e){return{$$typeof:zg,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=_o.transition;_o.transition={};try{t()}finally{_o.transition=e}};he.unstable_act=Cf;he.useCallback=function(t,e){return vt.current.useCallback(t,e)};he.useContext=function(t){return vt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return vt.current.useDeferredValue(t)};he.useEffect=function(t,e){return vt.current.useEffect(t,e)};he.useId=function(){return vt.current.useId()};he.useImperativeHandle=function(t,e,r){return vt.current.useImperativeHandle(t,e,r)};he.useInsertionEffect=function(t,e){return vt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return vt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return vt.current.useMemo(t,e)};he.useReducer=function(t,e,r){return vt.current.useReducer(t,e,r)};he.useRef=function(t){return vt.current.useRef(t)};he.useState=function(t){return vt.current.useState(t)};he.useSyncExternalStore=function(t,e,r){return vt.current.useSyncExternalStore(t,e,r)};he.useTransition=function(){return vt.current.useTransition()};he.version="18.3.1";wf.exports=he;var w=wf.exports;const Pf=lu(w);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wg=w,Hg=Symbol.for("react.element"),Vg=Symbol.for("react.fragment"),Gg=Object.prototype.hasOwnProperty,qg=Wg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kg={key:!0,ref:!0,__self:!0,__source:!0};function Af(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Gg.call(e,n)&&!Kg.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Hg,type:t,key:i,ref:o,props:s,_owner:qg.current}}_a.Fragment=Vg;_a.jsx=Af;_a.jsxs=Af;xf.exports=_a;var a=xf.exports,Wl={},Tf={exports:{}},Bt={},Of={exports:{}},If={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,A){var L=N.length;N.push(A);e:for(;0<L;){var B=L-1>>>1,te=N[B];if(0<s(te,A))N[B]=A,N[L]=te,L=B;else break e}}function r(N){return N.length===0?null:N[0]}function n(N){if(N.length===0)return null;var A=N[0],L=N.pop();if(L!==A){N[0]=L;e:for(var B=0,te=N.length,H=te>>>1;B<H;){var C=2*(B+1)-1,M=N[C],U=C+1,V=N[U];if(0>s(M,L))U<te&&0>s(V,M)?(N[B]=V,N[U]=L,B=U):(N[B]=M,N[C]=L,B=C);else if(U<te&&0>s(V,L))N[B]=V,N[U]=L,B=U;else break e}}return A}function s(N,A){var L=N.sortIndex-A.sortIndex;return L!==0?L:N.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,v=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(N){for(var A=r(u);A!==null;){if(A.callback===null)n(u);else if(A.startTime<=N)n(u),A.sortIndex=A.expirationTime,e(c,A);else break;A=r(u)}}function b(N){if(x=!1,y(N),!v)if(r(c)!==null)v=!0,I(E);else{var A=r(u);A!==null&&W(b,A.startTime-N)}}function E(N,A){v=!1,x&&(x=!1,g(k),k=-1),p=!0;var L=f;try{for(y(A),h=r(c);h!==null&&(!(h.expirationTime>A)||N&&!Z());){var B=h.callback;if(typeof B=="function"){h.callback=null,f=h.priorityLevel;var te=B(h.expirationTime<=A);A=t.unstable_now(),typeof te=="function"?h.callback=te:h===r(c)&&n(c),y(A)}else n(c);h=r(c)}if(h!==null)var H=!0;else{var C=r(u);C!==null&&W(b,C.startTime-A),H=!1}return H}finally{h=null,f=L,p=!1}}var j=!1,_=null,k=-1,O=5,P=-1;function Z(){return!(t.unstable_now()-P<O)}function K(){if(_!==null){var N=t.unstable_now();P=N;var A=!0;try{A=_(!0,N)}finally{A?ne():(j=!1,_=null)}}else j=!1}var ne;if(typeof m=="function")ne=function(){m(K)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,D=R.port2;R.port1.onmessage=K,ne=function(){D.postMessage(null)}}else ne=function(){S(K,0)};function I(N){_=N,j||(j=!0,ne())}function W(N,A){k=S(function(){N(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,I(E))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(N){switch(f){case 1:case 2:case 3:var A=3;break;default:A=f}var L=f;f=A;try{return N()}finally{f=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,A){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var L=f;f=N;try{return A()}finally{f=L}},t.unstable_scheduleCallback=function(N,A,L){var B=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?B+L:B):L=B,N){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=L+te,N={id:d++,callback:A,priorityLevel:N,startTime:L,expirationTime:te,sortIndex:-1},L>B?(N.sortIndex=L,e(u,N),r(c)===null&&N===r(u)&&(x?(g(k),k=-1):x=!0,W(b,L-B))):(N.sortIndex=te,e(c,N),v||p||(v=!0,I(E))),N},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(N){var A=f;return function(){var L=f;f=A;try{return N.apply(this,arguments)}finally{f=L}}}})(If);Of.exports=If;var Yg=Of.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jg=w,Ut=Yg;function T(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rf=new Set,ui={};function Ln(t,e){gs(t,e),gs(t+"Capture",e)}function gs(t,e){for(ui[t]=e,t=0;t<e.length;t++)Rf.add(e[t])}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hl=Object.prototype.hasOwnProperty,Xg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pd={},Ad={};function Qg(t){return Hl.call(Ad,t)?!0:Hl.call(Pd,t)?!1:Xg.test(t)?Ad[t]=!0:(Pd[t]=!0,!1)}function Zg(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ey(t,e,r,n){if(e===null||typeof e>"u"||Zg(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xt(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new xt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new xt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new xt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new xt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new xt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new xt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new xt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new xt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new xt(t,5,!1,t.toLowerCase(),null,!1,!1)});var fu=/[\-:]([a-z])/g;function pu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fu,pu);ot[e]=new xt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fu,pu);ot[e]=new xt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fu,pu);ot[e]=new xt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new xt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new xt(t,1,!1,t.toLowerCase(),null,!0,!0)});function mu(t,e,r,n){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ey(e,r,s,n)&&(r=null),n||s===null?Qg(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Rr=Jg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vi=Symbol.for("react.element"),Kn=Symbol.for("react.portal"),Yn=Symbol.for("react.fragment"),gu=Symbol.for("react.strict_mode"),Vl=Symbol.for("react.profiler"),$f=Symbol.for("react.provider"),zf=Symbol.for("react.context"),yu=Symbol.for("react.forward_ref"),Gl=Symbol.for("react.suspense"),ql=Symbol.for("react.suspense_list"),vu=Symbol.for("react.memo"),Fr=Symbol.for("react.lazy"),Lf=Symbol.for("react.offscreen"),Td=Symbol.iterator;function Rs(t){return t===null||typeof t!="object"?null:(t=Td&&t[Td]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Object.assign,el;function Gs(t){if(el===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);el=e&&e[1]||""}return`
`+el+t}var tl=!1;function rl(t,e){if(!t||tl)return"";tl=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{tl=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Gs(t):""}function ty(t){switch(t.tag){case 5:return Gs(t.type);case 16:return Gs("Lazy");case 13:return Gs("Suspense");case 19:return Gs("SuspenseList");case 0:case 2:case 15:return t=rl(t.type,!1),t;case 11:return t=rl(t.type.render,!1),t;case 1:return t=rl(t.type,!0),t;default:return""}}function Kl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yn:return"Fragment";case Kn:return"Portal";case Vl:return"Profiler";case gu:return"StrictMode";case Gl:return"Suspense";case ql:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case zf:return(t.displayName||"Context")+".Consumer";case $f:return(t._context.displayName||"Context")+".Provider";case yu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case vu:return e=t.displayName||null,e!==null?e:Kl(t.type)||"Memo";case Fr:e=t._payload,t=t._init;try{return Kl(t(e))}catch{}}return null}function ry(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kl(e);case 8:return e===gu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function sn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Mf(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ny(t){var e=Mf(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gi(t){t._valueTracker||(t._valueTracker=ny(t))}function Df(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Mf(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Do(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yl(t,e){var r=e.checked;return Me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Od(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=sn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uf(t,e){e=e.checked,e!=null&&mu(t,"checked",e,!1)}function Jl(t,e){Uf(t,e);var r=sn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Xl(t,e.type,r):e.hasOwnProperty("defaultValue")&&Xl(t,e.type,sn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Id(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Xl(t,e,r){(e!=="number"||Do(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var qs=Array.isArray;function ls(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+sn(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ql(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(T(91));return Me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rd(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(T(92));if(qs(r)){if(1<r.length)throw Error(T(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:sn(r)}}function Bf(t,e){var r=sn(e.value),n=sn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function $d(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ff(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zl(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ff(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var qi,Wf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(qi=qi||document.createElement("div"),qi.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qi.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function di(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sy=["Webkit","ms","Moz","O"];Object.keys(Zs).forEach(function(t){sy.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Zs[e]=Zs[t]})});function Hf(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Zs.hasOwnProperty(t)&&Zs[t]?(""+e).trim():e+"px"}function Vf(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Hf(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var iy=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ec(t,e){if(e){if(iy[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(T(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(T(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(T(61))}if(e.style!=null&&typeof e.style!="object")throw Error(T(62))}}function tc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rc=null;function xu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var nc=null,cs=null,us=null;function zd(t){if(t=Mi(t)){if(typeof nc!="function")throw Error(T(280));var e=t.stateNode;e&&(e=Na(e),nc(t.stateNode,t.type,e))}}function Gf(t){cs?us?us.push(t):us=[t]:cs=t}function qf(){if(cs){var t=cs,e=us;if(us=cs=null,zd(t),e)for(t=0;t<e.length;t++)zd(e[t])}}function Kf(t,e){return t(e)}function Yf(){}var nl=!1;function Jf(t,e,r){if(nl)return t(e,r);nl=!0;try{return Kf(t,e,r)}finally{nl=!1,(cs!==null||us!==null)&&(Yf(),qf())}}function hi(t,e){var r=t.stateNode;if(r===null)return null;var n=Na(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(T(231,e,typeof r));return r}var sc=!1;if(Pr)try{var $s={};Object.defineProperty($s,"passive",{get:function(){sc=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{sc=!1}function oy(t,e,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var ei=!1,Uo=null,Bo=!1,ic=null,ay={onError:function(t){ei=!0,Uo=t}};function ly(t,e,r,n,s,i,o,l,c){ei=!1,Uo=null,oy.apply(ay,arguments)}function cy(t,e,r,n,s,i,o,l,c){if(ly.apply(this,arguments),ei){if(ei){var u=Uo;ei=!1,Uo=null}else throw Error(T(198));Bo||(Bo=!0,ic=u)}}function Mn(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Xf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ld(t){if(Mn(t)!==t)throw Error(T(188))}function uy(t){var e=t.alternate;if(!e){if(e=Mn(t),e===null)throw Error(T(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Ld(s),t;if(i===n)return Ld(s),e;i=i.sibling}throw Error(T(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(T(189))}}if(r.alternate!==n)throw Error(T(190))}if(r.tag!==3)throw Error(T(188));return r.stateNode.current===r?t:e}function Qf(t){return t=uy(t),t!==null?Zf(t):null}function Zf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Zf(t);if(e!==null)return e;t=t.sibling}return null}var e0=Ut.unstable_scheduleCallback,Md=Ut.unstable_cancelCallback,dy=Ut.unstable_shouldYield,hy=Ut.unstable_requestPaint,We=Ut.unstable_now,fy=Ut.unstable_getCurrentPriorityLevel,wu=Ut.unstable_ImmediatePriority,t0=Ut.unstable_UserBlockingPriority,Fo=Ut.unstable_NormalPriority,py=Ut.unstable_LowPriority,r0=Ut.unstable_IdlePriority,Sa=null,vr=null;function my(t){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(Sa,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:vy,gy=Math.log,yy=Math.LN2;function vy(t){return t>>>=0,t===0?32:31-(gy(t)/yy|0)|0}var Ki=64,Yi=4194304;function Ks(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wo(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Ks(l):(i&=o,i!==0&&(n=Ks(i)))}else o=r&~s,o!==0?n=Ks(o):i!==0&&(n=Ks(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-or(e),s=1<<r,n|=t[r],e&=~s;return n}function xy(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wy(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-or(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=xy(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function oc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function n0(){var t=Ki;return Ki<<=1,!(Ki&4194240)&&(Ki=64),t}function sl(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function zi(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=r}function by(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-or(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function bu(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-or(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var ke=0;function s0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i0,_u,o0,a0,l0,ac=!1,Ji=[],Jr=null,Xr=null,Qr=null,fi=new Map,pi=new Map,Hr=[],_y="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dd(t,e){switch(t){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":fi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pi.delete(e.pointerId)}}function zs(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Mi(e),e!==null&&_u(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Sy(t,e,r,n,s){switch(e){case"focusin":return Jr=zs(Jr,t,e,r,n,s),!0;case"dragenter":return Xr=zs(Xr,t,e,r,n,s),!0;case"mouseover":return Qr=zs(Qr,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return fi.set(i,zs(fi.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,pi.set(i,zs(pi.get(i)||null,t,e,r,n,s)),!0}return!1}function c0(t){var e=En(t.target);if(e!==null){var r=Mn(e);if(r!==null){if(e=r.tag,e===13){if(e=Xf(r),e!==null){t.blockedOn=e,l0(t.priority,function(){o0(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function So(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=lc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);rc=n,r.target.dispatchEvent(n),rc=null}else return e=Mi(r),e!==null&&_u(e),t.blockedOn=r,!1;e.shift()}return!0}function Ud(t,e,r){So(t)&&r.delete(e)}function ky(){ac=!1,Jr!==null&&So(Jr)&&(Jr=null),Xr!==null&&So(Xr)&&(Xr=null),Qr!==null&&So(Qr)&&(Qr=null),fi.forEach(Ud),pi.forEach(Ud)}function Ls(t,e){t.blockedOn===e&&(t.blockedOn=null,ac||(ac=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,ky)))}function mi(t){function e(s){return Ls(s,t)}if(0<Ji.length){Ls(Ji[0],t);for(var r=1;r<Ji.length;r++){var n=Ji[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Jr!==null&&Ls(Jr,t),Xr!==null&&Ls(Xr,t),Qr!==null&&Ls(Qr,t),fi.forEach(e),pi.forEach(e),r=0;r<Hr.length;r++)n=Hr[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Hr.length&&(r=Hr[0],r.blockedOn===null);)c0(r),r.blockedOn===null&&Hr.shift()}var ds=Rr.ReactCurrentBatchConfig,Ho=!0;function Ey(t,e,r,n){var s=ke,i=ds.transition;ds.transition=null;try{ke=1,Su(t,e,r,n)}finally{ke=s,ds.transition=i}}function jy(t,e,r,n){var s=ke,i=ds.transition;ds.transition=null;try{ke=4,Su(t,e,r,n)}finally{ke=s,ds.transition=i}}function Su(t,e,r,n){if(Ho){var s=lc(t,e,r,n);if(s===null)pl(t,e,n,Vo,r),Dd(t,n);else if(Sy(s,t,e,r,n))n.stopPropagation();else if(Dd(t,n),e&4&&-1<_y.indexOf(t)){for(;s!==null;){var i=Mi(s);if(i!==null&&i0(i),i=lc(t,e,r,n),i===null&&pl(t,e,n,Vo,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else pl(t,e,n,null,r)}}var Vo=null;function lc(t,e,r,n){if(Vo=null,t=xu(n),t=En(t),t!==null)if(e=Mn(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Xf(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vo=t,null}function u0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fy()){case wu:return 1;case t0:return 4;case Fo:case py:return 16;case r0:return 536870912;default:return 16}default:return 16}}var Kr=null,ku=null,ko=null;function d0(){if(ko)return ko;var t,e=ku,r=e.length,n,s="value"in Kr?Kr.value:Kr.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return ko=s.slice(t,1<n?1-n:void 0)}function Eo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xi(){return!0}function Bd(){return!1}function Ft(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xi:Bd,this.isPropagationStopped=Bd,this}return Me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xi)},persist:function(){},isPersistent:Xi}),e}var js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=Ft(js),Li=Me({},js,{view:0,detail:0}),Ny=Ft(Li),il,ol,Ms,ka=Me({},Li,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ju,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ms&&(Ms&&t.type==="mousemove"?(il=t.screenX-Ms.screenX,ol=t.screenY-Ms.screenY):ol=il=0,Ms=t),il)},movementY:function(t){return"movementY"in t?t.movementY:ol}}),Fd=Ft(ka),Cy=Me({},ka,{dataTransfer:0}),Py=Ft(Cy),Ay=Me({},Li,{relatedTarget:0}),al=Ft(Ay),Ty=Me({},js,{animationName:0,elapsedTime:0,pseudoElement:0}),Oy=Ft(Ty),Iy=Me({},js,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ry=Ft(Iy),$y=Me({},js,{data:0}),Wd=Ft($y),zy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ly={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},My={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dy(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=My[t])?!!e[t]:!1}function ju(){return Dy}var Uy=Me({},Li,{key:function(t){if(t.key){var e=zy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Eo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ly[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ju,charCode:function(t){return t.type==="keypress"?Eo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Eo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),By=Ft(Uy),Fy=Me({},ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hd=Ft(Fy),Wy=Me({},Li,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ju}),Hy=Ft(Wy),Vy=Me({},js,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gy=Ft(Vy),qy=Me({},ka,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ky=Ft(qy),Yy=[9,13,27,32],Nu=Pr&&"CompositionEvent"in window,ti=null;Pr&&"documentMode"in document&&(ti=document.documentMode);var Jy=Pr&&"TextEvent"in window&&!ti,h0=Pr&&(!Nu||ti&&8<ti&&11>=ti),Vd=" ",Gd=!1;function f0(t,e){switch(t){case"keyup":return Yy.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jn=!1;function Xy(t,e){switch(t){case"compositionend":return p0(e);case"keypress":return e.which!==32?null:(Gd=!0,Vd);case"textInput":return t=e.data,t===Vd&&Gd?null:t;default:return null}}function Qy(t,e){if(Jn)return t==="compositionend"||!Nu&&f0(t,e)?(t=d0(),ko=ku=Kr=null,Jn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return h0&&e.locale!=="ko"?null:e.data;default:return null}}var Zy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Zy[t.type]:e==="textarea"}function m0(t,e,r,n){Gf(n),e=Go(e,"onChange"),0<e.length&&(r=new Eu("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ri=null,gi=null;function ev(t){j0(t,0)}function Ea(t){var e=Zn(t);if(Df(e))return t}function tv(t,e){if(t==="change")return e}var g0=!1;if(Pr){var ll;if(Pr){var cl="oninput"in document;if(!cl){var Kd=document.createElement("div");Kd.setAttribute("oninput","return;"),cl=typeof Kd.oninput=="function"}ll=cl}else ll=!1;g0=ll&&(!document.documentMode||9<document.documentMode)}function Yd(){ri&&(ri.detachEvent("onpropertychange",y0),gi=ri=null)}function y0(t){if(t.propertyName==="value"&&Ea(gi)){var e=[];m0(e,gi,t,xu(t)),Jf(ev,e)}}function rv(t,e,r){t==="focusin"?(Yd(),ri=e,gi=r,ri.attachEvent("onpropertychange",y0)):t==="focusout"&&Yd()}function nv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ea(gi)}function sv(t,e){if(t==="click")return Ea(e)}function iv(t,e){if(t==="input"||t==="change")return Ea(e)}function ov(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:ov;function yi(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Hl.call(e,s)||!cr(t[s],e[s]))return!1}return!0}function Jd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Xd(t,e){var r=Jd(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Jd(r)}}function v0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x0(){for(var t=window,e=Do();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Do(t.document)}return e}function Cu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function av(t){var e=x0(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&v0(r.ownerDocument.documentElement,r)){if(n!==null&&Cu(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Xd(r,i);var o=Xd(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lv=Pr&&"documentMode"in document&&11>=document.documentMode,Xn=null,cc=null,ni=null,uc=!1;function Qd(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;uc||Xn==null||Xn!==Do(n)||(n=Xn,"selectionStart"in n&&Cu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ni&&yi(ni,n)||(ni=n,n=Go(cc,"onSelect"),0<n.length&&(e=new Eu("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Xn)))}function Qi(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Qn={animationend:Qi("Animation","AnimationEnd"),animationiteration:Qi("Animation","AnimationIteration"),animationstart:Qi("Animation","AnimationStart"),transitionend:Qi("Transition","TransitionEnd")},ul={},w0={};Pr&&(w0=document.createElement("div").style,"AnimationEvent"in window||(delete Qn.animationend.animation,delete Qn.animationiteration.animation,delete Qn.animationstart.animation),"TransitionEvent"in window||delete Qn.transitionend.transition);function ja(t){if(ul[t])return ul[t];if(!Qn[t])return t;var e=Qn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in w0)return ul[t]=e[r];return t}var b0=ja("animationend"),_0=ja("animationiteration"),S0=ja("animationstart"),k0=ja("transitionend"),E0=new Map,Zd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function an(t,e){E0.set(t,e),Ln(e,[t])}for(var dl=0;dl<Zd.length;dl++){var hl=Zd[dl],cv=hl.toLowerCase(),uv=hl[0].toUpperCase()+hl.slice(1);an(cv,"on"+uv)}an(b0,"onAnimationEnd");an(_0,"onAnimationIteration");an(S0,"onAnimationStart");an("dblclick","onDoubleClick");an("focusin","onFocus");an("focusout","onBlur");an(k0,"onTransitionEnd");gs("onMouseEnter",["mouseout","mouseover"]);gs("onMouseLeave",["mouseout","mouseover"]);gs("onPointerEnter",["pointerout","pointerover"]);gs("onPointerLeave",["pointerout","pointerover"]);Ln("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ln("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ln("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ln("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ln("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ln("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ys="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ys));function eh(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,cy(n,e,void 0,t),t.currentTarget=null}function j0(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;eh(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;eh(s,l,u),i=c}}}if(Bo)throw t=ic,Bo=!1,ic=null,t}function Te(t,e){var r=e[mc];r===void 0&&(r=e[mc]=new Set);var n=t+"__bubble";r.has(n)||(N0(e,t,2,!1),r.add(n))}function fl(t,e,r){var n=0;e&&(n|=4),N0(r,t,n,e)}var Zi="_reactListening"+Math.random().toString(36).slice(2);function vi(t){if(!t[Zi]){t[Zi]=!0,Rf.forEach(function(r){r!=="selectionchange"&&(dv.has(r)||fl(r,!1,t),fl(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zi]||(e[Zi]=!0,fl("selectionchange",!1,e))}}function N0(t,e,r,n){switch(u0(e)){case 1:var s=Ey;break;case 4:s=jy;break;default:s=Su}r=s.bind(null,e,r,t),s=void 0,!sc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function pl(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=En(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Jf(function(){var u=i,d=xu(r),h=[];e:{var f=E0.get(t);if(f!==void 0){var p=Eu,v=t;switch(t){case"keypress":if(Eo(r)===0)break e;case"keydown":case"keyup":p=By;break;case"focusin":v="focus",p=al;break;case"focusout":v="blur",p=al;break;case"beforeblur":case"afterblur":p=al;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Fd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Hy;break;case b0:case _0:case S0:p=Oy;break;case k0:p=Gy;break;case"scroll":p=Ny;break;case"wheel":p=Ky;break;case"copy":case"cut":case"paste":p=Ry;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Hd}var x=(e&4)!==0,S=!x&&t==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var m=u,y;m!==null;){y=m;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,g!==null&&(b=hi(m,g),b!=null&&x.push(xi(m,b,y)))),S)break;m=m.return}0<x.length&&(f=new p(f,v,null,r,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==rc&&(v=r.relatedTarget||r.fromElement)&&(En(v)||v[Ar]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=u,v=v?En(v):null,v!==null&&(S=Mn(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(x=Fd,b="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(x=Hd,b="onPointerLeave",g="onPointerEnter",m="pointer"),S=p==null?f:Zn(p),y=v==null?f:Zn(v),f=new x(b,m+"leave",p,r,d),f.target=S,f.relatedTarget=y,b=null,En(d)===u&&(x=new x(g,m+"enter",v,r,d),x.target=y,x.relatedTarget=S,b=x),S=b,p&&v)t:{for(x=p,g=v,m=0,y=x;y;y=Bn(y))m++;for(y=0,b=g;b;b=Bn(b))y++;for(;0<m-y;)x=Bn(x),m--;for(;0<y-m;)g=Bn(g),y--;for(;m--;){if(x===g||g!==null&&x===g.alternate)break t;x=Bn(x),g=Bn(g)}x=null}else x=null;p!==null&&th(h,f,p,x,!1),v!==null&&S!==null&&th(h,S,v,x,!0)}}e:{if(f=u?Zn(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=tv;else if(qd(f))if(g0)E=iv;else{E=nv;var j=rv}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=sv);if(E&&(E=E(t,u))){m0(h,E,r,d);break e}j&&j(t,f,u),t==="focusout"&&(j=f._wrapperState)&&j.controlled&&f.type==="number"&&Xl(f,"number",f.value)}switch(j=u?Zn(u):window,t){case"focusin":(qd(j)||j.contentEditable==="true")&&(Xn=j,cc=u,ni=null);break;case"focusout":ni=cc=Xn=null;break;case"mousedown":uc=!0;break;case"contextmenu":case"mouseup":case"dragend":uc=!1,Qd(h,r,d);break;case"selectionchange":if(lv)break;case"keydown":case"keyup":Qd(h,r,d)}var _;if(Nu)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Jn?f0(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(h0&&r.locale!=="ko"&&(Jn||k!=="onCompositionStart"?k==="onCompositionEnd"&&Jn&&(_=d0()):(Kr=d,ku="value"in Kr?Kr.value:Kr.textContent,Jn=!0)),j=Go(u,k),0<j.length&&(k=new Wd(k,t,null,r,d),h.push({event:k,listeners:j}),_?k.data=_:(_=p0(r),_!==null&&(k.data=_)))),(_=Jy?Xy(t,r):Qy(t,r))&&(u=Go(u,"onBeforeInput"),0<u.length&&(d=new Wd("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=_))}j0(h,e)})}function xi(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Go(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=hi(t,r),i!=null&&n.unshift(xi(t,i,s)),i=hi(t,e),i!=null&&n.push(xi(t,i,s))),t=t.return}return n}function Bn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function th(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=hi(r,i),c!=null&&o.unshift(xi(r,c,l))):s||(c=hi(r,i),c!=null&&o.push(xi(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var hv=/\r\n?/g,fv=/\u0000|\uFFFD/g;function rh(t){return(typeof t=="string"?t:""+t).replace(hv,`
`).replace(fv,"")}function eo(t,e,r){if(e=rh(e),rh(t)!==e&&r)throw Error(T(425))}function qo(){}var dc=null,hc=null;function fc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pc=typeof setTimeout=="function"?setTimeout:void 0,pv=typeof clearTimeout=="function"?clearTimeout:void 0,nh=typeof Promise=="function"?Promise:void 0,mv=typeof queueMicrotask=="function"?queueMicrotask:typeof nh<"u"?function(t){return nh.resolve(null).then(t).catch(gv)}:pc;function gv(t){setTimeout(function(){throw t})}function ml(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),mi(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);mi(e)}function Zr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ns=Math.random().toString(36).slice(2),yr="__reactFiber$"+Ns,wi="__reactProps$"+Ns,Ar="__reactContainer$"+Ns,mc="__reactEvents$"+Ns,yv="__reactListeners$"+Ns,vv="__reactHandles$"+Ns;function En(t){var e=t[yr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ar]||r[yr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sh(t);t!==null;){if(r=t[yr])return r;t=sh(t)}return e}t=r,r=t.parentNode}return null}function Mi(t){return t=t[yr]||t[Ar],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(T(33))}function Na(t){return t[wi]||null}var gc=[],es=-1;function ln(t){return{current:t}}function Oe(t){0>es||(t.current=gc[es],gc[es]=null,es--)}function Pe(t,e){es++,gc[es]=t.current,t.current=e}var on={},ft=ln(on),At=ln(!1),On=on;function ys(t,e){var r=t.type.contextTypes;if(!r)return on;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Tt(t){return t=t.childContextTypes,t!=null}function Ko(){Oe(At),Oe(ft)}function ih(t,e,r){if(ft.current!==on)throw Error(T(168));Pe(ft,e),Pe(At,r)}function C0(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(T(108,ry(t)||"Unknown",s));return Me({},r,n)}function Yo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||on,On=ft.current,Pe(ft,t),Pe(At,At.current),!0}function oh(t,e,r){var n=t.stateNode;if(!n)throw Error(T(169));r?(t=C0(t,e,On),n.__reactInternalMemoizedMergedChildContext=t,Oe(At),Oe(ft),Pe(ft,t)):Oe(At),Pe(At,r)}var kr=null,Ca=!1,gl=!1;function P0(t){kr===null?kr=[t]:kr.push(t)}function xv(t){Ca=!0,P0(t)}function cn(){if(!gl&&kr!==null){gl=!0;var t=0,e=ke;try{var r=kr;for(ke=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}kr=null,Ca=!1}catch(s){throw kr!==null&&(kr=kr.slice(t+1)),e0(wu,cn),s}finally{ke=e,gl=!1}}return null}var ts=[],rs=0,Jo=null,Xo=0,Gt=[],qt=0,In=null,Er=1,jr="";function gn(t,e){ts[rs++]=Xo,ts[rs++]=Jo,Jo=t,Xo=e}function A0(t,e,r){Gt[qt++]=Er,Gt[qt++]=jr,Gt[qt++]=In,In=t;var n=Er;t=jr;var s=32-or(n)-1;n&=~(1<<s),r+=1;var i=32-or(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Er=1<<32-or(e)+s|r<<s|n,jr=i+t}else Er=1<<i|r<<s|n,jr=t}function Pu(t){t.return!==null&&(gn(t,1),A0(t,1,0))}function Au(t){for(;t===Jo;)Jo=ts[--rs],ts[rs]=null,Xo=ts[--rs],ts[rs]=null;for(;t===In;)In=Gt[--qt],Gt[qt]=null,jr=Gt[--qt],Gt[qt]=null,Er=Gt[--qt],Gt[qt]=null}var Dt=null,zt=null,Re=!1,ir=null;function T0(t,e){var r=Kt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ah(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dt=t,zt=Zr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dt=t,zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=In!==null?{id:Er,overflow:jr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Kt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Dt=t,zt=null,!0):!1;default:return!1}}function yc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function vc(t){if(Re){var e=zt;if(e){var r=e;if(!ah(t,e)){if(yc(t))throw Error(T(418));e=Zr(r.nextSibling);var n=Dt;e&&ah(t,e)?T0(n,r):(t.flags=t.flags&-4097|2,Re=!1,Dt=t)}}else{if(yc(t))throw Error(T(418));t.flags=t.flags&-4097|2,Re=!1,Dt=t}}}function lh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dt=t}function to(t){if(t!==Dt)return!1;if(!Re)return lh(t),Re=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!fc(t.type,t.memoizedProps)),e&&(e=zt)){if(yc(t))throw O0(),Error(T(418));for(;e;)T0(t,e),e=Zr(e.nextSibling)}if(lh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(T(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){zt=Zr(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}zt=null}}else zt=Dt?Zr(t.stateNode.nextSibling):null;return!0}function O0(){for(var t=zt;t;)t=Zr(t.nextSibling)}function vs(){zt=Dt=null,Re=!1}function Tu(t){ir===null?ir=[t]:ir.push(t)}var wv=Rr.ReactCurrentBatchConfig;function Ds(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(T(309));var n=r.stateNode}if(!n)throw Error(T(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(T(284));if(!r._owner)throw Error(T(290,t))}return t}function ro(t,e){throw t=Object.prototype.toString.call(e),Error(T(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ch(t){var e=t._init;return e(t._payload)}function I0(t){function e(g,m){if(t){var y=g.deletions;y===null?(g.deletions=[m],g.flags|=16):y.push(m)}}function r(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function n(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function s(g,m){return g=nn(g,m),g.index=0,g.sibling=null,g}function i(g,m,y){return g.index=y,t?(y=g.alternate,y!==null?(y=y.index,y<m?(g.flags|=2,m):y):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,m,y,b){return m===null||m.tag!==6?(m=Sl(y,g.mode,b),m.return=g,m):(m=s(m,y),m.return=g,m)}function c(g,m,y,b){var E=y.type;return E===Yn?d(g,m,y.props.children,b,y.key):m!==null&&(m.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Fr&&ch(E)===m.type)?(b=s(m,y.props),b.ref=Ds(g,m,y),b.return=g,b):(b=Oo(y.type,y.key,y.props,null,g.mode,b),b.ref=Ds(g,m,y),b.return=g,b)}function u(g,m,y,b){return m===null||m.tag!==4||m.stateNode.containerInfo!==y.containerInfo||m.stateNode.implementation!==y.implementation?(m=kl(y,g.mode,b),m.return=g,m):(m=s(m,y.children||[]),m.return=g,m)}function d(g,m,y,b,E){return m===null||m.tag!==7?(m=An(y,g.mode,b,E),m.return=g,m):(m=s(m,y),m.return=g,m)}function h(g,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Sl(""+m,g.mode,y),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Vi:return y=Oo(m.type,m.key,m.props,null,g.mode,y),y.ref=Ds(g,null,m),y.return=g,y;case Kn:return m=kl(m,g.mode,y),m.return=g,m;case Fr:var b=m._init;return h(g,b(m._payload),y)}if(qs(m)||Rs(m))return m=An(m,g.mode,y,null),m.return=g,m;ro(g,m)}return null}function f(g,m,y,b){var E=m!==null?m.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:l(g,m,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vi:return y.key===E?c(g,m,y,b):null;case Kn:return y.key===E?u(g,m,y,b):null;case Fr:return E=y._init,f(g,m,E(y._payload),b)}if(qs(y)||Rs(y))return E!==null?null:d(g,m,y,b,null);ro(g,y)}return null}function p(g,m,y,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(y)||null,l(m,g,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vi:return g=g.get(b.key===null?y:b.key)||null,c(m,g,b,E);case Kn:return g=g.get(b.key===null?y:b.key)||null,u(m,g,b,E);case Fr:var j=b._init;return p(g,m,y,j(b._payload),E)}if(qs(b)||Rs(b))return g=g.get(y)||null,d(m,g,b,E,null);ro(m,b)}return null}function v(g,m,y,b){for(var E=null,j=null,_=m,k=m=0,O=null;_!==null&&k<y.length;k++){_.index>k?(O=_,_=null):O=_.sibling;var P=f(g,_,y[k],b);if(P===null){_===null&&(_=O);break}t&&_&&P.alternate===null&&e(g,_),m=i(P,m,k),j===null?E=P:j.sibling=P,j=P,_=O}if(k===y.length)return r(g,_),Re&&gn(g,k),E;if(_===null){for(;k<y.length;k++)_=h(g,y[k],b),_!==null&&(m=i(_,m,k),j===null?E=_:j.sibling=_,j=_);return Re&&gn(g,k),E}for(_=n(g,_);k<y.length;k++)O=p(_,g,k,y[k],b),O!==null&&(t&&O.alternate!==null&&_.delete(O.key===null?k:O.key),m=i(O,m,k),j===null?E=O:j.sibling=O,j=O);return t&&_.forEach(function(Z){return e(g,Z)}),Re&&gn(g,k),E}function x(g,m,y,b){var E=Rs(y);if(typeof E!="function")throw Error(T(150));if(y=E.call(y),y==null)throw Error(T(151));for(var j=E=null,_=m,k=m=0,O=null,P=y.next();_!==null&&!P.done;k++,P=y.next()){_.index>k?(O=_,_=null):O=_.sibling;var Z=f(g,_,P.value,b);if(Z===null){_===null&&(_=O);break}t&&_&&Z.alternate===null&&e(g,_),m=i(Z,m,k),j===null?E=Z:j.sibling=Z,j=Z,_=O}if(P.done)return r(g,_),Re&&gn(g,k),E;if(_===null){for(;!P.done;k++,P=y.next())P=h(g,P.value,b),P!==null&&(m=i(P,m,k),j===null?E=P:j.sibling=P,j=P);return Re&&gn(g,k),E}for(_=n(g,_);!P.done;k++,P=y.next())P=p(_,g,k,P.value,b),P!==null&&(t&&P.alternate!==null&&_.delete(P.key===null?k:P.key),m=i(P,m,k),j===null?E=P:j.sibling=P,j=P);return t&&_.forEach(function(K){return e(g,K)}),Re&&gn(g,k),E}function S(g,m,y,b){if(typeof y=="object"&&y!==null&&y.type===Yn&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Vi:e:{for(var E=y.key,j=m;j!==null;){if(j.key===E){if(E=y.type,E===Yn){if(j.tag===7){r(g,j.sibling),m=s(j,y.props.children),m.return=g,g=m;break e}}else if(j.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Fr&&ch(E)===j.type){r(g,j.sibling),m=s(j,y.props),m.ref=Ds(g,j,y),m.return=g,g=m;break e}r(g,j);break}else e(g,j);j=j.sibling}y.type===Yn?(m=An(y.props.children,g.mode,b,y.key),m.return=g,g=m):(b=Oo(y.type,y.key,y.props,null,g.mode,b),b.ref=Ds(g,m,y),b.return=g,g=b)}return o(g);case Kn:e:{for(j=y.key;m!==null;){if(m.key===j)if(m.tag===4&&m.stateNode.containerInfo===y.containerInfo&&m.stateNode.implementation===y.implementation){r(g,m.sibling),m=s(m,y.children||[]),m.return=g,g=m;break e}else{r(g,m);break}else e(g,m);m=m.sibling}m=kl(y,g.mode,b),m.return=g,g=m}return o(g);case Fr:return j=y._init,S(g,m,j(y._payload),b)}if(qs(y))return v(g,m,y,b);if(Rs(y))return x(g,m,y,b);ro(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,m!==null&&m.tag===6?(r(g,m.sibling),m=s(m,y),m.return=g,g=m):(r(g,m),m=Sl(y,g.mode,b),m.return=g,g=m),o(g)):r(g,m)}return S}var xs=I0(!0),R0=I0(!1),Qo=ln(null),Zo=null,ns=null,Ou=null;function Iu(){Ou=ns=Zo=null}function Ru(t){var e=Qo.current;Oe(Qo),t._currentValue=e}function xc(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function hs(t,e){Zo=t,Ou=ns=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ct=!0),t.firstContext=null)}function Jt(t){var e=t._currentValue;if(Ou!==t)if(t={context:t,memoizedValue:e,next:null},ns===null){if(Zo===null)throw Error(T(308));ns=t,Zo.dependencies={lanes:0,firstContext:t}}else ns=ns.next=t;return e}var jn=null;function $u(t){jn===null?jn=[t]:jn.push(t)}function $0(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,$u(e)):(r.next=s.next,s.next=r),e.interleaved=r,Tr(t,n)}function Tr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Wr=!1;function zu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Nr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function en(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,xe&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Tr(t,r)}return s=n.interleaved,s===null?(e.next=e,$u(n)):(e.next=s.next,s.next=e),n.interleaved=e,Tr(t,r)}function jo(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bu(t,r)}}function uh(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ea(t,e,r,n){var s=t.updateQueue;Wr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,p=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,x=l;switch(f=e,p=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(p,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,f=typeof v=="function"?v.call(p,h,f):v,f==null)break e;h=Me({},h,f);break e;case 2:Wr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);$n|=o,t.lanes=o,t.memoizedState=h}}function dh(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(T(191,s));s.call(n)}}}var Di={},xr=ln(Di),bi=ln(Di),_i=ln(Di);function Nn(t){if(t===Di)throw Error(T(174));return t}function Lu(t,e){switch(Pe(_i,e),Pe(bi,t),Pe(xr,Di),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zl(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Zl(e,t)}Oe(xr),Pe(xr,e)}function ws(){Oe(xr),Oe(bi),Oe(_i)}function L0(t){Nn(_i.current);var e=Nn(xr.current),r=Zl(e,t.type);e!==r&&(Pe(bi,t),Pe(xr,r))}function Mu(t){bi.current===t&&(Oe(xr),Oe(bi))}var ze=ln(0);function ta(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yl=[];function Du(){for(var t=0;t<yl.length;t++)yl[t]._workInProgressVersionPrimary=null;yl.length=0}var No=Rr.ReactCurrentDispatcher,vl=Rr.ReactCurrentBatchConfig,Rn=0,Le=null,qe=null,Xe=null,ra=!1,si=!1,Si=0,bv=0;function ct(){throw Error(T(321))}function Uu(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!cr(t[r],e[r]))return!1;return!0}function Bu(t,e,r,n,s,i){if(Rn=i,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,No.current=t===null||t.memoizedState===null?Ev:jv,t=r(n,s),si){i=0;do{if(si=!1,Si=0,25<=i)throw Error(T(301));i+=1,Xe=qe=null,e.updateQueue=null,No.current=Nv,t=r(n,s)}while(si)}if(No.current=na,e=qe!==null&&qe.next!==null,Rn=0,Xe=qe=Le=null,ra=!1,e)throw Error(T(300));return t}function Fu(){var t=Si!==0;return Si=0,t}function mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Le.memoizedState=Xe=t:Xe=Xe.next=t,Xe}function Xt(){if(qe===null){var t=Le.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var e=Xe===null?Le.memoizedState:Xe.next;if(e!==null)Xe=e,qe=t;else{if(t===null)throw Error(T(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},Xe===null?Le.memoizedState=Xe=t:Xe=Xe.next=t}return Xe}function ki(t,e){return typeof e=="function"?e(t):e}function xl(t){var e=Xt(),r=e.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=t;var n=qe,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Rn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,Le.lanes|=d,$n|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,cr(n,e.memoizedState)||(Ct=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Le.lanes|=i,$n|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function wl(t){var e=Xt(),r=e.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);cr(i,e.memoizedState)||(Ct=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function M0(){}function D0(t,e){var r=Le,n=Xt(),s=e(),i=!cr(n.memoizedState,s);if(i&&(n.memoizedState=s,Ct=!0),n=n.queue,Wu(F0.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Xe!==null&&Xe.memoizedState.tag&1){if(r.flags|=2048,Ei(9,B0.bind(null,r,n,s,e),void 0,null),Ze===null)throw Error(T(349));Rn&30||U0(r,e,s)}return s}function U0(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function B0(t,e,r,n){e.value=r,e.getSnapshot=n,W0(e)&&H0(t)}function F0(t,e,r){return r(function(){W0(e)&&H0(t)})}function W0(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!cr(t,r)}catch{return!0}}function H0(t){var e=Tr(t,1);e!==null&&ar(e,t,1,-1)}function hh(t){var e=mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:t},e.queue=t,t=t.dispatch=kv.bind(null,Le,t),[e.memoizedState,t]}function Ei(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function V0(){return Xt().memoizedState}function Co(t,e,r,n){var s=mr();Le.flags|=t,s.memoizedState=Ei(1|e,r,void 0,n===void 0?null:n)}function Pa(t,e,r,n){var s=Xt();n=n===void 0?null:n;var i=void 0;if(qe!==null){var o=qe.memoizedState;if(i=o.destroy,n!==null&&Uu(n,o.deps)){s.memoizedState=Ei(e,r,i,n);return}}Le.flags|=t,s.memoizedState=Ei(1|e,r,i,n)}function fh(t,e){return Co(8390656,8,t,e)}function Wu(t,e){return Pa(2048,8,t,e)}function G0(t,e){return Pa(4,2,t,e)}function q0(t,e){return Pa(4,4,t,e)}function K0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Y0(t,e,r){return r=r!=null?r.concat([t]):null,Pa(4,4,K0.bind(null,e,t),r)}function Hu(){}function J0(t,e){var r=Xt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Uu(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function X0(t,e){var r=Xt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Uu(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Q0(t,e,r){return Rn&21?(cr(r,e)||(r=n0(),Le.lanes|=r,$n|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ct=!0),t.memoizedState=r)}function _v(t,e){var r=ke;ke=r!==0&&4>r?r:4,t(!0);var n=vl.transition;vl.transition={};try{t(!1),e()}finally{ke=r,vl.transition=n}}function Z0(){return Xt().memoizedState}function Sv(t,e,r){var n=rn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ep(t))tp(e,r);else if(r=$0(t,e,r,n),r!==null){var s=yt();ar(r,t,n,s),rp(r,e,n)}}function kv(t,e,r){var n=rn(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ep(t))tp(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,cr(l,o)){var c=e.interleaved;c===null?(s.next=s,$u(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=$0(t,e,s,n),r!==null&&(s=yt(),ar(r,t,n,s),rp(r,e,n))}}function ep(t){var e=t.alternate;return t===Le||e!==null&&e===Le}function tp(t,e){si=ra=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function rp(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bu(t,r)}}var na={readContext:Jt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},Ev={readContext:Jt,useCallback:function(t,e){return mr().memoizedState=[t,e===void 0?null:e],t},useContext:Jt,useEffect:fh,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Co(4194308,4,K0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Co(4194308,4,t,e)},useInsertionEffect:function(t,e){return Co(4,2,t,e)},useMemo:function(t,e){var r=mr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=mr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Sv.bind(null,Le,t),[n.memoizedState,t]},useRef:function(t){var e=mr();return t={current:t},e.memoizedState=t},useState:hh,useDebugValue:Hu,useDeferredValue:function(t){return mr().memoizedState=t},useTransition:function(){var t=hh(!1),e=t[0];return t=_v.bind(null,t[1]),mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Le,s=mr();if(Re){if(r===void 0)throw Error(T(407));r=r()}else{if(r=e(),Ze===null)throw Error(T(349));Rn&30||U0(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,fh(F0.bind(null,n,i,t),[t]),n.flags|=2048,Ei(9,B0.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=mr(),e=Ze.identifierPrefix;if(Re){var r=jr,n=Er;r=(n&~(1<<32-or(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Si++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=bv++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jv={readContext:Jt,useCallback:J0,useContext:Jt,useEffect:Wu,useImperativeHandle:Y0,useInsertionEffect:G0,useLayoutEffect:q0,useMemo:X0,useReducer:xl,useRef:V0,useState:function(){return xl(ki)},useDebugValue:Hu,useDeferredValue:function(t){var e=Xt();return Q0(e,qe.memoizedState,t)},useTransition:function(){var t=xl(ki)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:M0,useSyncExternalStore:D0,useId:Z0,unstable_isNewReconciler:!1},Nv={readContext:Jt,useCallback:J0,useContext:Jt,useEffect:Wu,useImperativeHandle:Y0,useInsertionEffect:G0,useLayoutEffect:q0,useMemo:X0,useReducer:wl,useRef:V0,useState:function(){return wl(ki)},useDebugValue:Hu,useDeferredValue:function(t){var e=Xt();return qe===null?e.memoizedState=t:Q0(e,qe.memoizedState,t)},useTransition:function(){var t=wl(ki)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:M0,useSyncExternalStore:D0,useId:Z0,unstable_isNewReconciler:!1};function tr(t,e){if(t&&t.defaultProps){e=Me({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function wc(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Me({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Aa={isMounted:function(t){return(t=t._reactInternals)?Mn(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=yt(),s=rn(t),i=Nr(n,s);i.payload=e,r!=null&&(i.callback=r),e=en(t,i,s),e!==null&&(ar(e,t,s,n),jo(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=yt(),s=rn(t),i=Nr(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=en(t,i,s),e!==null&&(ar(e,t,s,n),jo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=yt(),n=rn(t),s=Nr(r,n);s.tag=2,e!=null&&(s.callback=e),e=en(t,s,n),e!==null&&(ar(e,t,n,r),jo(e,t,n))}};function ph(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!yi(r,n)||!yi(s,i):!0}function np(t,e,r){var n=!1,s=on,i=e.contextType;return typeof i=="object"&&i!==null?i=Jt(i):(s=Tt(e)?On:ft.current,n=e.contextTypes,i=(n=n!=null)?ys(t,s):on),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Aa,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function mh(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Aa.enqueueReplaceState(e,e.state,null)}function bc(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},zu(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Jt(i):(i=Tt(e)?On:ft.current,s.context=ys(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(wc(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Aa.enqueueReplaceState(s,s.state,null),ea(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function bs(t,e){try{var r="",n=e;do r+=ty(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function bl(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function _c(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Cv=typeof WeakMap=="function"?WeakMap:Map;function sp(t,e,r){r=Nr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ia||(ia=!0,Oc=n),_c(t,e)},r}function ip(t,e,r){r=Nr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){_c(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){_c(t,e),typeof n!="function"&&(tn===null?tn=new Set([this]):tn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function gh(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Cv;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Fv.bind(null,t,e,r),e.then(t,t))}function yh(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vh(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Nr(-1,1),e.tag=2,en(r,e,1))),r.lanes|=1),t)}var Pv=Rr.ReactCurrentOwner,Ct=!1;function gt(t,e,r,n){e.child=t===null?R0(e,null,r,n):xs(e,t.child,r,n)}function xh(t,e,r,n,s){r=r.render;var i=e.ref;return hs(e,s),n=Bu(t,e,r,n,i,s),r=Fu(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Or(t,e,s)):(Re&&r&&Pu(e),e.flags|=1,gt(t,e,n,s),e.child)}function wh(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Qu(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,op(t,e,i,n,s)):(t=Oo(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:yi,r(o,n)&&t.ref===e.ref)return Or(t,e,s)}return e.flags|=1,t=nn(i,n),t.ref=e.ref,t.return=e,e.child=t}function op(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(yi(i,n)&&t.ref===e.ref)if(Ct=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Ct=!0);else return e.lanes=t.lanes,Or(t,e,s)}return Sc(t,e,r,n,s)}function ap(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(is,Rt),Rt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(is,Rt),Rt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Pe(is,Rt),Rt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Pe(is,Rt),Rt|=n;return gt(t,e,s,r),e.child}function lp(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Sc(t,e,r,n,s){var i=Tt(r)?On:ft.current;return i=ys(e,i),hs(e,s),r=Bu(t,e,r,n,i,s),n=Fu(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Or(t,e,s)):(Re&&n&&Pu(e),e.flags|=1,gt(t,e,r,s),e.child)}function bh(t,e,r,n,s){if(Tt(r)){var i=!0;Yo(e)}else i=!1;if(hs(e,s),e.stateNode===null)Po(t,e),np(e,r,n),bc(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Jt(u):(u=Tt(r)?On:ft.current,u=ys(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&mh(e,o,n,u),Wr=!1;var f=e.memoizedState;o.state=f,ea(e,n,o,s),c=e.memoizedState,l!==n||f!==c||At.current||Wr?(typeof d=="function"&&(wc(e,r,d,n),c=e.memoizedState),(l=Wr||ph(e,r,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,z0(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:tr(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Jt(c):(c=Tt(r)?On:ft.current,c=ys(e,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&mh(e,o,n,c),Wr=!1,f=e.memoizedState,o.state=f,ea(e,n,o,s);var v=e.memoizedState;l!==h||f!==v||At.current||Wr?(typeof p=="function"&&(wc(e,r,p,n),v=e.memoizedState),(u=Wr||ph(e,r,u,n,f,v,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),o.props=n,o.state=v,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return kc(t,e,r,n,i,s)}function kc(t,e,r,n,s,i){lp(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&oh(e,r,!1),Or(t,e,i);n=e.stateNode,Pv.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=xs(e,t.child,null,i),e.child=xs(e,null,l,i)):gt(t,e,l,i),e.memoizedState=n.state,s&&oh(e,r,!0),e.child}function cp(t){var e=t.stateNode;e.pendingContext?ih(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ih(t,e.context,!1),Lu(t,e.containerInfo)}function _h(t,e,r,n,s){return vs(),Tu(s),e.flags|=256,gt(t,e,r,n),e.child}var Ec={dehydrated:null,treeContext:null,retryLane:0};function jc(t){return{baseLanes:t,cachePool:null,transitions:null}}function up(t,e,r){var n=e.pendingProps,s=ze.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pe(ze,s&1),t===null)return vc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ia(o,n,0,null),t=An(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=jc(r),e.memoizedState=Ec,t):Vu(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Av(t,e,o,n,l,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=nn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=nn(l,i):(i=An(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?jc(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=Ec,n}return i=t.child,t=i.sibling,n=nn(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Vu(t,e){return e=Ia({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function no(t,e,r,n){return n!==null&&Tu(n),xs(e,t.child,null,r),t=Vu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Av(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=bl(Error(T(422))),no(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Ia({mode:"visible",children:n.children},s,0,null),i=An(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&xs(e,t.child,null,o),e.child.memoizedState=jc(o),e.memoizedState=Ec,i);if(!(e.mode&1))return no(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(T(419)),n=bl(i,n,void 0),no(t,e,o,n)}if(l=(o&t.childLanes)!==0,Ct||l){if(n=Ze,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Tr(t,s),ar(n,t,s,-1))}return Xu(),n=bl(Error(T(421))),no(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Wv.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,zt=Zr(s.nextSibling),Dt=e,Re=!0,ir=null,t!==null&&(Gt[qt++]=Er,Gt[qt++]=jr,Gt[qt++]=In,Er=t.id,jr=t.overflow,In=e),e=Vu(e,n.children),e.flags|=4096,e)}function Sh(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),xc(t.return,e,r)}function _l(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function dp(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(gt(t,e,n.children,r),n=ze.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sh(t,r,e);else if(t.tag===19)Sh(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Pe(ze,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&ta(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),_l(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ta(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}_l(e,!0,r,null,i);break;case"together":_l(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Po(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Or(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),$n|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(T(153));if(e.child!==null){for(t=e.child,r=nn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=nn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Tv(t,e,r){switch(e.tag){case 3:cp(e),vs();break;case 5:L0(e);break;case 1:Tt(e.type)&&Yo(e);break;case 4:Lu(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Pe(Qo,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Pe(ze,ze.current&1),e.flags|=128,null):r&e.child.childLanes?up(t,e,r):(Pe(ze,ze.current&1),t=Or(t,e,r),t!==null?t.sibling:null);Pe(ze,ze.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return dp(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(ze,ze.current),n)break;return null;case 22:case 23:return e.lanes=0,ap(t,e,r)}return Or(t,e,r)}var hp,Nc,fp,pp;hp=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Nc=function(){};fp=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Nn(xr.current);var i=null;switch(r){case"input":s=Yl(t,s),n=Yl(t,n),i=[];break;case"select":s=Me({},s,{value:void 0}),n=Me({},n,{value:void 0}),i=[];break;case"textarea":s=Ql(t,s),n=Ql(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=qo)}ec(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ui.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s?.[u],n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ui.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};pp=function(t,e,r,n){r!==n&&(e.flags|=4)};function Us(t,e){if(!Re)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Ov(t,e,r){var n=e.pendingProps;switch(Au(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return Tt(e.type)&&Ko(),ut(e),null;case 3:return n=e.stateNode,ws(),Oe(At),Oe(ft),Du(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(to(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&($c(ir),ir=null))),Nc(t,e),ut(e),null;case 5:Mu(e);var s=Nn(_i.current);if(r=e.type,t!==null&&e.stateNode!=null)fp(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(T(166));return ut(e),null}if(t=Nn(xr.current),to(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[yr]=e,n[wi]=i,t=(e.mode&1)!==0,r){case"dialog":Te("cancel",n),Te("close",n);break;case"iframe":case"object":case"embed":Te("load",n);break;case"video":case"audio":for(s=0;s<Ys.length;s++)Te(Ys[s],n);break;case"source":Te("error",n);break;case"img":case"image":case"link":Te("error",n),Te("load",n);break;case"details":Te("toggle",n);break;case"input":Od(n,i),Te("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Te("invalid",n);break;case"textarea":Rd(n,i),Te("invalid",n)}ec(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&eo(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&eo(n.textContent,l,t),s=["children",""+l]):ui.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Te("scroll",n)}switch(r){case"input":Gi(n),Id(n,i,!0);break;case"textarea":Gi(n),$d(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=qo)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ff(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[yr]=e,t[wi]=n,hp(t,e,!1,!1),e.stateNode=t;e:{switch(o=tc(r,n),r){case"dialog":Te("cancel",t),Te("close",t),s=n;break;case"iframe":case"object":case"embed":Te("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ys.length;s++)Te(Ys[s],t);s=n;break;case"source":Te("error",t),s=n;break;case"img":case"image":case"link":Te("error",t),Te("load",t),s=n;break;case"details":Te("toggle",t),s=n;break;case"input":Od(t,n),s=Yl(t,n),Te("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Me({},n,{value:void 0}),Te("invalid",t);break;case"textarea":Rd(t,n),s=Ql(t,n),Te("invalid",t);break;default:s=n}ec(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Vf(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Wf(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&di(t,c):typeof c=="number"&&di(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ui.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Te("scroll",t):c!=null&&mu(t,i,c,o))}switch(r){case"input":Gi(t),Id(t,n,!1);break;case"textarea":Gi(t),$d(t);break;case"option":n.value!=null&&t.setAttribute("value",""+sn(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?ls(t,!!n.multiple,i,!1):n.defaultValue!=null&&ls(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)pp(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(T(166));if(r=Nn(_i.current),Nn(xr.current),to(e)){if(n=e.stateNode,r=e.memoizedProps,n[yr]=e,(i=n.nodeValue!==r)&&(t=Dt,t!==null))switch(t.tag){case 3:eo(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&eo(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[yr]=e,e.stateNode=n}return ut(e),null;case 13:if(Oe(ze),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Re&&zt!==null&&e.mode&1&&!(e.flags&128))O0(),vs(),e.flags|=98560,i=!1;else if(i=to(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(T(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(T(317));i[yr]=e}else vs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ut(e),i=!1}else ir!==null&&($c(ir),ir=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?Ke===0&&(Ke=3):Xu())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return ws(),Nc(t,e),t===null&&vi(e.stateNode.containerInfo),ut(e),null;case 10:return Ru(e.type._context),ut(e),null;case 17:return Tt(e.type)&&Ko(),ut(e),null;case 19:if(Oe(ze),i=e.memoizedState,i===null)return ut(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)Us(i,!1);else{if(Ke!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ta(t),o!==null){for(e.flags|=128,Us(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Pe(ze,ze.current&1|2),e.child}t=t.sibling}i.tail!==null&&We()>_s&&(e.flags|=128,n=!0,Us(i,!1),e.lanes=4194304)}else{if(!n)if(t=ta(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Us(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Re)return ut(e),null}else 2*We()-i.renderingStartTime>_s&&r!==1073741824&&(e.flags|=128,n=!0,Us(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=We(),e.sibling=null,r=ze.current,Pe(ze,n?r&1|2:r&1),e):(ut(e),null);case 22:case 23:return Ju(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Rt&1073741824&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(T(156,e.tag))}function Iv(t,e){switch(Au(e),e.tag){case 1:return Tt(e.type)&&Ko(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ws(),Oe(At),Oe(ft),Du(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mu(e),null;case 13:if(Oe(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(T(340));vs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Oe(ze),null;case 4:return ws(),null;case 10:return Ru(e.type._context),null;case 22:case 23:return Ju(),null;case 24:return null;default:return null}}var so=!1,dt=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,G=null;function ss(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ue(t,e,n)}else r.current=null}function Cc(t,e,r){try{r()}catch(n){Ue(t,e,n)}}var kh=!1;function $v(t,e){if(dc=Ho,t=x0(),Cu(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(l=o+s),h!==i||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===r&&++u===s&&(l=o),f===i&&++d===n&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(hc={focusedElem:t,selectionRange:r},Ho=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,S=v.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:tr(e.type,x),S);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(T(163))}}catch(b){Ue(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return v=kh,kh=!1,v}function ii(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Cc(e,r,i)}s=s.next}while(s!==n)}}function Ta(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Pc(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function mp(t){var e=t.alternate;e!==null&&(t.alternate=null,mp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[yr],delete e[wi],delete e[mc],delete e[yv],delete e[vv])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gp(t){return t.tag===5||t.tag===3||t.tag===4}function Eh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ac(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=qo));else if(n!==4&&(t=t.child,t!==null))for(Ac(t,e,r),t=t.sibling;t!==null;)Ac(t,e,r),t=t.sibling}function Tc(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Tc(t,e,r),t=t.sibling;t!==null;)Tc(t,e,r),t=t.sibling}var st=null,nr=!1;function Br(t,e,r){for(r=r.child;r!==null;)yp(t,e,r),r=r.sibling}function yp(t,e,r){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(Sa,r)}catch{}switch(r.tag){case 5:dt||ss(r,e);case 6:var n=st,s=nr;st=null,Br(t,e,r),st=n,nr=s,st!==null&&(nr?(t=st,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):st.removeChild(r.stateNode));break;case 18:st!==null&&(nr?(t=st,r=r.stateNode,t.nodeType===8?ml(t.parentNode,r):t.nodeType===1&&ml(t,r),mi(t)):ml(st,r.stateNode));break;case 4:n=st,s=nr,st=r.stateNode.containerInfo,nr=!0,Br(t,e,r),st=n,nr=s;break;case 0:case 11:case 14:case 15:if(!dt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Cc(r,e,o),s=s.next}while(s!==n)}Br(t,e,r);break;case 1:if(!dt&&(ss(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ue(r,e,l)}Br(t,e,r);break;case 21:Br(t,e,r);break;case 22:r.mode&1?(dt=(n=dt)||r.memoizedState!==null,Br(t,e,r),dt=n):Br(t,e,r);break;default:Br(t,e,r)}}function jh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Rv),e.forEach(function(n){var s=Hv.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Zt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:st=l.stateNode,nr=!1;break e;case 3:st=l.stateNode.containerInfo,nr=!0;break e;case 4:st=l.stateNode.containerInfo,nr=!0;break e}l=l.return}if(st===null)throw Error(T(160));yp(i,o,s),st=null,nr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ue(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vp(e,t),e=e.sibling}function vp(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zt(e,t),fr(t),n&4){try{ii(3,t,t.return),Ta(3,t)}catch(x){Ue(t,t.return,x)}try{ii(5,t,t.return)}catch(x){Ue(t,t.return,x)}}break;case 1:Zt(e,t),fr(t),n&512&&r!==null&&ss(r,r.return);break;case 5:if(Zt(e,t),fr(t),n&512&&r!==null&&ss(r,r.return),t.flags&32){var s=t.stateNode;try{di(s,"")}catch(x){Ue(t,t.return,x)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Uf(s,i),tc(l,o);var u=tc(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Vf(s,h):d==="dangerouslySetInnerHTML"?Wf(s,h):d==="children"?di(s,h):mu(s,d,h,u)}switch(l){case"input":Jl(s,i);break;case"textarea":Bf(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?ls(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?ls(s,!!i.multiple,i.defaultValue,!0):ls(s,!!i.multiple,i.multiple?[]:"",!1))}s[wi]=i}catch(x){Ue(t,t.return,x)}}break;case 6:if(Zt(e,t),fr(t),n&4){if(t.stateNode===null)throw Error(T(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Ue(t,t.return,x)}}break;case 3:if(Zt(e,t),fr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mi(e.containerInfo)}catch(x){Ue(t,t.return,x)}break;case 4:Zt(e,t),fr(t);break;case 13:Zt(e,t),fr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ku=We())),n&4&&jh(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(dt=(u=dt)||d,Zt(e,t),dt=u):Zt(e,t),fr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(G=t,d=t.child;d!==null;){for(h=G=d;G!==null;){switch(f=G,p=f.child,f.tag){case 0:case 11:case 14:case 15:ii(4,f,f.return);break;case 1:ss(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){Ue(n,r,x)}}break;case 5:ss(f,f.return);break;case 22:if(f.memoizedState!==null){Ch(h);continue}}p!==null?(p.return=f,G=p):Ch(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Hf("display",o))}catch(x){Ue(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Ue(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Zt(e,t),fr(t),n&4&&jh(t);break;case 21:break;default:Zt(e,t),fr(t)}}function fr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(gp(r)){var n=r;break e}r=r.return}throw Error(T(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(di(s,""),n.flags&=-33);var i=Eh(t);Tc(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Eh(t);Ac(t,l,o);break;default:throw Error(T(161))}}catch(c){Ue(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zv(t,e,r){G=t,xp(t)}function xp(t,e,r){for(var n=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||so;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||dt;l=so;var u=dt;if(so=o,(dt=c)&&!u)for(G=s;G!==null;)o=G,c=o.child,o.tag===22&&o.memoizedState!==null?Ph(s):c!==null?(c.return=o,G=c):Ph(s);for(;i!==null;)G=i,xp(i),i=i.sibling;G=s,so=l,dt=u}Nh(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):Nh(t)}}function Nh(t){for(;G!==null;){var e=G;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dt||Ta(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!dt)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:tr(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&dh(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}dh(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&mi(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(T(163))}dt||e.flags&512&&Pc(e)}catch(f){Ue(e,e.return,f)}}if(e===t){G=null;break}if(r=e.sibling,r!==null){r.return=e.return,G=r;break}G=e.return}}function Ch(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var r=e.sibling;if(r!==null){r.return=e.return,G=r;break}G=e.return}}function Ph(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Ta(4,e)}catch(c){Ue(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Ue(e,s,c)}}var i=e.return;try{Pc(e)}catch(c){Ue(e,i,c)}break;case 5:var o=e.return;try{Pc(e)}catch(c){Ue(e,o,c)}}}catch(c){Ue(e,e.return,c)}if(e===t){G=null;break}var l=e.sibling;if(l!==null){l.return=e.return,G=l;break}G=e.return}}var Lv=Math.ceil,sa=Rr.ReactCurrentDispatcher,Gu=Rr.ReactCurrentOwner,Yt=Rr.ReactCurrentBatchConfig,xe=0,Ze=null,Ge=null,it=0,Rt=0,is=ln(0),Ke=0,ji=null,$n=0,Oa=0,qu=0,oi=null,jt=null,Ku=0,_s=1/0,Sr=null,ia=!1,Oc=null,tn=null,io=!1,Yr=null,oa=0,ai=0,Ic=null,Ao=-1,To=0;function yt(){return xe&6?We():Ao!==-1?Ao:Ao=We()}function rn(t){return t.mode&1?xe&2&&it!==0?it&-it:wv.transition!==null?(To===0&&(To=n0()),To):(t=ke,t!==0||(t=window.event,t=t===void 0?16:u0(t.type)),t):1}function ar(t,e,r,n){if(50<ai)throw ai=0,Ic=null,Error(T(185));zi(t,r,n),(!(xe&2)||t!==Ze)&&(t===Ze&&(!(xe&2)&&(Oa|=r),Ke===4&&Vr(t,it)),Ot(t,n),r===1&&xe===0&&!(e.mode&1)&&(_s=We()+500,Ca&&cn()))}function Ot(t,e){var r=t.callbackNode;wy(t,e);var n=Wo(t,t===Ze?it:0);if(n===0)r!==null&&Md(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Md(r),e===1)t.tag===0?xv(Ah.bind(null,t)):P0(Ah.bind(null,t)),mv(function(){!(xe&6)&&cn()}),r=null;else{switch(s0(n)){case 1:r=wu;break;case 4:r=t0;break;case 16:r=Fo;break;case 536870912:r=r0;break;default:r=Fo}r=Np(r,wp.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function wp(t,e){if(Ao=-1,To=0,xe&6)throw Error(T(327));var r=t.callbackNode;if(fs()&&t.callbackNode!==r)return null;var n=Wo(t,t===Ze?it:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=aa(t,n);else{e=n;var s=xe;xe|=2;var i=_p();(Ze!==t||it!==e)&&(Sr=null,_s=We()+500,Pn(t,e));do try{Uv();break}catch(l){bp(t,l)}while(!0);Iu(),sa.current=i,xe=s,Ge!==null?e=0:(Ze=null,it=0,e=Ke)}if(e!==0){if(e===2&&(s=oc(t),s!==0&&(n=s,e=Rc(t,s))),e===1)throw r=ji,Pn(t,0),Vr(t,n),Ot(t,We()),r;if(e===6)Vr(t,n);else{if(s=t.current.alternate,!(n&30)&&!Mv(s)&&(e=aa(t,n),e===2&&(i=oc(t),i!==0&&(n=i,e=Rc(t,i))),e===1))throw r=ji,Pn(t,0),Vr(t,n),Ot(t,We()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(T(345));case 2:yn(t,jt,Sr);break;case 3:if(Vr(t,n),(n&130023424)===n&&(e=Ku+500-We(),10<e)){if(Wo(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){yt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=pc(yn.bind(null,t,jt,Sr),e);break}yn(t,jt,Sr);break;case 4:if(Vr(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-or(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=We()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Lv(n/1960))-n,10<n){t.timeoutHandle=pc(yn.bind(null,t,jt,Sr),n);break}yn(t,jt,Sr);break;case 5:yn(t,jt,Sr);break;default:throw Error(T(329))}}}return Ot(t,We()),t.callbackNode===r?wp.bind(null,t):null}function Rc(t,e){var r=oi;return t.current.memoizedState.isDehydrated&&(Pn(t,e).flags|=256),t=aa(t,e),t!==2&&(e=jt,jt=r,e!==null&&$c(e)),t}function $c(t){jt===null?jt=t:jt.push.apply(jt,t)}function Mv(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!cr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vr(t,e){for(e&=~qu,e&=~Oa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-or(e),n=1<<r;t[r]=-1,e&=~n}}function Ah(t){if(xe&6)throw Error(T(327));fs();var e=Wo(t,0);if(!(e&1))return Ot(t,We()),null;var r=aa(t,e);if(t.tag!==0&&r===2){var n=oc(t);n!==0&&(e=n,r=Rc(t,n))}if(r===1)throw r=ji,Pn(t,0),Vr(t,e),Ot(t,We()),r;if(r===6)throw Error(T(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,yn(t,jt,Sr),Ot(t,We()),null}function Yu(t,e){var r=xe;xe|=1;try{return t(e)}finally{xe=r,xe===0&&(_s=We()+500,Ca&&cn())}}function zn(t){Yr!==null&&Yr.tag===0&&!(xe&6)&&fs();var e=xe;xe|=1;var r=Yt.transition,n=ke;try{if(Yt.transition=null,ke=1,t)return t()}finally{ke=n,Yt.transition=r,xe=e,!(xe&6)&&cn()}}function Ju(){Rt=is.current,Oe(is)}function Pn(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,pv(r)),Ge!==null)for(r=Ge.return;r!==null;){var n=r;switch(Au(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ko();break;case 3:ws(),Oe(At),Oe(ft),Du();break;case 5:Mu(n);break;case 4:ws();break;case 13:Oe(ze);break;case 19:Oe(ze);break;case 10:Ru(n.type._context);break;case 22:case 23:Ju()}r=r.return}if(Ze=t,Ge=t=nn(t.current,null),it=Rt=e,Ke=0,ji=null,qu=Oa=$n=0,jt=oi=null,jn!==null){for(e=0;e<jn.length;e++)if(r=jn[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}jn=null}return t}function bp(t,e){do{var r=Ge;try{if(Iu(),No.current=na,ra){for(var n=Le.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ra=!1}if(Rn=0,Xe=qe=Le=null,si=!1,Si=0,Gu.current=null,r===null||r.return===null){Ke=1,ji=e,Ge=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=it,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=yh(o);if(p!==null){p.flags&=-257,vh(p,o,l,i,e),p.mode&1&&gh(i,u,e),e=p,c=u;var v=e.updateQueue;if(v===null){var x=new Set;x.add(c),e.updateQueue=x}else v.add(c);break e}else{if(!(e&1)){gh(i,u,e),Xu();break e}c=Error(T(426))}}else if(Re&&l.mode&1){var S=yh(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),vh(S,o,l,i,e),Tu(bs(c,l));break e}}i=c=bs(c,l),Ke!==4&&(Ke=2),oi===null?oi=[i]:oi.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=sp(i,c,e);uh(i,g);break e;case 1:l=c;var m=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(tn===null||!tn.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=ip(i,l,e);uh(i,b);break e}}i=i.return}while(i!==null)}kp(r)}catch(E){e=E,Ge===r&&r!==null&&(Ge=r=r.return);continue}break}while(!0)}function _p(){var t=sa.current;return sa.current=na,t===null?na:t}function Xu(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ze===null||!($n&268435455)&&!(Oa&268435455)||Vr(Ze,it)}function aa(t,e){var r=xe;xe|=2;var n=_p();(Ze!==t||it!==e)&&(Sr=null,Pn(t,e));do try{Dv();break}catch(s){bp(t,s)}while(!0);if(Iu(),xe=r,sa.current=n,Ge!==null)throw Error(T(261));return Ze=null,it=0,Ke}function Dv(){for(;Ge!==null;)Sp(Ge)}function Uv(){for(;Ge!==null&&!dy();)Sp(Ge)}function Sp(t){var e=jp(t.alternate,t,Rt);t.memoizedProps=t.pendingProps,e===null?kp(t):Ge=e,Gu.current=null}function kp(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Iv(r,e),r!==null){r.flags&=32767,Ge=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ke=6,Ge=null;return}}else if(r=Ov(r,e,Rt),r!==null){Ge=r;return}if(e=e.sibling,e!==null){Ge=e;return}Ge=e=t}while(e!==null);Ke===0&&(Ke=5)}function yn(t,e,r){var n=ke,s=Yt.transition;try{Yt.transition=null,ke=1,Bv(t,e,r,n)}finally{Yt.transition=s,ke=n}return null}function Bv(t,e,r,n){do fs();while(Yr!==null);if(xe&6)throw Error(T(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(T(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(by(t,i),t===Ze&&(Ge=Ze=null,it=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||io||(io=!0,Np(Fo,function(){return fs(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var o=ke;ke=1;var l=xe;xe|=4,Gu.current=null,$v(t,r),vp(r,t),av(hc),Ho=!!dc,hc=dc=null,t.current=r,zv(r),hy(),xe=l,ke=o,Yt.transition=i}else t.current=r;if(io&&(io=!1,Yr=t,oa=s),i=t.pendingLanes,i===0&&(tn=null),my(r.stateNode),Ot(t,We()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ia)throw ia=!1,t=Oc,Oc=null,t;return oa&1&&t.tag!==0&&fs(),i=t.pendingLanes,i&1?t===Ic?ai++:(ai=0,Ic=t):ai=0,cn(),null}function fs(){if(Yr!==null){var t=s0(oa),e=Yt.transition,r=ke;try{if(Yt.transition=null,ke=16>t?16:t,Yr===null)var n=!1;else{if(t=Yr,Yr=null,oa=0,xe&6)throw Error(T(331));var s=xe;for(xe|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(G=u;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:ii(8,d,i)}var h=d.child;if(h!==null)h.return=d,G=h;else for(;G!==null;){d=G;var f=d.sibling,p=d.return;if(mp(d),d===u){G=null;break}if(f!==null){f.return=p,G=f;break}G=p}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ii(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,G=g;break e}G=i.return}}var m=t.current;for(G=m;G!==null;){o=G;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,G=y;else e:for(o=m;G!==null;){if(l=G,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ta(9,l)}}catch(E){Ue(l,l.return,E)}if(l===o){G=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,G=b;break e}G=l.return}}if(xe=s,cn(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(Sa,t)}catch{}n=!0}return n}finally{ke=r,Yt.transition=e}}return!1}function Th(t,e,r){e=bs(r,e),e=sp(t,e,1),t=en(t,e,1),e=yt(),t!==null&&(zi(t,1,e),Ot(t,e))}function Ue(t,e,r){if(t.tag===3)Th(t,t,r);else for(;e!==null;){if(e.tag===3){Th(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(tn===null||!tn.has(n))){t=bs(r,t),t=ip(e,t,1),e=en(e,t,1),t=yt(),e!==null&&(zi(e,1,t),Ot(e,t));break}}e=e.return}}function Fv(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=yt(),t.pingedLanes|=t.suspendedLanes&r,Ze===t&&(it&r)===r&&(Ke===4||Ke===3&&(it&130023424)===it&&500>We()-Ku?Pn(t,0):qu|=r),Ot(t,e)}function Ep(t,e){e===0&&(t.mode&1?(e=Yi,Yi<<=1,!(Yi&130023424)&&(Yi=4194304)):e=1);var r=yt();t=Tr(t,e),t!==null&&(zi(t,e,r),Ot(t,r))}function Wv(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Ep(t,r)}function Hv(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(T(314))}n!==null&&n.delete(e),Ep(t,r)}var jp;jp=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||At.current)Ct=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ct=!1,Tv(t,e,r);Ct=!!(t.flags&131072)}else Ct=!1,Re&&e.flags&1048576&&A0(e,Xo,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Po(t,e),t=e.pendingProps;var s=ys(e,ft.current);hs(e,r),s=Bu(null,e,n,t,s,r);var i=Fu();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tt(n)?(i=!0,Yo(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zu(e),s.updater=Aa,e.stateNode=s,s._reactInternals=e,bc(e,n,t,r),e=kc(null,e,n,!0,i,r)):(e.tag=0,Re&&i&&Pu(e),gt(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Po(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Gv(n),t=tr(n,t),s){case 0:e=Sc(null,e,n,t,r);break e;case 1:e=bh(null,e,n,t,r);break e;case 11:e=xh(null,e,n,t,r);break e;case 14:e=wh(null,e,n,tr(n.type,t),r);break e}throw Error(T(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:tr(n,s),Sc(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:tr(n,s),bh(t,e,n,s,r);case 3:e:{if(cp(e),t===null)throw Error(T(387));n=e.pendingProps,i=e.memoizedState,s=i.element,z0(t,e),ea(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=bs(Error(T(423)),e),e=_h(t,e,n,r,s);break e}else if(n!==s){s=bs(Error(T(424)),e),e=_h(t,e,n,r,s);break e}else for(zt=Zr(e.stateNode.containerInfo.firstChild),Dt=e,Re=!0,ir=null,r=R0(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vs(),n===s){e=Or(t,e,r);break e}gt(t,e,n,r)}e=e.child}return e;case 5:return L0(e),t===null&&vc(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,fc(n,s)?o=null:i!==null&&fc(n,i)&&(e.flags|=32),lp(t,e),gt(t,e,o,r),e.child;case 6:return t===null&&vc(e),null;case 13:return up(t,e,r);case 4:return Lu(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=xs(e,null,n,r):gt(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:tr(n,s),xh(t,e,n,s,r);case 7:return gt(t,e,e.pendingProps,r),e.child;case 8:return gt(t,e,e.pendingProps.children,r),e.child;case 12:return gt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pe(Qo,n._currentValue),n._currentValue=o,i!==null)if(cr(i.value,o)){if(i.children===s.children&&!At.current){e=Or(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Nr(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),xc(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(T(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),xc(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}gt(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,hs(e,r),s=Jt(s),n=n(s),e.flags|=1,gt(t,e,n,r),e.child;case 14:return n=e.type,s=tr(n,e.pendingProps),s=tr(n.type,s),wh(t,e,n,s,r);case 15:return op(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:tr(n,s),Po(t,e),e.tag=1,Tt(n)?(t=!0,Yo(e)):t=!1,hs(e,r),np(e,n,s),bc(e,n,s,r),kc(null,e,n,!0,t,r);case 19:return dp(t,e,r);case 22:return ap(t,e,r)}throw Error(T(156,e.tag))};function Np(t,e){return e0(t,e)}function Vv(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kt(t,e,r,n){return new Vv(t,e,r,n)}function Qu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Gv(t){if(typeof t=="function")return Qu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yu)return 11;if(t===vu)return 14}return 2}function nn(t,e){var r=t.alternate;return r===null?(r=Kt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Oo(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")Qu(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Yn:return An(r.children,s,i,e);case gu:o=8,s|=8;break;case Vl:return t=Kt(12,r,e,s|2),t.elementType=Vl,t.lanes=i,t;case Gl:return t=Kt(13,r,e,s),t.elementType=Gl,t.lanes=i,t;case ql:return t=Kt(19,r,e,s),t.elementType=ql,t.lanes=i,t;case Lf:return Ia(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $f:o=10;break e;case zf:o=9;break e;case yu:o=11;break e;case vu:o=14;break e;case Fr:o=16,n=null;break e}throw Error(T(130,t==null?t:typeof t,""))}return e=Kt(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function An(t,e,r,n){return t=Kt(7,t,n,e),t.lanes=r,t}function Ia(t,e,r,n){return t=Kt(22,t,n,e),t.elementType=Lf,t.lanes=r,t.stateNode={isHidden:!1},t}function Sl(t,e,r){return t=Kt(6,t,null,e),t.lanes=r,t}function kl(t,e,r){return e=Kt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qv(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sl(0),this.expirationTimes=sl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sl(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zu(t,e,r,n,s,i,o,l,c){return t=new qv(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Kt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},zu(i),t}function Kv(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kn,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Cp(t){if(!t)return on;t=t._reactInternals;e:{if(Mn(t)!==t||t.tag!==1)throw Error(T(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(T(171))}if(t.tag===1){var r=t.type;if(Tt(r))return C0(t,r,e)}return e}function Pp(t,e,r,n,s,i,o,l,c){return t=Zu(r,n,!0,t,s,i,o,l,c),t.context=Cp(null),r=t.current,n=yt(),s=rn(r),i=Nr(n,s),i.callback=e??null,en(r,i,s),t.current.lanes=s,zi(t,s,n),Ot(t,n),t}function Ra(t,e,r,n){var s=e.current,i=yt(),o=rn(s);return r=Cp(r),e.context===null?e.context=r:e.pendingContext=r,e=Nr(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=en(s,e,o),t!==null&&(ar(t,s,o,i),jo(t,s,o)),o}function la(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Oh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function ed(t,e){Oh(t,e),(t=t.alternate)&&Oh(t,e)}function Yv(){return null}var Ap=typeof reportError=="function"?reportError:function(t){console.error(t)};function td(t){this._internalRoot=t}$a.prototype.render=td.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(T(409));Ra(t,e,null,null)};$a.prototype.unmount=td.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zn(function(){Ra(null,t,null,null)}),e[Ar]=null}};function $a(t){this._internalRoot=t}$a.prototype.unstable_scheduleHydration=function(t){if(t){var e=a0();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Hr.length&&e!==0&&e<Hr[r].priority;r++);Hr.splice(r,0,t),r===0&&c0(t)}};function rd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function za(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ih(){}function Jv(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=la(o);i.call(u)}}var o=Pp(e,n,t,0,null,!1,!1,"",Ih);return t._reactRootContainer=o,t[Ar]=o.current,vi(t.nodeType===8?t.parentNode:t),zn(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=la(c);l.call(u)}}var c=Zu(t,0,!1,null,null,!1,!1,"",Ih);return t._reactRootContainer=c,t[Ar]=c.current,vi(t.nodeType===8?t.parentNode:t),zn(function(){Ra(e,c,r,n)}),c}function La(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=la(o);l.call(c)}}Ra(e,o,t,s)}else o=Jv(r,e,t,s,n);return la(o)}i0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ks(e.pendingLanes);r!==0&&(bu(e,r|1),Ot(e,We()),!(xe&6)&&(_s=We()+500,cn()))}break;case 13:zn(function(){var n=Tr(t,1);if(n!==null){var s=yt();ar(n,t,1,s)}}),ed(t,1)}};_u=function(t){if(t.tag===13){var e=Tr(t,134217728);if(e!==null){var r=yt();ar(e,t,134217728,r)}ed(t,134217728)}};o0=function(t){if(t.tag===13){var e=rn(t),r=Tr(t,e);if(r!==null){var n=yt();ar(r,t,e,n)}ed(t,e)}};a0=function(){return ke};l0=function(t,e){var r=ke;try{return ke=t,e()}finally{ke=r}};nc=function(t,e,r){switch(e){case"input":if(Jl(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Na(n);if(!s)throw Error(T(90));Df(n),Jl(n,s)}}}break;case"textarea":Bf(t,r);break;case"select":e=r.value,e!=null&&ls(t,!!r.multiple,e,!1)}};Kf=Yu;Yf=zn;var Xv={usingClientEntryPoint:!1,Events:[Mi,Zn,Na,Gf,qf,Yu]},Bs={findFiberByHostInstance:En,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qv={bundleType:Bs.bundleType,version:Bs.version,rendererPackageName:Bs.rendererPackageName,rendererConfig:Bs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Qf(t),t===null?null:t.stateNode},findFiberByHostInstance:Bs.findFiberByHostInstance||Yv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oo.isDisabled&&oo.supportsFiber)try{Sa=oo.inject(Qv),vr=oo}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xv;Bt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rd(e))throw Error(T(200));return Kv(t,e,null,r)};Bt.createRoot=function(t,e){if(!rd(t))throw Error(T(299));var r=!1,n="",s=Ap;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Zu(t,1,!1,null,null,r,!1,n,s),t[Ar]=e.current,vi(t.nodeType===8?t.parentNode:t),new td(e)};Bt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(T(188)):(t=Object.keys(t).join(","),Error(T(268,t)));return t=Qf(e),t=t===null?null:t.stateNode,t};Bt.flushSync=function(t){return zn(t)};Bt.hydrate=function(t,e,r){if(!za(e))throw Error(T(200));return La(null,t,e,!0,r)};Bt.hydrateRoot=function(t,e,r){if(!rd(t))throw Error(T(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=Ap;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Pp(e,null,t,1,r??null,s,!1,i,o),t[Ar]=e.current,vi(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new $a(e)};Bt.render=function(t,e,r){if(!za(e))throw Error(T(200));return La(null,t,e,!1,r)};Bt.unmountComponentAtNode=function(t){if(!za(t))throw Error(T(40));return t._reactRootContainer?(zn(function(){La(null,null,t,!1,function(){t._reactRootContainer=null,t[Ar]=null})}),!0):!1};Bt.unstable_batchedUpdates=Yu;Bt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!za(r))throw Error(T(200));if(t==null||t._reactInternals===void 0)throw Error(T(38));return La(t,e,r,!1,n)};Bt.version="18.3.1-next-f1338f8080-20240426";function Tp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Tp)}catch(t){console.error(t)}}Tp(),Tf.exports=Bt;var Zv=Tf.exports,Rh=Zv;Wl.createRoot=Rh.createRoot,Wl.hydrateRoot=Rh.hydrateRoot;const ex="modulepreload",tx=function(t){return"/"+t},$h={},be=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=Promise.allSettled(r.map(c=>{if(c=tx(c),c in $h)return;$h[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":ex,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Qt={F:[[0,0],[0,1],[1,1],[2,1],[1,2]],I:[[0,0],[0,1],[0,2],[0,3],[0,4]],L:[[0,0],[0,1],[0,2],[0,3],[1,3]],N:[[0,1],[0,2],[0,3],[1,0],[1,1]],P:[[0,0],[1,0],[0,1],[1,1],[0,2]],T:[[0,0],[1,0],[2,0],[1,1],[1,2]],U:[[0,0],[0,1],[1,1],[2,0],[2,1]],V:[[0,0],[0,1],[0,2],[1,2],[2,2]],W:[[0,0],[0,1],[1,1],[1,2],[2,2]],X:[[1,0],[0,1],[1,1],[2,1],[1,2]],Y:[[0,1],[1,0],[1,1],[1,2],[1,3]],Z:[[0,0],[1,0],[1,1],[1,2],[2,2]]},li={F:"bg-gradient-to-br from-fuchsia-300 via-fuchsia-500 to-fuchsia-800 shadow-[0_0_12px_rgba(232,121,249,0.8),0_0_25px_rgba(232,121,249,0.4),inset_0_1px_2px_rgba(255,255,255,0.6),inset_0_-1px_2px_rgba(0,0,0,0.5)] border border-fuchsia-200/80 ring-1 ring-fuchsia-400/40",I:"bg-gradient-to-br from-cyan-200 via-cyan-500 to-cyan-800 shadow-[0_0_15px_rgba(34,211,238,0.9),0_0_30px_rgba(34,211,238,0.4),inset_0_1px_2px_rgba(255,255,255,0.7),inset_0_-1px_2px_rgba(0,0,0,0.4)] border border-cyan-200/80 ring-1 ring-cyan-300/50",L:"bg-gradient-to-br from-orange-200 via-orange-500 to-orange-800 shadow-[0_0_12px_rgba(251,146,60,0.8),0_0_25px_rgba(251,146,60,0.4),inset_0_1px_2px_rgba(255,255,255,0.6),inset_0_-1px_2px_rgba(0,0,0,0.5)] border border-orange-200/80 ring-1 ring-orange-400/40",N:"bg-gradient-to-br from-blue-200 via-blue-500 to-blue-800 shadow-[0_0_12px_rgba(59,130,246,0.8),0_0_25px_rgba(59,130,246,0.4),inset_0_1px_2px_rgba(255,255,255,0.6),inset_0_-1px_2px_rgba(0,0,0,0.5)] border border-blue-200/80 ring-1 ring-blue-400/40",P:"bg-gradient-to-br from-violet-300 via-violet-600 to-violet-900 shadow-[0_0_12px_rgba(139,92,246,0.8),0_0_25px_rgba(139,92,246,0.4),inset_0_1px_2px_rgba(255,255,255,0.5),inset_0_-1px_2px_rgba(0,0,0,0.6)] border border-violet-200/80 ring-1 ring-violet-400/40",T:"bg-gradient-to-br from-slate-100 via-slate-400 to-slate-700 shadow-[0_0_10px_rgba(148,163,184,0.6),0_0_20px_rgba(148,163,184,0.3),inset_0_2px_3px_rgba(255,255,255,0.8),inset_0_-2px_3px_rgba(0,0,0,0.4)] border border-slate-100/90 ring-1 ring-slate-300/50",U:"bg-gradient-to-br from-yellow-100 via-yellow-400 to-yellow-700 shadow-[0_0_15px_rgba(253,224,71,0.9),0_0_30px_rgba(253,224,71,0.4),inset_0_1px_2px_rgba(255,255,255,0.7),inset_0_-1px_2px_rgba(0,0,0,0.3)] border border-yellow-100/80 ring-1 ring-yellow-300/50",V:"bg-gradient-to-br from-emerald-200 via-emerald-500 to-emerald-800 shadow-[0_0_12px_rgba(52,211,153,0.8),0_0_25px_rgba(52,211,153,0.4),inset_0_1px_2px_rgba(255,255,255,0.6),inset_0_-1px_2px_rgba(0,0,0,0.5)] border border-emerald-200/80 ring-1 ring-emerald-400/40",W:"bg-gradient-to-br from-red-200 via-red-500 to-red-800 shadow-[0_0_12px_rgba(239,68,68,0.8),0_0_25px_rgba(239,68,68,0.4),inset_0_1px_2px_rgba(255,255,255,0.5),inset_0_-1px_2px_rgba(0,0,0,0.6)] border border-red-200/80 ring-1 ring-red-400/40",X:"bg-gradient-to-br from-white via-gray-100 to-gray-300 shadow-[0_0_8px_rgba(255,255,255,0.6),0_0_14px_rgba(200,200,220,0.25),inset_0_2px_3px_rgba(255,255,255,1),inset_0_-2px_3px_rgba(100,100,120,0.2)] border border-gray-200/80 ring-1 ring-white/40",Y:"bg-gradient-to-br from-pink-200 via-pink-500 to-rose-700 shadow-[0_0_15px_rgba(236,72,153,0.9),0_0_30px_rgba(244,114,182,0.5),inset_0_1px_2px_rgba(255,255,255,0.7),inset_0_-1px_2px_rgba(0,0,0,0.4)] border border-pink-200/80 ring-1 ring-pink-400/50",Z:"bg-gradient-to-br from-lime-200 via-lime-500 to-lime-700 shadow-[0_0_15px_rgba(163,230,53,0.9),0_0_30px_rgba(163,230,53,0.4),inset_0_1px_2px_rgba(255,255,255,0.7),inset_0_-1px_2px_rgba(0,0,0,0.3)] border border-lime-100/80 ring-1 ring-lime-400/50"},de=8,rx=t=>{const e=t.map(([i])=>i),r=t.map(([,i])=>i),n=(Math.min(...e)+Math.max(...e))/2,s=(Math.min(...r)+Math.max(...r))/2;return t.map(([i,o])=>{const l=i-n,c=o-s,u=n+c,d=s-l;return[Math.round(u),Math.round(d)]})},nx=t=>{const e=t.map(([n])=>n),r=(Math.min(...e)+Math.max(...e))/2;return t.map(([n,s])=>{const i=r-(n-r);return[Math.round(i),s]})},sx=t=>{if(!t||t.length===0)return t;const e=Math.min(...t.map(([n])=>n)),r=Math.min(...t.map(([,n])=>n));return t.map(([n,s])=>[n-e,s-r])},Lt=(t,e=0,r=!1)=>{let n=Qt[t];if(!n)return console.error("getPieceCoords: Unknown piece type",t),[];n=[...n.map(i=>[...i])],r&&(n=nx(n));const s=e>=90?Math.floor(e/90):e;for(let i=0;i<s;i++)n=rx(n);return n=sx(n),n},lr=(t,e,r,n)=>{if(!t||!Array.isArray(t))return console.error("canPlacePiece: Invalid board"),!1;if(!n||!Array.isArray(n))return console.error("canPlacePiece: Invalid pieceCoords"),!1;for(const[s,i]of n){const o=e+i,l=r+s;if(o<0||o>=de||l<0||l>=de)return!1;const c=t[o]?.[l];if(c!==null&&c!==0&&c!==void 0)return!1}return!0},zc=(t,e)=>{if(!t||!Array.isArray(t))return console.error("canAnyPieceBePlaced: Invalid board"),!0;const r=Array.isArray(e)?e:[];for(const n of Object.keys(Qt))if(!r.includes(n))for(let s=0;s<2;s++)for(let i=0;i<4;i++){const o=Lt(n,i*90,s===1);for(let l=0;l<de;l++)for(let c=0;c<de;c++)if(lr(t,l,c,o))return!0}return!1},Et=()=>Array(de).fill(null).map(()=>Array(de).fill(null)),zh=(t,e,r,n,s,i,o)=>{const l=t.map(u=>[...u]),c=Array.isArray(e)?e.map(u=>[...u]):Array(de).fill(null).map(()=>Array(de).fill(null));for(const[u,d]of i)l[r+d][n+u]=o,c[r+d][n+u]=s;return{newBoard:l,newBoardPieces:c}},Pt={RANDOM:"random",AVERAGE:"average",PROFESSIONAL:"professional"},El=new Map,nd=(t,e,r)=>{const n=`${t}-${e}-${r}`;return El.has(n)||El.set(n,Lt(t,e,r)),El.get(n)},ix=(t,e,r)=>t.map(([s,i])=>`${e+i},${r+s}`).sort().join("|"),Ma=(t,e,r=!1)=>{const n=Object.keys(Qt).filter(o=>!e.includes(o)),s=[],i=r?new Set:null;for(const o of n)for(let l=0;l<2;l++)for(let c=0;c<4;c++){const u=nd(o,c,l);for(let d=0;d<de;d++)for(let h=0;h<de;h++)if(lr(t,d,h,u)){if(r){const f=o+ix(u,d,h);if(i.has(f))continue;i.add(f)}s.push({pieceType:o,row:d,col:h,rot:c,flip:l===1,coords:u})}}return s},ox=(t,e)=>{const r=Object.keys(Qt).filter(n=>!e.includes(n));for(const n of r)for(let s=0;s<2;s++)for(let i=0;i<4;i++){const o=nd(n,i,s);for(let l=0;l<de;l++)for(let c=0;c<de;c++)if(lr(t,l,c,o))return!0}return!1},ax=(t,e)=>{const r=Object.keys(Qt).filter(s=>!e.includes(s));let n=0;for(const s of r)e:for(let i=0;i<2;i++)for(let o=0;o<4;o++){const l=nd(s,o,i);for(let c=0;c<de;c++)for(let u=0;u<de;u++)if(lr(t,c,u,l)){n++;break e}}return n},ca=(t,e,r=2)=>{const n=t.map(s=>[...s]);for(const[s,i]of e.coords)n[e.row+i][e.col+s]=r;return n},ua=(t,e,r,n)=>{let s=0;for(const[i,o]of n){const l=e+o,c=r+i;s+=3.5-Math.abs(l-3.5)+(3.5-Math.abs(c-3.5))}return s},Op=(t,e,r)=>{const n=ax(t,e);return r?-n:n};let Lc=0,Mc=0;const lx=2e3,Io=()=>Date.now()-Lc>lx,Dc=(t,e,r,n,s,i)=>{if(Mc++,Io())return 0;if(!ox(t,e))return n?-1e4:1e4;if(r<=0)return Op(t,e,n);const o=Ma(t,e,!0);o.sort((c,u)=>{const d=ua(t,c.row,c.col,c.coords),h=ua(t,u.row,u.col,u.coords);return n?h-d:d-h});const l=o.slice(0,Math.min(6,o.length));if(n){let c=-1/0;for(const u of l){if(Io())break;const d=ca(t,u,2),h=[...e,u.pieceType],f=Dc(d,h,r-1,!1,s,i);if(c=Math.max(c,f),s=Math.max(s,f),i<=s)break}return c}else{let c=1/0;for(const u of l){if(Io())break;const d=ca(t,u,1),h=[...e,u.pieceType],f=Dc(d,h,r-1,!0,s,i);if(c=Math.min(c,f),i=Math.min(i,f),i<=s)break}return c}},cx=(t,e)=>{Lc=Date.now(),Mc=0;const r=Ma(t,e,!0);if(r.length===0)return null;const n=r.map(d=>({...d,quickScore:ua(t,d.row,d.col,d.coords)})).sort((d,h)=>h.quickScore-d.quickScore);if(n.length===1)return console.log("Expert AI: Only one move available"),n[0];const s=12-e.length;let i;s<=4?i=4:s<=6?i=3:i=2;const o=n.slice(0,Math.min(8,n.length));let l=o[0],c=-1/0;for(const d of o){if(Io()){console.log("Expert AI: Time limit reached");break}const h=ca(t,d,2),f=[...e,d.pieceType],p=Dc(h,f,i,!1,-1/0,1/0);if(p>c&&(c=p,l=d),p>5e3){console.log("Expert AI: Found strong winning path");break}}const u=Date.now()-Lc;return console.log(`Expert AI: ${Mc} nodes in ${u}ms, best score: ${c}`),l},ux=(t,e)=>{const r=Ma(t,e,!1);if(r.length===0)return null;const n=Math.floor(Math.random()*r.length);return console.log(`Random opening move: Selected move ${n+1} of ${r.length}`),r[n]},dx=async(t,e,r,n=Pt.AVERAGE)=>{const s=Ma(t,r,!1);if(s.length===0)return null;const i=r.length<2,o=r.length<6;switch(n){case Pt.RANDOM:return s[Math.floor(Math.random()*s.length)];case Pt.PROFESSIONAL:if(i)return console.log("Expert AI: Using random opening move"),ux(t,r);console.log(`Expert AI thinking... (${r.length} pieces placed)`),await new Promise(d=>setTimeout(d,50));const l=cx(t,r);if(l)return l;console.log("Expert AI: Falling back to strategic move");case Pt.AVERAGE:default:if(i){const d=s.filter(f=>f.row>=1&&f.row<=5&&f.col>=1&&f.col<=5),h=d.length>5?d:s;return h[Math.floor(Math.random()*h.length)]}if(o){const d=s.map(f=>({...f,score:ua(t,f.row,f.col,f.coords)+Math.random()*10}));d.sort((f,p)=>p.score-f.score);const h=d.slice(0,Math.min(3,d.length));return h[Math.floor(Math.random()*h.length)]}const c=s.map(d=>{const h=ca(t,d,2),f=[...r,d.pieceType],p=Op(h,f,!0)+Math.random()*5;return{...d,score:p}});c.sort((d,h)=>h.score-d.score);const u=c.slice(0,Math.min(2,c.length));return u[Math.floor(Math.random()*u.length)]}},Ae={EASY:"easy",MEDIUM:"medium",HARD:"hard"},Ip=t=>{switch(t){case Ae.EASY:return 1;case Ae.MEDIUM:return 3;case Ae.HARD:return 5;default:return 1}},Ni=t=>{let e="";for(let r=0;r<de;r++)for(let n=0;n<de;n++)e+=t[r][n]||"G";return e},Ir=(t,e)=>{const r=Object.keys(Qt).filter(s=>!e.includes(s)),n=[];for(const s of r)for(let i=0;i<2;i++)for(let o=0;o<4;o++){const l=Lt(s,o,i===1);for(let c=0;c<de;c++)for(let u=0;u<de;u++)lr(t,c,u,l)&&n.push({pieceType:s,row:c,col:u,rot:o,flip:i===1,coords:l})}return n},jl=t=>{const e=new Set;return t.forEach(r=>e.add(r.pieceType)),Array.from(e)},Uc=(t,e,r,n,s)=>{const i=t.map(l=>[...l]),o=e.map(l=>[...l]);for(const[l,c]of n.coords)i[n.row+c][n.col+l]=s,o[n.row+c][n.col+l]=n.pieceType;return{board:i,boardPieces:o,usedPieces:[...r,n.pieceType]}},hx=(t,e,r,n)=>{const s=Uc(t,e,r,n,1);return Ir(s.board,s.usedPieces).length===0},fx=(t,e,r,n)=>{const s=Uc(t,e,r,n,1),i=Ir(s.board,s.usedPieces);if(i.length===0)return!1;for(const o of i){const l=Uc(s.board,s.boardPieces,s.usedPieces,o,2);if(Ir(l.board,l.usedPieces).length===0)return!0}return!1},sd=()=>{const t=Et(),e=Et(),r=[],n=[];let s=0;for(;;){const i=Ir(t,r);if(i.length===0)break;n.push({board:t.map(l=>[...l]),boardPieces:e.map(l=>[...l]),usedPieces:[...r]});let o;if(s<3){const l=i.filter(c=>Math.abs(c.row-3.5)+Math.abs(c.col-3.5)<4);o=l.length>0?l[Math.floor(Math.random()*l.length)]:i[Math.floor(Math.random()*i.length)]}else o=i[Math.floor(Math.random()*i.length)];for(const[l,c]of o.coords)t[o.row+c][o.col+l]=s%2+1,e[o.row+c][o.col+l]=o.pieceType;r.push(o.pieceType),s++}return{history:n,totalMoves:s}},px=(t=null)=>{for(let e=0;e<50;e++){t&&t(e+1,50);const r=sd();if(r.totalMoves<2)continue;const n=r.totalMoves-1,s=r.history[n];if(!s)continue;const i=Ir(s.board,s.usedPieces);if(i.length===0)continue;const o=[],l=[];for(const h of i)hx(s.board,s.boardPieces,s.usedPieces,h)?o.push(h):fx(s.board,s.boardPieces,s.usedPieces,h)&&l.push(h);const c=jl(o),u=jl(l),d=jl(i);if(o.length>0&&l.length>0&&d.length>=2)return console.log(`EASY puzzle generated: ${c.length} winning pieces, ${u.length} trap pieces, ${d.length} total options`),{id:`puzzle-easy-${Date.now()}`,name:"Easy Puzzle",difficulty:Ae.EASY,description:"1 move remaining - choose wisely!",boardState:Ni(s.boardPieces),usedPieces:[...s.usedPieces],movesRemaining:1,_winningPieces:c,_trapPieces:u}}return console.error("Failed to generate EASY puzzle with traps after 50 attempts"),null},mx=(t=Ae.EASY,e=null)=>{if(t===Ae.EASY)return px(e);const r=Ip(t);for(let n=0;n<30;n++){e&&e(n+1,30);const s=sd();if(s.totalMoves<r){console.log(`Game ${n+1}: Only ${s.totalMoves} moves, need ${r}`);continue}const i=s.totalMoves-r,o=s.history[i];if(!o){console.log(`Game ${n+1}: No state at index ${i}`);continue}if(Ir(o.board,o.usedPieces).length>0){console.log(`Puzzle generated (${t}): ${o.usedPieces.length} pieces placed, exactly ${r} moves to play`);const c={[Ae.EASY]:"Easy",[Ae.MEDIUM]:"Medium",[Ae.HARD]:"Hard"};return{id:`puzzle-${t}-${Date.now()}`,name:`${c[t]} Puzzle`,difficulty:t,description:`${r} moves remaining`,boardState:Ni(o.boardPieces),usedPieces:[...o.usedPieces],movesRemaining:r}}}return console.error(`Failed to generate ${t} puzzle after 30 attempts`),null},gx=()=>{let t=null,e=0;for(let r=0;r<50;r++){const n=sd();if(n.totalMoves<2)continue;const s=n.totalMoves-1,i=n.history[s];if(!i)continue;const o=Ir(i.board,i.usedPieces);if(o.length===0)continue;const l=[];for(const c of o){const u=i.board.map(f=>[...f]),d=[...i.usedPieces,c.pieceType];for(const[f,p]of c.coords)u[c.row+p][c.col+f]=1;zc(u,d)||l.push(c)}if(l.length>0){const c=l.length/o.length;if(c>=1)return console.log(`Speed puzzle generated: ${l.length} winning moves out of ${o.length} total moves (PERFECT - 100%)`),{id:`speed-puzzle-${Date.now()}`,name:"Speed Puzzle",difficulty:Ae.EASY,description:"1 move to win!",boardState:Ni(i.boardPieces),usedPieces:[...i.usedPieces],movesRemaining:1,_winningMoveCount:l.length,_totalMoves:o.length};c>e&&(e=c,t={id:`speed-puzzle-${Date.now()}`,name:"Speed Puzzle",difficulty:Ae.EASY,description:"1 move to win!",boardState:Ni(i.boardPieces),usedPieces:[...i.usedPieces],movesRemaining:1,_winningMoveCount:l.length,_totalMoves:o.length})}}return t&&e>=.5?(console.log(`Speed puzzle generated: ${t._winningMoveCount} winning moves out of ${t._totalMoves} total moves (${Math.round(e*100)}%)`),t):t?(console.log(`Speed puzzle generated (low quality): ${t._winningMoveCount} winning moves out of ${t._totalMoves} total moves (${Math.round(e*100)}%)`),t):(console.error("Failed to generate winning speed puzzle after 50 attempts"),null)},yx=async(t=Ae.EASY,e=!1,r=null)=>{await new Promise(s=>setTimeout(s,50));const n=mx(t,r);if(n&&r){const s=t===Ae.EASY?50:30;r(s,s)}return await new Promise(s=>setTimeout(s,100)),n},W_=async()=>{await new Promise(e=>setTimeout(e,10));const t=gx();return await new Promise(e=>setTimeout(e,10)),t},vx=t=>{let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e=e&e;return e=Math.abs(e),()=>{let r=e+=1831565813;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}},xx=t=>{let e=Et(),r=Et(),n=[];const s=[];let i=1,o=0;for(;o<12;){const l=Ir(e,n);if(l.length===0)break;s.push({board:e.map(d=>[...d]),boardPieces:r.map(d=>[...d]),usedPieces:[...n],player:i});const c=Math.floor(t()*l.length),u=l[c];for(const[d,h]of u.coords)e[u.row+h][u.col+d]=i,r[u.row+h][u.col+d]=u.pieceType;n.push(u.pieceType),o++,i=i===1?2:1}return{history:s,totalMoves:o}},wx=(t,e=Ae.HARD)=>{const r=vx(t),n=Ip(e);for(let s=0;s<30;s++){const i=xx(r);if(i.totalMoves<n)continue;const o=i.totalMoves-n,l=i.history[o];if(!l)continue;const c=Ir(l.board,l.usedPieces);if(c.length>0)return console.log(`Seeded puzzle generated from seed "${t}": ${c.length} possible moves`),{id:`seeded-puzzle-${t}`,name:"Weekly Challenge",difficulty:e,description:`${n} move${n>1?"s":""} to win!`,boardState:Ni(l.boardPieces),usedPieces:[...l.usedPieces],movesRemaining:n,seed:t}}return console.error(`Failed to generate seeded puzzle from seed "${t}" after 30 attempts`),null},H_=async(t,e=Ae.HARD)=>{await new Promise(n=>setTimeout(n,50));const r=wx(t,e);return await new Promise(n=>setTimeout(n,50)),r};class bx{constructor(){this.audioContext=null,this.soundEnabled=this.loadSetting("soundEnabled",!0),this.musicEnabled=this.loadSetting("musicEnabled",!0),this.vibrationEnabled=this.loadSetting("vibrationEnabled",!0),this.musicVolume=this.loadSetting("musicVolume",.3),this.soundVolume=this.loadSetting("soundVolume",.5),this.musicBuffer=null,this.musicSource=null,this.musicGainNode=null,this.isMusicPlaying=!1,this.initialized=!1,this.initPromise=null,this.musicLoaded=!1}loadSetting(e,r){try{const n=localStorage.getItem(`deadblock_${e}`);if(n!==null)return JSON.parse(n)}catch(n){console.warn(`[SoundManager] Failed to load setting ${e}:`,n)}return r}saveSetting(e,r){try{localStorage.setItem(`deadblock_${e}`,JSON.stringify(r))}catch(n){console.warn(`[SoundManager] Failed to save setting ${e}:`,n)}}async init(){return this.initPromise?this.initPromise:this.initialized?Promise.resolve():(this.initPromise=this._doInit(),this.initPromise)}async _doInit(){try{return this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.audioContext.state==="suspended"&&await this.audioContext.resume(),this.musicGainNode=this.audioContext.createGain(),this.musicGainNode.gain.value=this.musicEnabled?this.musicVolume:0,this.musicGainNode.connect(this.audioContext.destination),this.initialized=!0,console.log("[SoundManager] Audio context created"),this.loadMusicBuffer(),!0}catch(e){return console.warn("[SoundManager] Failed to initialize:",e),!1}}async loadMusicBuffer(){const e=["/audio/background-music.mp3","/sounds/background-music.mp3","/music/background.mp3","/audio/music.mp3"];for(const r of e)try{console.log(`[SoundManager] Trying to load music from: ${r}`);const n=await fetch(r);if(!n.ok)continue;const s=await n.arrayBuffer();this.musicBuffer=await this.audioContext.decodeAudioData(s),this.musicLoaded=!0,console.log(`[SoundManager] Music loaded from: ${r} (duration: ${this.musicBuffer.duration}s)`),this.musicEnabled&&!this.isMusicPlaying&&this.startMusic();return}catch{console.log(`[SoundManager] Failed to load from ${r}`)}console.log("[SoundManager] No background music file found")}toggleSound(){return this.soundEnabled=!this.soundEnabled,this.saveSetting("soundEnabled",this.soundEnabled),this.soundEnabled}toggleMusic(){return this.musicEnabled=!this.musicEnabled,this.saveSetting("musicEnabled",this.musicEnabled),this.musicGainNode&&(this.musicGainNode.gain.value=this.musicEnabled?this.musicVolume:0),this.musicEnabled&&!this.isMusicPlaying&&this.musicBuffer?this.startMusic():!this.musicEnabled&&this.isMusicPlaying&&this.stopMusic(),this.musicEnabled}toggleVibration(){return this.vibrationEnabled=!this.vibrationEnabled,this.saveSetting("vibrationEnabled",this.vibrationEnabled),this.vibrationEnabled}isSoundEnabled(){return this.soundEnabled}isMusicEnabled(){return this.musicEnabled}isVibrationEnabled(){return this.vibrationEnabled}startMusic(){if(!(!this.musicBuffer||this.isMusicPlaying)&&this.audioContext)try{this.audioContext.state==="suspended"&&this.audioContext.resume(),this.musicSource=this.audioContext.createBufferSource(),this.musicSource.buffer=this.musicBuffer,this.musicSource.loop=!0,this.musicSource.connect(this.musicGainNode),this.musicSource.start(0),this.isMusicPlaying=!0,console.log("[SoundManager] Music started (seamless Web Audio loop)")}catch(e){console.warn("[SoundManager] Failed to start music:",e);const r=()=>{this.startMusic(),document.removeEventListener("click",r),document.removeEventListener("touchstart",r)};document.addEventListener("click",r,{once:!0}),document.addEventListener("touchstart",r,{once:!0})}}stopMusic(){if(this.musicSource){try{this.musicSource.stop(),this.musicSource.disconnect()}catch{}this.musicSource=null}this.isMusicPlaying=!1}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),this.saveSetting("musicVolume",this.musicVolume),this.musicGainNode&&this.musicEnabled&&(this.musicGainNode.gain.value=this.musicVolume)}setSoundVolume(e){this.soundVolume=Math.max(0,Math.min(1,e)),this.saveSetting("soundVolume",this.soundVolume)}async playSound(e,r=.1,n="sine",s=.3){if(this.soundEnabled&&(this.initialized||await this.init(),!!this.audioContext)){if(this.audioContext.state==="suspended")try{await this.audioContext.resume()}catch{return}try{const i=this.audioContext.createOscillator(),o=this.audioContext.createGain();i.type=n,i.frequency.setValueAtTime(e,this.audioContext.currentTime);const l=s*this.soundVolume;o.gain.setValueAtTime(l,this.audioContext.currentTime),o.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+r),i.connect(o),o.connect(this.audioContext.destination),i.start(this.audioContext.currentTime),i.stop(this.audioContext.currentTime+r)}catch{}}}async playChord(e,r=.15,n="sine",s=.2){if(this.soundEnabled)for(const i of e)this.playSound(i,r,n,s/e.length)}playButtonClick(){this.playSound(800,.05,"sine",.15)}playClickSound(e){this.playSound(800,.05,"sine",.15)}playPieceSelect(){this.playChord([523,659],.1,"sine",.2)}playPiecePlace(){this.playChord([392,523,659],.15,"sine",.25)}playPieceRotate(){this.playSound(600,.05,"sine",.1)}playPieceFlip(){this.playSound(700,.05,"sine",.1)}playConfirm(){setTimeout(()=>this.playSound(523,.1,"sine",.2),0),setTimeout(()=>this.playSound(659,.1,"sine",.2),50),setTimeout(()=>this.playSound(784,.15,"sine",.25),100)}playInvalid(){this.playChord([200,250],.2,"sawtooth",.15)}playWin(){setTimeout(()=>this.playChord([523,659,784],.2,"sine",.3),0),setTimeout(()=>this.playChord([587,740,880],.2,"sine",.3),200),setTimeout(()=>this.playChord([659,784,988],.3,"sine",.35),400)}playLose(){setTimeout(()=>this.playChord([392,494,587],.2,"sine",.25),0),setTimeout(()=>this.playChord([349,440,523],.2,"sine",.25),200),setTimeout(()=>this.playChord([294,370,440],.4,"sine",.2),400)}playGameOver(){setTimeout(()=>this.playChord([440,554,659],.2,"sine",.25),0),setTimeout(()=>this.playChord([392,494,587],.3,"sine",.2),250)}playPuzzleSolvedSound(){setTimeout(()=>this.playChord([523,659,784],.15,"sine",.3),0),setTimeout(()=>this.playChord([587,740,880],.15,"sine",.3),150),setTimeout(()=>this.playChord([659,784,988],.2,"sine",.35),300),setTimeout(()=>this.playChord([784,988,1175],.3,"sine",.4),450)}playRotate(){this.playSound(600,.05,"sine",.1)}playFlip(){this.playSound(700,.05,"sine",.1)}playMove(){this.playSound(400,.03,"sine",.08)}playNotification(){setTimeout(()=>this.playSound(880,.1,"sine",.2),0),setTimeout(()=>this.playSound(1100,.15,"sine",.25),100)}playMessageReceived(){this.playChord([659,880],.1,"sine",.2)}playCountdown(){this.playSound(440,.1,"sine",.2)}playCountdownFinal(){this.playChord([880,1100],.2,"sine",.3)}vibrate(e=[50]){if(!(!this.vibrationEnabled||!navigator.vibrate))try{navigator.vibrate(e)}catch{}}vibrateShort(){this.vibrate([30])}vibrateMedium(){this.vibrate([50])}vibrateLong(){this.vibrate([100])}vibratePattern(e){this.vibrate(e)}vibrateError(){this.vibrate([50,50,50])}vibrateSuccess(){this.vibrate([30,30,100])}}const J=new bx;if(typeof document<"u"){const t=()=>{J.init(),document.removeEventListener("click",t),document.removeEventListener("touchstart",t)};document.addEventListener("click",t,{once:!0}),document.addEventListener("touchstart",t,{once:!0})}var id={},da={},Bc=function(t,e){return Bc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Bc(t,e)};function Rp(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Bc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ha=function(){return ha=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ha.apply(this,arguments)};function Cs(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function $p(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function zp(t,e){return function(r,n){e(r,n,t)}}function Lp(t,e,r,n,s,i){function o(g){if(g!==void 0&&typeof g!="function")throw new TypeError("Function expected");return g}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!e&&t?n.static?t:t.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,f=!1,p=r.length-1;p>=0;p--){var v={};for(var x in n)v[x]=x==="access"?{}:n[x];for(var x in n.access)v.access[x]=n.access[x];v.addInitializer=function(g){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(g||null))};var S=(0,r[p])(l==="accessor"?{get:d.get,set:d.set}:d[c],v);if(l==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(h=o(S.get))&&(d.get=h),(h=o(S.set))&&(d.set=h),(h=o(S.init))&&s.unshift(h)}else(h=o(S))&&(l==="field"?s.unshift(h):d[c]=h)}u&&Object.defineProperty(u,n.name,d),f=!0}function Mp(t,e,r){for(var n=arguments.length>2,s=0;s<e.length;s++)r=n?e[s].call(t,r):e[s].call(t);return n?r:void 0}function Dp(t){return typeof t=="symbol"?t:"".concat(t)}function Up(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Bp(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function q(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})}function Fp(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Da=Object.create?function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};function Wp(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Da(e,t,r)}function fa(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function od(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function Hp(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(od(arguments[e]));return t}function Vp(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,l=i.length;o<l;o++,s++)n[s]=i[o];return n}function Gp(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function Ss(t){return this instanceof Ss?(this.v=t,this):new Ss(t)}function qp(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(v){return Promise.resolve(v).then(p,h)}}function l(p,v){n[p]&&(s[p]=function(x){return new Promise(function(S,g){i.push([p,x,S,g])>1||c(p,x)})},v&&(s[p]=v(s[p])))}function c(p,v){try{u(n[p](v))}catch(x){f(i[0][3],x)}}function u(p){p.value instanceof Ss?Promise.resolve(p.value.v).then(d,h):f(i[0][2],p)}function d(p){c("next",p)}function h(p){c("throw",p)}function f(p,v){p(v),i.shift(),i.length&&c(i[0][0],i[0][1])}}function Kp(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:Ss(t[s](o)),done:!1}:i?i(o):o}:i}}function Yp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof fa=="function"?fa(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}function Jp(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var _x=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},Fc=function(t){return Fc=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},Fc(t)};function Xp(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Fc(t),n=0;n<r.length;n++)r[n]!=="default"&&Da(e,t,r[n]);return _x(e,t),e}function Qp(t){return t&&t.__esModule?t:{default:t}}function Zp(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function em(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r}function tm(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function rm(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var Sx=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function nm(t){function e(i){t.error=t.hasError?new Sx(i,t.error,"An error was suppressed during disposal."):i,t.hasError=!0}var r,n=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(s,function(o){return e(o),s()})}else n|=1}catch(o){e(o)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}function sm(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,i,o){return n?e?".jsx":".js":s&&(!i||!o)?r:s+i+"."+o.toLowerCase()+"js"}):t}const kx={__extends:Rp,__assign:ha,__rest:Cs,__decorate:$p,__param:zp,__esDecorate:Lp,__runInitializers:Mp,__propKey:Dp,__setFunctionName:Up,__metadata:Bp,__awaiter:q,__generator:Fp,__createBinding:Da,__exportStar:Wp,__values:fa,__read:od,__spread:Hp,__spreadArrays:Vp,__spreadArray:Gp,__await:Ss,__asyncGenerator:qp,__asyncDelegator:Kp,__asyncValues:Yp,__makeTemplateObject:Jp,__importStar:Xp,__importDefault:Qp,__classPrivateFieldGet:Zp,__classPrivateFieldSet:em,__classPrivateFieldIn:tm,__addDisposableResource:rm,__disposeResources:nm,__rewriteRelativeImportExtension:sm},Ex=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:rm,get __assign(){return ha},__asyncDelegator:Kp,__asyncGenerator:qp,__asyncValues:Yp,__await:Ss,__awaiter:q,__classPrivateFieldGet:Zp,__classPrivateFieldIn:tm,__classPrivateFieldSet:em,__createBinding:Da,__decorate:$p,__disposeResources:nm,__esDecorate:Lp,__exportStar:Wp,__extends:Rp,__generator:Fp,__importDefault:Qp,__importStar:Xp,__makeTemplateObject:Jp,__metadata:Bp,__param:zp,__propKey:Dp,__read:od,__rest:Cs,__rewriteRelativeImportExtension:sm,__runInitializers:Mp,__setFunctionName:Up,__spread:Hp,__spreadArray:Gp,__spreadArrays:Vp,__values:fa,default:kx},Symbol.toStringTag,{value:"Module"})),jx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);let Ua=class extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}},im=class extends Ua{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Wc=class extends Ua{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Hc=class extends Ua{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}};var pa;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(pa||(pa={}));class Nx{constructor(e,{headers:r={},customFetch:n,region:s=pa.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=jx(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return q(this,arguments,void 0,function*(r,n={}){var s;let i,o;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=n;let f={},{region:p}=n;p||(p=this.region);const v=new URL(`${this.url}/${r}`);p&&p!=="any"&&(f["x-region"]=p,v.searchParams.set("forceFunctionRegion",p));let x;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(f["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(f["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let S=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(S=o.signal,d.addEventListener("abort",()=>o.abort())):S=o.signal);const g=yield this.fetch(v.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:x,signal:S}).catch(E=>{throw new im(E)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Wc(g);if(!g.ok)throw new Hc(g);let y=((s=g.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield g.json():y==="application/octet-stream"||y==="application/pdf"?b=yield g.blob():y==="text/event-stream"?b=g:y==="multipart/form-data"?b=yield g.formData():b=yield g.text(),{data:b,error:null,response:g}}catch(l){return{data:null,error:l,response:l instanceof Hc||l instanceof Wc?l.context:void 0}}finally{i&&clearTimeout(i)}})}}const Cx=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return pa},FunctionsClient:Nx,FunctionsError:Ua,FunctionsFetchError:im,FunctionsHttpError:Hc,FunctionsRelayError:Wc},Symbol.toStringTag,{value:"Module"})),om=Ri(Cx);var ht={};const Ps=Ri(Ex);var ao={},lo={},co={},uo={},ho={},fo={},Lh;function am(){if(Lh)return fo;Lh=1,Object.defineProperty(fo,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return fo.default=t,fo}var Mh;function lm(){if(Mh)return ho;Mh=1,Object.defineProperty(ho,"__esModule",{value:!0});const e=Ps.__importDefault(am());let r=class{constructor(s){var i,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h,f;let p=null,v=null,x=null,S=c.status,g=c.statusText;if(c.ok){if(this.method!=="HEAD"){const E=await c.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?v=E:v=JSON.parse(E))}const y=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),b=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");y&&b&&b.length>1&&(x=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,x=null,S=406,g="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const y=await c.text();try{p=JSON.parse(y),Array.isArray(p)&&c.status===404&&(v=[],p=null,S=200,g="OK")}catch{c.status===404&&y===""?(S=204,g="No Content"):p={message:y}}if(p&&this.isMaybeSingle&&(!((f=p?.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,S=200,g="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:v,count:x,status:S,statusText:g}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h,f,p,v;let x="";const S=c?.cause;if(S){const g=(u=S?.message)!==null&&u!==void 0?u:"",m=(d=S?.code)!==null&&d!==void 0?d:"";x=`${(h=c?.name)!==null&&h!==void 0?h:"FetchError"}: ${c?.message}`,x+=`

Caused by: ${(f=S?.name)!==null&&f!==void 0?f:"Error"}: ${g}`,m&&(x+=` (${m})`),S?.stack&&(x+=`
${S.stack}`)}else x=(p=c?.stack)!==null&&p!==void 0?p:"";return{error:{message:`${(v=c?.name)!==null&&v!==void 0?v:"FetchError"}: ${c?.message}`,details:x,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}};return ho.default=r,ho}var Dh;function cm(){if(Dh)return uo;Dh=1,Object.defineProperty(uo,"__esModule",{value:!0});const e=Ps.__importDefault(lm());let r=class extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(u,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};return uo.default=r,uo}var Uh;function ad(){if(Uh)return co;Uh=1,Object.defineProperty(co,"__esModule",{value:!0});const e=Ps.__importDefault(cm()),r=new RegExp("[,()]");let n=class extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${u}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}};return co.default=n,co}var Bh;function um(){if(Bh)return lo;Bh=1,Object.defineProperty(lo,"__esModule",{value:!0});const e=Ps.__importDefault(ad());let r=class{constructor(s,{headers:i={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(s,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let u=!1;const d=(s??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const u=s.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(s,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var i;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};return lo.default=r,lo}var Fh;function Px(){if(Fh)return ao;Fh=1,Object.defineProperty(ao,"__esModule",{value:!0});const t=Ps,e=t.__importDefault(um()),r=t.__importDefault(ad());let n=class dm{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new dm(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:u}={}){var d;let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([x,S])=>S!==void 0).map(([x,S])=>[x,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([x,S])=>{f.searchParams.append(x,S)})):(h="POST",p=o);const v=new Headers(this.headers);return u&&v.set("Prefer",`count=${u}`),new r.default({method:h,url:f,headers:v,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}};return ao.default=n,ao}Object.defineProperty(ht,"__esModule",{value:!0});ht.PostgrestError=ht.PostgrestBuilder=ht.PostgrestTransformBuilder=ht.PostgrestFilterBuilder=ht.PostgrestQueryBuilder=ht.PostgrestClient=void 0;const As=Ps,hm=As.__importDefault(Px());ht.PostgrestClient=hm.default;const fm=As.__importDefault(um());ht.PostgrestQueryBuilder=fm.default;const pm=As.__importDefault(ad());ht.PostgrestFilterBuilder=pm.default;const mm=As.__importDefault(cm());ht.PostgrestTransformBuilder=mm.default;const gm=As.__importDefault(lm());ht.PostgrestBuilder=gm.default;const ym=As.__importDefault(am());ht.PostgrestError=ym.default;ht.default={PostgrestClient:hm.default,PostgrestQueryBuilder:fm.default,PostgrestFilterBuilder:pm.default,PostgrestTransformBuilder:mm.default,PostgrestBuilder:gm.default,PostgrestError:ym.default};class vm{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Ax="2.87.0",Tx=`realtime-js/${Ax}`,xm="1.0.0",Ox="2.0.0",Wh=xm,Vc=1e4,Ix=1e3,Rx=100;var _n;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_n||(_n={}));var He;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(He||(He={}));var sr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(sr||(sr={}));var Gc;(function(t){t.websocket="websocket"})(Gc||(Gc={}));var Sn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Sn||(Sn={}));class $x{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n;const s=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var r,n;const s=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,n){var s,i;const o=e.topic,l=(s=e.ref)!==null&&s!==void 0?s:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let v=new DataView(p),x=0;v.setUint8(x++,this.KINDS.userBroadcastPush),v.setUint8(x++,c.length),v.setUint8(x++,l.length),v.setUint8(x++,o.length),v.setUint8(x++,u.length),v.setUint8(x++,h.length),v.setUint8(x++,r),Array.from(c,g=>v.setUint8(x++,g.charCodeAt(0))),Array.from(l,g=>v.setUint8(x++,g.charCodeAt(0))),Array.from(o,g=>v.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>v.setUint8(x++,g.charCodeAt(0))),Array.from(h,g=>v.setUint8(x++,g.charCodeAt(0)));var S=new Uint8Array(p.byteLength+n.byteLength);return S.set(new Uint8Array(p),0),S.set(new Uint8Array(n),p.byteLength),S.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,i,o,l,c]=n;return r({join_ref:s,ref:i,topic:o,event:l,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,s)}}_decodeUserBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(e.slice(c,c+s));c=c+s;const d=n.decode(e.slice(c,c+i));c=c+i;const h=n.decode(e.slice(c,c+o));c=c+o;const f=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,v={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(v.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>r.includes(n)))}}class wm{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ce;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ce||(Ce={}));const Hh=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=zx(o,t,e,s),i),{}):{}},zx=(t,e,r,n)=>{const s=e.find(l=>l.name===t),i=s?.type,o=r[t];return i&&!n.includes(i)?bm(i,o):qc(o)},bm=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Ux(e,r)}switch(t){case Ce.bool:return Lx(e);case Ce.float4:case Ce.float8:case Ce.int2:case Ce.int4:case Ce.int8:case Ce.numeric:case Ce.oid:return Mx(e);case Ce.json:case Ce.jsonb:return Dx(e);case Ce.timestamp:return Bx(e);case Ce.abstime:case Ce.date:case Ce.daterange:case Ce.int4range:case Ce.int8range:case Ce.money:case Ce.reltime:case Ce.text:case Ce.time:case Ce.timestamptz:case Ce.timetz:case Ce.tsrange:case Ce.tstzrange:return qc(e);default:return qc(e)}},qc=t=>t,Lx=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Mx=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Dx=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Ux=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>bm(e,l))}return t},Bx=t=>typeof t=="string"?t.replace(" ","T"):t,_m=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Nl{constructor(e,r,n={},s=Vc){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Kc;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Kc||(Kc={}));let Sm=class Ro{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ro.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Ro.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ro.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(S=>S.presence_ref),p=h.map(S=>S.presence_ref),v=d.filter(S=>p.indexOf(S.presence_ref)<0),x=h.filter(S=>f.indexOf(S.presence_ref)<0);v.length>0&&(l[u]=v),x.length>0&&(c[u]=x)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}n(l,d,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,s(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Yc;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Yc||(Yc={}));var ps;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ps||(ps={}));var gr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(gr||(gr={}));const Fx=He;let km=class Em{constructor(e,r={config:{}},n){var s,i;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=He.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Nl(this,sr.join,this.params,this.timeout),this.rejoinTimer=new wm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=He.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=He.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Sm(this),this.broadcastEndpointURL=_m(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==He.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[ps.PRESENCE]&&this.bindings[ps.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e?.(gr.CHANNEL_ERROR,p)),this._onClose(()=>e?.(gr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var v;if(this.socket.setAuth(),p===void 0){e?.(gr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,S=(v=x?.length)!==null&&v!==void 0?v:0,g=[];for(let m=0;m<S;m++){const y=x[m],{filter:{event:b,schema:E,table:j,filter:_}}=y,k=p&&p[m];if(k&&k.event===b&&k.schema===E&&k.table===j&&k.filter===_)g.push(Object.assign(Object.assign({},y),{id:k.id}));else{this.unsubscribe(),this.state=He.errored,e?.(gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(gr.SUBSCRIBED);return}}).receive("error",p=>{this.state=He.errored,e?.(gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e?.(gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===He.joined&&e===ps.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=He.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Nl(this,sr.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=He.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Nl(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Rx){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=sr;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var v,x,S;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((S=(x=p.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var v,x,S,g,m,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const b=p.id,E=(v=p.filter)===null||v===void 0?void 0:v.event;return b&&((x=r.ids)===null||x===void 0?void 0:x.includes(b))&&(E==="*"||E?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const b=(m=(g=p?.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return b==="*"||b===((y=r?.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:x,table:S,commit_timestamp:g,type:m,errors:y}=v;f=Object.assign(Object.assign({},{schema:x,table:S,commit_timestamp:g,eventType:m,new:{},old:{},errors:y}),this._getPayloadRecords(v))}p.callback(f,n)})}_isClosed(){return this.state===He.closed}_isJoined(){return this.state===He.joined}_isJoining(){return this.state===He.joining}_isLeaving(){return this.state===He.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Em.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(sr.close,{},e)}_onError(e){this._on(sr.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=He.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Hh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Hh(e.columns,e.old_record)),r}};const Cl=()=>{},po={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Wx=[1e3,2e3,5e3,1e4],Hx=1e4,Vx=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let Gx=class{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vc,this.transport=null,this.heartbeatIntervalMs=po.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Cl,this.ref=0,this.reconnectTimer=null,this.vsn=Wh,this.logger=Cl,this.conn=null,this.sendBuffer=[],this.serializer=new $x,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Gc.websocket}`,this.httpEndpoint=_m(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vm.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case _n.connecting:return Sn.Connecting;case _n.open:return Sn.Open;case _n.closing:return Sn.Closing;default:return Sn.Closed}}isConnected(){return this.connectionState()===Sn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new km(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ix,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},po.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===_n.open||this.conn.readyState===_n.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(sr.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Vx],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Tx};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(sr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new wm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},po.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,i,o,l,c,u,d,h,f,p;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:Vc,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:po.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Cl,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Wh,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e?.reconnectAfterMs)!==null&&u!==void 0?u:v=>Wx[v-1]||Hx,this.vsn){case xm:this.encode=(d=e?.encode)!==null&&d!==void 0?d:(v,x)=>x(JSON.stringify(v)),this.decode=(h=e?.decode)!==null&&h!==void 0?h:(v,x)=>x(JSON.parse(v));break;case Ox:this.encode=(f=e?.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}};const qx=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:Fx,get REALTIME_LISTEN_TYPES(){return ps},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Yc},get REALTIME_PRESENCE_LISTEN_EVENTS(){return Kc},get REALTIME_SUBSCRIBE_STATES(){return gr},RealtimeChannel:km,RealtimeClient:Gx,RealtimePresence:Sm,WebSocketFactory:vm},Symbol.toStringTag,{value:"Module"})),jm=Ri(qx);class Ui extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ie(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Nm extends Ui{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ma extends Ui{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const ld=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Kx=()=>Response,Jc=t=>{if(Array.isArray(t))return t.map(r=>Jc(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Jc(n)}),e},Yx=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Jx=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),Pl=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Xx=(t,e,r)=>q(void 0,void 0,void 0,function*(){const n=yield Kx();t instanceof n&&!r?.noResolveJson?t.json().then(s=>{const i=t.status||500,o=s?.statusCode||i+"";e(new Nm(Pl(s),i,o))}).catch(s=>{e(new ma(Pl(s),s))}):e(new ma(Pl(t),t))}),Qx=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"||!n?s:(Yx(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function Bi(t,e,r,n,s,i){return q(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,Qx(e,n,s,i)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Xx(c,l,n))})})}function Ci(t,e,r,n){return q(this,void 0,void 0,function*(){return Bi(t,"GET",e,r,n)})}function rr(t,e,r,n,s){return q(this,void 0,void 0,function*(){return Bi(t,"POST",e,n,s,r)})}function Xc(t,e,r,n,s){return q(this,void 0,void 0,function*(){return Bi(t,"PUT",e,n,s,r)})}function Zx(t,e,r,n){return q(this,void 0,void 0,function*(){return Bi(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function cd(t,e,r,n,s){return q(this,void 0,void 0,function*(){return Bi(t,"DELETE",e,n,s,r)})}class ew{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return q(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ie(e))return{data:null,error:e};throw e}})}}var Cm;class tw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[Cm]="BlobDownloadBuilder",this.promise=null}asStream(){return new ew(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return q(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ie(e))return{data:null,error:e};throw e}})}}Cm=Symbol.toStringTag;const rw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nw{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=ld(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return q(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Vh),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield(e=="PUT"?Xc:rr)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}upload(e,r,n){return q(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return q(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Vh.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Xc(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Ie(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return q(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const i=yield rr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Ui("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}update(e,r,n){return q(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return q(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}copy(e,r,n){return q(this,void 0,void 0,function*(){try{return{data:{path:(yield rr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return q(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield rr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return q(this,void 0,void 0,function*(){try{const s=yield rr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}download(e,r){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>Ci(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new tw(c,this.shouldThrowOnError)}info(e){return q(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Ci(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Jc(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}exists(e){return q(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Zx(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n)&&n instanceof ma){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return q(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}list(e,r,n){return q(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},rw),r),{prefix:e||""});return{data:yield rr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}listV2(e,r){return q(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield rr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Pm="2.87.0",Am={"X-Client-Info":`storage-js/${Pm}`};class sw{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Am),r),this.fetch=ld(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return q(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Ci(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}getBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield Ci(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}createBucket(e){return q(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield rr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return q(this,void 0,void 0,function*(){try{return{data:yield Xc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}emptyBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var Pi=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function iw(t,e,r){const n=new URL(e,t);if(r)for(const[s,i]of Object.entries(r))i!==void 0&&n.searchParams.set(s,i);return n.toString()}async function ow(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function aw(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:i,headers:o}){const l=iw(t.baseUrl,n,s),c=await ow(t.auth),u=await e(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,v=p?.error;throw new Pi(v?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:v?.type,icebergCode:v?.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function mo(t){return t.join("")}var lw=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:mo(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mo(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mo(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mo(t.namespace)}`}),!0}catch(e){if(e instanceof Pi&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Pi&&r.status===409)return;throw r}}};function Fn(t){return t.join("")}var cw=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Fn(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Pi&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Pi&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},uw=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=aw({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new lw(this.client,e),this.tableOps=new cw(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class Tm{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Am),r),this.fetch=ld(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}listBuckets(e){return q(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Ci(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}from(e){if(!Jx(e))throw new Ui("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new uw({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>q(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,o){const l=i[o];return typeof l!="function"?l:(...c)=>q(this,void 0,void 0,function*(){try{return{data:yield l.apply(i,c),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}})}})}}const ud={"X-Client-Info":`storage-js/${Pm}`,"Content-Type":"application/json"};class dd extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Nt(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class $o extends dd{constructor(e,r,n){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Om extends dd{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Qc;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Qc||(Qc={}));const Ba=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),dw=()=>Response,Im=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},hw=t=>Array.from(new Float32Array(t)),fw=(t,e)=>{if(e!==void 0&&t.float32.length!==e)throw new Error(`Vector dimension mismatch: expected ${e}, got ${t.float32.length}`)},Gh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),pw=(t,e,r)=>q(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const s=t.status||500,i=t;if(typeof i.json=="function")i.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new $o(Gh(o),s,l))}).catch(()=>{const o=s+"",l=i.statusText||`HTTP ${s} error`;e(new $o(l,s,o))});else{const o=s+"",l=i.statusText||`HTTP ${s} error`;e(new $o(l,s,o))}}else e(new Om(Gh(t),t))}),mw=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return n?(Im(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r)):s};function gw(t,e,r,n,s,i){return q(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,mw(e,n,s,i)).then(c=>{if(!c.ok)throw c;if(n?.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>pw(c,l,n))})})}function $t(t,e,r,n,s){return q(this,void 0,void 0,function*(){return gw(t,"POST",e,n,s,r)})}class Rm{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ud),r),this.fetch=Ba(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return q(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}getIndex(e,r){return q(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}listIndexes(e){return q(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return q(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}}class $m{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ud),r),this.fetch=Ba(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return q(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield $t(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}getVectors(e){return q(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listVectors(e){return q(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield $t(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}queryVectors(e){return q(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteVectors(e){return q(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield $t(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}class zm{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ud),r),this.fetch=Ba(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return q(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}getBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listBuckets(){return q(this,arguments,void 0,function*(e={}){try{return{data:yield $t(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}class Lm extends zm{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Mm(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return q(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return q(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return q(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return q(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class Mm extends Rm{constructor(e,r,n,s){super(e,r,s),this.vectorBucketName=n}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return q(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return q(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return q(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return q(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Dm(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Dm extends $m{constructor(e,r,n,s,i){super(e,r,i),this.vectorBucketName=n,this.indexName=s}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return q(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return q(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return q(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return q(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return q(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class yw extends sw{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new nw(this.url,this.headers,e,this.fetch)}get vectors(){return new Lm(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Tm(this.url+"/iceberg",this.headers,this.fetch)}}const vw=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:Tm,StorageApiError:Nm,StorageClient:yw,StorageError:Ui,StorageUnknownError:ma,StorageVectorsApiError:$o,StorageVectorsClient:Lm,StorageVectorsError:dd,get StorageVectorsErrorCode(){return Qc},StorageVectorsUnknownError:Om,VectorBucketApi:zm,VectorBucketScope:Mm,VectorDataApi:$m,VectorIndexApi:Rm,VectorIndexScope:Dm,isPlainObject:Im,isStorageError:Ie,isStorageVectorsError:Nt,normalizeToFloat32:hw,resolveFetch:Ba,resolveResponse:dw,validateVectorDimension:fw},Symbol.toStringTag,{value:"Module"})),xw=Ri(vw);var Um={},Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.version=void 0;Fa.version="2.87.0";(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_REALTIME_OPTIONS=t.DEFAULT_AUTH_OPTIONS=t.DEFAULT_DB_OPTIONS=t.DEFAULT_GLOBAL_OPTIONS=t.DEFAULT_HEADERS=void 0;const e=Fa;let r="";typeof Deno<"u"?r="deno":typeof document<"u"?r="web":typeof navigator<"u"&&navigator.product==="ReactNative"?r="react-native":r="node",t.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${r}/${e.version}`},t.DEFAULT_GLOBAL_OPTIONS={headers:t.DEFAULT_HEADERS},t.DEFAULT_DB_OPTIONS={schema:"public"},t.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},t.DEFAULT_REALTIME_OPTIONS={}})(Um);var Bm={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWithAuth=t.resolveHeadersConstructor=t.resolveFetch=void 0;const e=s=>s?(...i)=>s(...i):(...i)=>fetch(...i);t.resolveFetch=e;const r=()=>Headers;t.resolveHeadersConstructor=r;const n=(s,i,o)=>{const l=(0,t.resolveFetch)(o),c=(0,t.resolveHeadersConstructor)();return async(u,d)=>{var h;const f=(h=await i())!==null&&h!==void 0?h:s;let p=new c(d?.headers);return p.has("apikey")||p.set("apikey",s),p.has("Authorization")||p.set("Authorization",`Bearer ${f}`),l(u,Object.assign(Object.assign({},d),{headers:p}))}};t.fetchWithAuth=n})(Bm);var un={};Object.defineProperty(un,"__esModule",{value:!0});un.isBrowser=void 0;un.uuid=ww;un.ensureTrailingSlash=Fm;un.applySettingDefaults=_w;un.validateSupabaseUrl=Sw;function ww(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,r=t=="x"?e:e&3|8;return r.toString(16)})}function Fm(t){return t.endsWith("/")?t:t+"/"}const bw=()=>typeof window<"u";un.isBrowser=bw;function _w(t,e){var r,n;const{db:s,auth:i,realtime:o,global:l}=t,{db:c,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function Sw(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Fm(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Wa={};const Wm="2.87.0",Gn=30*1e3,Zc=3,Al=Zc*Gn,kw="http://localhost:9999",Ew="supabase.auth.token",jw={"X-Client-Info":`gotrue-js/${Wm}`},eu="X-Supabase-Api-Version",Hm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Nw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Cw=10*60*1e3;let ks=class extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}};function Q(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}let Vm=class extends ks{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}};function Gm(t){return Q(t)&&t.name==="AuthApiError"}let Gr=class extends ks{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}},$r=class extends ks{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}},kt=class extends $r{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function qm(t){return Q(t)&&t.name==="AuthSessionMissingError"}let vn=class extends $r{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Js=class extends $r{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},Xs=class extends $r{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function Km(t){return Q(t)&&t.name==="AuthImplicitGrantRedirectError"}let tu=class extends $r{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},ga=class extends $r{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}};function zo(t){return Q(t)&&t.name==="AuthRetryableFetchError"}let ru=class extends $r{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}};function Pw(t){return Q(t)&&t.name==="AuthWeakPasswordError"}let ya=class extends $r{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}};const va="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),qh=` 	
\r=`.split(""),Aw=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<qh.length;e+=1)t[qh[e].charCodeAt(0)]=-2;for(let e=0;e<va.length;e+=1)t[va[e].charCodeAt(0)]=e;return t})();function Kh(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(va[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(va[n]),e.queuedBits-=6}}function Ym(t,e,r){const n=Aw[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Yh(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Iw(o,n,r)};for(let o=0;o<t.length;o+=1)Ym(t.charCodeAt(o),s,i);return e.join("")}function Tw(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Ow(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Tw(n,e)}}function Iw(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function ms(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)Ym(t.charCodeAt(s),r,n);return new Uint8Array(e)}function Rw(t){const e=[];return Ow(t,r=>e.push(r)),new Uint8Array(e)}function Cn(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>Kh(s,r,n)),Kh(null,r,n),e.join("")}function $w(t){return Math.round(Date.now()/1e3)+t}function zw(){return Symbol("auth-callback")}const nt=()=>typeof window<"u"&&typeof document<"u",fn={tested:!1,writable:!1},Jm=()=>{if(!nt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fn.tested)return fn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),fn.tested=!0,fn.writable=!0}catch{fn.tested=!0,fn.writable=!1}return fn.writable};function Lw(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const Xm=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Mw=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",qn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},pn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},rt=async(t,e)=>{await t.removeItem(e)};class Ha{constructor(){this.promise=new Ha.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Ha.promiseConstructor=Promise;function Tl(t){const e=t.split(".");if(e.length!==3)throw new ya("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Nw.test(e[n]))throw new ya("JWT not in base64url format");return{header:JSON.parse(Yh(e[0])),payload:JSON.parse(Yh(e[1])),signature:ms(e[2]),raw:{header:e[0],payload:e[1]}}}async function Dw(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Uw(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Bw(t){return("0"+t.toString(16)).substr(-2)}function Fw(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Bw).join("")}async function Ww(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Hw(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Ww(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wn(t,e,r=!1){const n=Fw();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await qn(t,`${e}-code-verifier`,s);const i=await Hw(n);return[i,n===i?"plain":"s256"]}const Vw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Gw(t){const e=t.headers.get(eu);if(!e||!e.match(Vw))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function qw(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Kw(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Yw=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hn(t){if(!Yw.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ol(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Jw(t,e){return new Proxy(t,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,s)}})}function Jh(t){return JSON.parse(JSON.stringify(t))}const xn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Xw=[502,503,504];async function Xh(t){var e;if(!Mw(t))throw new ga(xn(t),0);if(Xw.includes(t.status))throw new ga(xn(t),t.status);let r;try{r=await t.json()}catch(i){throw new Gr(xn(i),i)}let n;const s=Gw(t);if(s&&s.getTime()>=Hm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ru(xn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new kt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ru(xn(r),t.status,r.weak_password.reasons);throw new Vm(xn(r),t.status||500,n)}const Qw=(t,e,r,n)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function ie(t,e,r,n){var s;const i=Object.assign({},n?.headers);i[eu]||(i[eu]=Hm["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Zw(t,e,r+l,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function Zw(t,e,r,n,s,i){const o=Qw(e,n,s,i);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new ga(xn(c),0)}if(l.ok||await Xh(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await Xh(c)}}function er(t){var e;let r=null;rb(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=$w(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Qh(t){const e=er(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function qr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function eb(t){return{data:t,error:null}}function tb(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,o=Cs(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Zh(t){return t}function rb(t){return t.access_token&&t.refresh_token&&t.expires_in}const Lo=["global","local","others"];let hd=class{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Xm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Lo[0]){if(Lo.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lo.join(", ")}`);try{return await ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qr})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Cs(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:tb,redirectTo:r?.redirectTo})}catch(r){if(Q(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qr})}catch(r){if(Q(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Zh});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(v=>{const x=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);u[`${S}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Q(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Hn(e);try{return await ie(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qr})}catch(r){if(Q(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Hn(e);try{return await ie(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:qr})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Hn(e);try{return await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:qr})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Hn(e.userId);try{const{data:r,error:n}=await ie(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Q(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Hn(e.userId),Hn(e.id);try{return{data:await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Q(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Zh});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(v=>{const x=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);u[`${S}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Q(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Q(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Q(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Q(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Q(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Q(r))return{data:null,error:r};throw r}}};function ef(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const wn={debug:!!(globalThis&&Jm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class fd extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}let Qm=class extends fd{};class nb extends fd{}async function Zm(t,e,r){wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),wn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw wn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Qm(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(wn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const tf={};async function sb(t,e,r){var n;const s=(n=tf[t])!==null&&n!==void 0?n:Promise.resolve(),i=Promise.race([s.catch(()=>null),e>=0?new Promise((o,l)=>{setTimeout(()=>{l(new nb(`Acquring process lock with name "${t}" timed out`))},e)}):null].filter(o=>o)).catch(o=>{if(o&&o.isAcquireTimeout)throw o;return null}).then(async()=>await r());return tf[t]=i.catch(async o=>{if(o&&o.isAcquireTimeout)return await s,null;throw o}),await i}function ib(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function eg(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function ob(t){return parseInt(t,16)}function ab(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function lb(t){var e;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=eg(t.address),v=d?`${d}://${n}`:n,x=t.statement?`${t.statement}
`:"",S=`${v} wants you to sign in with your Ethereum account:
${p}

${x}`;let g=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(g+=`
Expiration Time: ${s.toISOString()}`),l&&(g+=`
Not Before: ${l.toISOString()}`),c&&(g+=`
Request ID: ${c}`),u){let m=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);m+=`
- ${y}`}g+=m}return`${S}
${g}`}class Ve extends Error{constructor({message:e,code:r,cause:n,name:s}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class xa extends Ve{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function cb({error:t,options:e}){var r,n,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ve({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ve({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ve({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ve({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ve({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ve({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ve({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ve({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(tg(o)){if(i.rp.id!==o)return new Ve({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ve({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ve({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ve({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ve({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function ub({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ve({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ve({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(tg(n)){if(r.rpId!==n)return new Ve({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ve({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ve({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ve({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class db{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const hb=new db;function fb(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,s=Cs(t,["challenge","user","excludeCredentials"]),i=ms(e).buffer,o=Object.assign(Object.assign({},r),{id:ms(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:ms(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function pb(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=Cs(t,["challenge","allowCredentials"]),s=ms(e).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:ms(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function mb(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Cn(new Uint8Array(t.response.attestationObject)),clientDataJSON:Cn(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function gb(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Cn(new Uint8Array(s.authenticatorData)),clientDataJSON:Cn(new Uint8Array(s.clientDataJSON)),signature:Cn(new Uint8Array(s.signature)),userHandle:s.userHandle?Cn(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tg(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function rf(){var t,e;return!!(nt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function yb(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xa("Browser returned unexpected credential type",e)}:{data:null,error:new xa("Empty credential response",e)}}catch(e){return{data:null,error:cb({error:e,options:t})}}}async function vb(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xa("Browser returned unexpected credential type",e)}:{data:null,error:new xa("Empty credential response",e)}}catch(e){return{data:null,error:ub({error:e,options:t})}}}const xb={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wb={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function wa(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of t)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(e(o)){const l=n[i];e(l)?n[i]=wa(l,o):n[i]=wa(o)}else n[i]=o}return n}function bb(t,e){return wa(xb,t,e||{})}function _b(t,e){return wa(wb,t,e||{})}class Sb{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:s},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:l};const c=s??hb.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=bb(o.webauthn.credential_options.publicKey,i?.create),{data:d,error:h}=await yb({publicKey:u,signal:c});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=_b(o.webauthn.credential_options.publicKey,i?.request),{data:d,error:h}=await vb(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Q(o)?{data:null,error:o}:{data:null,error:new Gr("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ks("rpId is required for WebAuthn authentication")};try{if(!rf())return{data:null,error:new Gr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return Q(o)?{data:null,error:o}:{data:null,error:new Gr("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ks("rpId is required for WebAuthn registration")};try{if(!rf())return{data:null,error:new Gr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Q(o)?{data:null,error:o}:{data:null,error:new Gr("Unexpected error in register",o)}}}}ib();const kb={url:kw,storageKey:Ew,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:jw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function nf(t,e,r){return await r()}const Vn={};let pd=class nu{get jwks(){var e,r;return(r=(e=Vn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Vn[this.storageKey]=Object.assign(Object.assign({},Vn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Vn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vn[this.storageKey]=Object.assign(Object.assign({},Vn[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},kb),e);if(this.storageKey=i.storageKey,this.instanceID=(r=nu.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,nu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&nt()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new hd({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Xm(i.fetch),this.lock=i.lock||nf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:nt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Zm:this.lock=nf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Sb(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Jm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ef(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=ef(this.memoryStorage)),nt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Wm}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(nt()&&(r=Lw(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),nt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Km(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Q(r)?this._returnResult({error:r}):this._returnResult({error:new Gr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:er}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(Q(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await Wn(this.storage,this.storageKey)),i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:h,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:v},xform:er})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(s=f?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:er})}else throw new Js("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await rt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:l}=e;r=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Qh})}else if("phone"in e){const{phone:i,password:o,options:l}=e;r=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Qh})}else throw new Js("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new vn;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Q(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,s,i,o,l,c,u,d,h,f;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:x,wallet:S,statement:g,options:m}=e;let y;if(nt())if(typeof S=="object")y=S;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")y=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!m?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=S}const b=new URL((r=m?.url)!==null&&r!==void 0?r:window.location.href),E=await y.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const j=eg(E[0]);let _=(n=m?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!_){const O=await y.request({method:"eth_chainId"});_=ob(O)}const k={domain:b.host,address:j,statement:g,uri:b.href,version:"1",chainId:_,nonce:(s=m?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=m?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=m?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=m?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=m?.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m?.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=lb(k),v=await y.request({method:"personal_sign",params:[ab(p),j]})}try{const{data:x,error:S}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:v},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:er});if(S)throw S;if(!x||!x.session||!x.user){const g=new vn;return this._returnResult({data:{user:null,session:null},error:g})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:S})}catch(x){if(Q(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var r,n,s,i,o,l,c,u,d,h,f,p;let v,x;if("message"in e)v=e.message,x=e.signature;else{const{chain:S,wallet:g,statement:m,options:y}=e;let b;if(nt())if(typeof g=="object")b=g;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))b=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=g}const E=new URL((r=y?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const j=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),m?{statement:m}:null));let _;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")_=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)_=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)v=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),x=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${E.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(n=y?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=y?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y?.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(d=y?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const j=await b.signMessage(new TextEncoder().encode(v),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=j}}try{const{data:S,error:g}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Cn(x)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:er});if(g)throw g;if(!S||!S.session||!S.user){const m=new vn;return this._returnResult({data:{user:null,session:null},error:m})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:g})}catch(S){if(Q(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const r=await pn(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:er});if(await rt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new vn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=e,l=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:er}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new vn;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Q(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,s,i,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Wn(this.storage,this.storageKey));const{error:h}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u?.message_id},error:d})}throw new Js("You must provide either an email or phone number.")}catch(l){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:er});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Q(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var r,n,s,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Wn(this.storage,this.storageKey));const u=await ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:eb});return!((i=u.data)===null||i===void 0)&&i.url&&nt()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new kt;const{error:s}=await ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(Q(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:l}=await ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new Js("You must provide either an email or phone number and a type")}catch(r){if(Q(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await pn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Al:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await pn(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Ol()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=Jw(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qr}):await this._useSession(async r=>{var n,s,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kt}:await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:qr})})}catch(r){if(Q(r))return qm(r)&&(await this._removeSession(),await rt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new kt;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Wn(this.storage,this.storageKey));const{data:u,error:d}=await ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:qr});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kt;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=Tl(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Q(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new kt;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Q(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!nt())throw new Xs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new tu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Xs("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new tu("No code detected.");const{data:m,error:y}=await this._exchangeCodeForSession(e.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!o||!u)throw new Xs("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const p=f-d;p*1e3<=Gn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const v=f-h;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:x,error:S}=await this._getUser(i);if(S)throw S;const g={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(n){if(Q(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await pn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({error:i});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Gm(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await rt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=zw(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Wn(this.storage,this.storageKey,!0));try{return await ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ie(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return nt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(Q(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:o,provider:l,token:c,access_token:u,nonce:d}=e,h=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:er}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new vn}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(s){if(await rt(this.storage,`${this.storageKey}-code-verifier`),Q(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await ie(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Uw(async s=>(s>0&&await Dw(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:er})),(s,i)=>{const o=200*Math.pow(2,s);return i&&zo(i)&&Date.now()+o-n<Gn})}catch(n){if(this._debug(r,"error",n),Q(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),nt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await pn(this.storage,this.storageKey);if(s&&this.userStorage){let o=await pn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await qn(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Ol()}else if(s&&!s.user&&!s.user){const o=await pn(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await rt(this.storage,this.storageKey+"-user"),await qn(this.storage,this.storageKey,s)):s.user=Ol()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Al;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Al}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),zo(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new kt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ha;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new kt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Q(i)){const o={data:null,error:i};return zo(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await rt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await qn(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=Jh(s);await qn(this.storage,this.storageKey,i)}else{const s=Jh(r);await qn(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await rt(this.storage,this.storageKey),await rt(this.storage,this.storageKey+"-code-verifier"),await rt(this.storage,this.storageKey+"-user"),this.userStorage&&await rt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&nt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Gn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Gn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Gn}ms, refresh threshold is ${Zc} ticks`),s<=Zc&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof fd)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await Wn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await ie(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await ie(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?mb(e.webauthn.credential_response):gb(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:fb(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:pb(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r?.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Tl(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new kt})})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new kt});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&nt()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Q(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new kt});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&nt()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Q(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;return n?this._returnResult({data:null,error:n}):r?await ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new kt})})}catch(e){if(Q(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new kt})})}catch(r){if(Q(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+Cw>s)return n;const{data:i,error:o}=await ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:v}=await this.getSession();if(v||!p.session)return this._returnResult({data:null,error:v});n=p.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=Tl(n);r?.allowExpired||qw(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:o},error:null}}const d=Kw(s.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,Rw(`${l}.${c}`)))throw new ya("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(Q(n))return this._returnResult({data:null,error:n});throw n}}};pd.nextInstanceID={};const Eb=hd,jb=pd,Nb=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:Eb,AuthApiError:Vm,AuthClient:jb,AuthError:ks,AuthImplicitGrantRedirectError:Xs,AuthInvalidCredentialsError:Js,AuthInvalidJwtError:ya,AuthInvalidTokenResponseError:vn,AuthPKCEGrantCodeExchangeError:tu,AuthRetryableFetchError:ga,AuthSessionMissingError:kt,AuthUnknownError:Gr,AuthWeakPasswordError:ru,CustomAuthError:$r,GoTrueAdminApi:hd,GoTrueClient:pd,NavigatorLockAcquireTimeoutError:Qm,SIGN_OUT_SCOPES:Lo,isAuthApiError:Gm,isAuthError:Q,isAuthImplicitGrantRedirectError:Km,isAuthRetryableFetchError:zo,isAuthSessionMissingError:qm,isAuthWeakPasswordError:Pw,lockInternals:wn,navigatorLock:Zm,processLock:sb},Symbol.toStringTag,{value:"Module"})),rg=Ri(Nb);Object.defineProperty(Wa,"__esModule",{value:!0});Wa.SupabaseAuthClient=void 0;const Cb=rg;class Pb extends Cb.AuthClient{constructor(e){super(e)}}Wa.SupabaseAuthClient=Pb;Object.defineProperty(da,"__esModule",{value:!0});const Ab=om,Tb=ht,Ob=jm,Ib=xw,go=Um,Rb=Bm,sf=un,$b=Wa;let zb=class{constructor(e,r,n){var s,i,o;this.supabaseUrl=e,this.supabaseKey=r;const l=(0,sf.validateSupabaseUrl)(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:go.DEFAULT_DB_OPTIONS,realtime:go.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},go.DEFAULT_AUTH_OPTIONS),{storageKey:c}),global:go.DEFAULT_GLOBAL_OPTIONS},d=(0,sf.applySettingDefaults)(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=(0,Rb.fetchWithAuth)(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new Tb.PostgrestClient(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Ib.StorageClient(this.storageUrl.href,this.headers,this.fetch,n?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Ab.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:o,flowType:l,lock:c,debug:u,throwOnError:d},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $b.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:c,debug:u,throwOnError:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ob.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};da.default=zb;(function(t){var e=Un&&Un.__createBinding||(Object.create?function(d,h,f,p){p===void 0&&(p=f);var v=Object.getOwnPropertyDescriptor(h,f);(!v||("get"in v?!h.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(d,p,v)}:function(d,h,f,p){p===void 0&&(p=f),d[p]=h[f]}),r=Un&&Un.__exportStar||function(d,h){for(var f in d)f!=="default"&&!Object.prototype.hasOwnProperty.call(h,f)&&e(h,d,f)},n=Un&&Un.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(t,"__esModule",{value:!0}),t.createClient=t.SupabaseClient=t.FunctionRegion=t.FunctionsError=t.FunctionsRelayError=t.FunctionsFetchError=t.FunctionsHttpError=t.PostgrestError=void 0;const s=n(da);r(rg,t);var i=ht;Object.defineProperty(t,"PostgrestError",{enumerable:!0,get:function(){return i.PostgrestError}});var o=om;Object.defineProperty(t,"FunctionsHttpError",{enumerable:!0,get:function(){return o.FunctionsHttpError}}),Object.defineProperty(t,"FunctionsFetchError",{enumerable:!0,get:function(){return o.FunctionsFetchError}}),Object.defineProperty(t,"FunctionsRelayError",{enumerable:!0,get:function(){return o.FunctionsRelayError}}),Object.defineProperty(t,"FunctionsError",{enumerable:!0,get:function(){return o.FunctionsError}}),Object.defineProperty(t,"FunctionRegion",{enumerable:!0,get:function(){return o.FunctionRegion}}),r(jm,t);var l=da;Object.defineProperty(t,"SupabaseClient",{enumerable:!0,get:function(){return n(l).default}});const c=(d,h,f)=>new s.default(d,h,f);t.createClient=c;function u(){if(typeof window<"u"||typeof process>"u")return!1;const d=process.version;if(d==null)return!1;const h=d.match(/^v(\d+)\./);return h?parseInt(h[1],10)<=18:!1}u()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(id);const ng=lu(id),Lb=Ng({__proto__:null,default:ng},[id]),{PostgrestError:m2,FunctionsHttpError:g2,FunctionsFetchError:y2,FunctionsRelayError:v2,FunctionsError:x2,FunctionRegion:w2,SupabaseClient:b2,createClient:Mb,GoTrueAdminApi:_2,GoTrueClient:S2,AuthAdminApi:k2,AuthClient:E2,navigatorLock:j2,NavigatorLockAcquireTimeoutError:N2,lockInternals:C2,processLock:P2,SIGN_OUT_SCOPES:A2,AuthError:T2,AuthApiError:O2,AuthUnknownError:I2,CustomAuthError:R2,AuthSessionMissingError:$2,AuthInvalidTokenResponseError:z2,AuthInvalidCredentialsError:L2,AuthImplicitGrantRedirectError:M2,AuthPKCEGrantCodeExchangeError:D2,AuthRetryableFetchError:U2,AuthWeakPasswordError:B2,AuthInvalidJwtError:F2,isAuthError:W2,isAuthApiError:H2,isAuthSessionMissingError:V2,isAuthImplicitGrantRedirectError:G2,isAuthRetryableFetchError:q2,isAuthWeakPasswordError:K2,RealtimePresence:Y2,RealtimeChannel:J2,RealtimeClient:X2,REALTIME_LISTEN_TYPES:Q2,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:Z2,REALTIME_PRESENCE_LISTEN_EVENTS:eS,REALTIME_SUBSCRIBE_STATES:tS,REALTIME_CHANNEL_STATES:rS}=ng||Lb,Db="https://oyeibyrednwlolmsjlwk.supabase.co",Ub="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY",oe=Mb(Db,Ub,{auth:{persistSession:!0,autoRefreshToken:!0},realtime:{params:{eventsPerSecond:10}}}),Qe=()=>!!oe;class Bb{constructor(){this.pendingUpdates=[],this.flushTimeout=null}isAuthenticated(){return!!oe?.auth?.getUser}async updateStat(e,r=1){if(oe)try{const{data:{user:n}}=await oe.auth.getUser();if(!n)return;const{error:s}=await oe.rpc("update_player_stats",{p_user_id:n.id,p_stat_type:e,p_stat_value:r});s?console.error("[Stats] Error updating stat:",e,s):console.log("[Stats] Updated:",e,r)}catch(n){console.error("[Stats] Failed to update stat:",n)}}async recordPuzzleAttempt(e){const r=`puzzle_${e}_attempted`;await this.updateStat(r)}async recordPuzzleSolved(e){const r=`puzzle_${e}_solved`;await this.updateStat(r)}async recordSpeedPuzzleComplete(){await this.updateStat("speed_puzzle_completed")}async recordSpeedSessionComplete(e){await this.updateStat("speed_session_completed"),await this.updateStat("speed_best_streak",e)}async updateSpeedBestStreak(e){await this.updateStat("speed_best_streak",e)}async recordAIGameResult(e,r){const n=`ai_${e}_${r?"win":"loss"}`;await this.updateStat(n)}async recordLocalGame(){await this.updateStat("local_game")}async getStats(){if(!oe)return null;try{const{data:{user:e}}=await oe.auth.getUser();if(!e)return null;const{data:r,error:n}=await oe.from("profiles").select(`
          puzzles_easy_solved,
          puzzles_easy_attempted,
          puzzles_medium_solved,
          puzzles_medium_attempted,
          puzzles_hard_solved,
          puzzles_hard_attempted,
          speed_best_streak,
          speed_total_puzzles,
          speed_total_sessions,
          ai_easy_wins,
          ai_easy_losses,
          ai_medium_wins,
          ai_medium_losses,
          ai_hard_wins,
          ai_hard_losses,
          local_games_played,
          rating,
          games_played,
          games_won,
          last_played_at
        `).eq("id",e.id).single();return n?(console.error("[Stats] Error fetching stats:",n),null):r}catch(e){return console.error("[Stats] Failed to get stats:",e),null}}async getSpeedLeaderboard(e=10){if(!oe)return[];try{const{data:r,error:n}=await oe.from("profiles").select("id, username, display_name, speed_best_streak, rating").gt("speed_best_streak",0).order("speed_best_streak",{ascending:!1}).limit(e);return n?(console.error("[Stats] Error fetching leaderboard:",n),[]):r||[]}catch(r){return console.error("[Stats] Failed to get leaderboard:",r),[]}}calculateDerivedStats(e){if(!e)return null;const r=e.puzzles_easy_attempted||0,n=e.puzzles_medium_attempted||0,s=e.puzzles_hard_attempted||0,i=r>0?Math.round(e.puzzles_easy_solved/r*100):0,o=n>0?Math.round(e.puzzles_medium_solved/n*100):0,l=s>0?Math.round(e.puzzles_hard_solved/s*100):0,c=(e.ai_easy_wins||0)+(e.ai_easy_losses||0),u=(e.ai_medium_wins||0)+(e.ai_medium_losses||0),d=(e.ai_hard_wins||0)+(e.ai_hard_losses||0),h=c>0?Math.round(e.ai_easy_wins/c*100):0,f=u>0?Math.round(e.ai_medium_wins/u*100):0,p=d>0?Math.round(e.ai_hard_wins/d*100):0,v=e.games_played||0,x=v>0?Math.round(e.games_won/v*100):0,S=e.speed_total_sessions>0?Math.round(e.speed_total_puzzles/e.speed_total_sessions):0;return{...e,puzzleEasyWinRate:i,puzzleMediumWinRate:o,puzzleHardWinRate:l,puzzleTotalSolved:(e.puzzles_easy_solved||0)+(e.puzzles_medium_solved||0)+(e.puzzles_hard_solved||0),aiEasyWinRate:h,aiMediumWinRate:f,aiHardWinRate:p,aiTotalWins:(e.ai_easy_wins||0)+(e.ai_medium_wins||0)+(e.ai_hard_wins||0),aiTotalGames:c+u+d,onlineWinRate:x,speedAvgStreak:S}}}const Il=new Bb,Fb=1500,Wb=()=>{const[t,e]=w.useState(()=>Et()),[r,n]=w.useState(()=>Et()),[s,i]=w.useState(1),[o,l]=w.useState(null),[c,u]=w.useState(0),[d,h]=w.useState(!1),[f,p]=w.useState(!1),[v,x]=w.useState(null),[S,g]=w.useState([]),[m,y]=w.useState([]),[b,E]=w.useState(null),[j,_]=w.useState(!1),[k,O]=w.useState(null),[P,Z]=w.useState(null),[K,ne]=w.useState(!1),[R,D]=w.useState(!1),[I,W]=w.useState(Pt.AVERAGE),[N,A]=w.useState(!1),[L,B]=w.useState(null),[te,H]=w.useState(null),C=w.useRef(Ae.EASY),[M,U]=w.useState(Ae.EASY),V=w.useRef(!1),[z,ue]=w.useState(null),fe=w.useCallback($=>{C.current=$,U($)},[]),we=w.useCallback($=>{S.includes($)||f||(l($),O(null),J.playPieceSelect())},[S,f]),_e=w.useCallback(()=>{!o&&!k||(u($=>($+1)%4),J.playPieceRotate())},[o,k]),Ye=w.useCallback(()=>{!o&&!k||(h($=>!$),J.playPieceFlip())},[o,k]),pt=w.useCallback(($,le)=>{if(f||(b==="ai"||b==="puzzle")&&s===2)return;const Ee=k?k.piece:o;Ee&&(O({piece:Ee,row:$,col:le}),J.playClickSound("place"))},[f,b,s,o,k]),at=w.useCallback($=>{if(!k)return;const le=4,Ee={up:[-1,0],down:[1,0],left:[0,-1],right:[0,1]},[ve,Be]=Ee[$]||[0,0],$e=Math.max(-le,Math.min(de+le-1,k.row+ve)),F=Math.max(-le,Math.min(de+le-1,k.col+Be));O({...k,row:$e,col:F}),J.playClickSound("move")},[k]),et=w.useCallback(()=>{if(console.log("[useGameState] confirmMove called:",{hasPendingMove:!!k,pendingMove:k,rotation:c,flipped:d}),!k){console.log("[useGameState] No pending move - returning early");return}const $=Lt(k.piece,c,d);if(console.log("[useGameState] Piece coords:",$),!lr(t,k.row,k.col,$)){console.log("[useGameState] Invalid placement - playing invalid sound"),J.playInvalid();return}console.log("[useGameState] Valid placement - animating..."),H({piece:k.piece,row:k.row,col:k.col,rotation:c,flipped:d}),J.playConfirm(),setTimeout(()=>{const{newBoard:le,newBoardPieces:Ee}=zh(t,r,k.row,k.col,k.piece,$,s),ve={player:s,piece:k.piece,row:k.row,col:k.col,rotation:c,flipped:d,board:t.map($e=>[...$e]),boardPieces:r.map($e=>[...$e])};e(le),n(Ee),g($e=>[...$e,k.piece]),y($e=>[...$e,ve]),l(null),u(0),h(!1),O(null),H(null);const Be=[...S,k.piece];zc(le,Be)?i(s===1?2:1):(p(!0),x(s),J.playWin())},200)},[k,c,d,t,r,s,S]),lt=w.useCallback(()=>{O(null),l(null),u(0),h(!1),J.playCancel()},[]),De=w.useCallback(async()=>{if(!(f||s!==2)&&!(b!=="ai"&&b!=="puzzle")){_(!0),await new Promise($=>setTimeout($,Fb));try{const $=await dx(t,r,S,I);if(!$){_(!1),p(!0),x(1),J.playWin();return}B({piece:$.pieceType,row:$.row,col:$.col,rotation:$.rot,flipped:$.flip}),await new Promise($e=>setTimeout($e,400));const le=Lt($.pieceType,$.rot,$.flip),{newBoard:Ee,newBoardPieces:ve}=zh(t,r,$.row,$.col,$.pieceType,le,2);e(Ee),n(ve),g($e=>[...$e,$.pieceType]),B(null);const Be=[...S,$.pieceType];zc(Ee,Be)?i(1):(p(!0),x(2),J.playLose())}catch($){console.error("AI move error:",$),B(null),_(!1),i(1)}_(!1)}},[t,r,S,f,s,b,I]);w.useEffect(()=>{(b==="ai"||b==="puzzle")&&s===2&&!f&&!j&&De()},[s,b,f,j,De]),w.useEffect(()=>{if(f&&v!==null){const $=v===1;if(b==="ai"){const Ee={[Pt.RANDOM]:"easy",[Pt.AVERAGE]:"medium",[Pt.PROFESSIONAL]:"hard"}[I]||"medium";Il.recordAIGameResult(Ee,$)}else if(b==="puzzle"&&P){const Ee={[Ae.EASY]:"easy",[Ae.MEDIUM]:"medium",[Ae.HARD]:"hard"}[M]||"easy";Il.recordPuzzleAttempt(Ee),$&&Il.recordPuzzleSolved(Ee)}}},[f,v,b,I,M,P]);const Je=w.useCallback($=>{if(!$){console.error("loadPuzzleInternal: No puzzle provided");return}console.log("Loading puzzle:",$.name,"difficulty:",$.difficulty);const le=Et(),Ee=Et();for(let ve=0;ve<64;ve++){const Be=$.boardState[ve];if(Be!=="G"){const $e=Math.floor(ve/8),F=ve%8;le[$e][F]=1,Ee[$e][F]=Be==="H"?"Y":Be}}ue({board:le.map(ve=>[...ve]),boardPieces:Ee.map(ve=>[...ve]),usedPieces:[...$.usedPieces],puzzle:{...$}}),$.difficulty&&fe($.difficulty),e(le),n(Ee),g($.usedPieces),Z($),E("puzzle"),i(1),l(null),u(0),h(!1),y([]),O(null),p(!1),x(null),A(!1),J.playButtonClick()},[fe]),se=w.useCallback(async $=>{A(!0);try{const le=await yx($);le?Je(le):(console.error("Puzzle generation returned null"),A(!1))}catch(le){console.error("Puzzle generation error:",le),A(!1)}},[Je]),X=w.useCallback($=>{$?.boardState?Je($):$?.difficulty?se($.difficulty):se(C.current)},[Je,se]),ye=w.useCallback(()=>{if(!z){console.log("No original puzzle state to reset to");return}console.log("Resetting puzzle to original state"),e(z.board.map($=>[...$])),n(z.boardPieces.map($=>[...$])),g([...z.usedPieces]),Z(z.puzzle),i(1),l(null),u(0),h(!1),y([]),O(null),p(!1),x(null),J.playButtonClick()},[z]),ge=w.useCallback(()=>{b==="puzzle"?(console.log("Reset: generating new puzzle with difficulty:",C.current),se(C.current)):b==="ai"?(console.log("Reset: starting new AI game, aiGoesFirst:",V.current),e(Et()),n(Et()),i(V.current?2:1),l(null),u(0),h(!1),p(!1),x(null),g([]),y([]),O(null)):(e(Et()),n(Et()),i(1),l(null),u(0),h(!1),p(!1),x(null),g([]),y([]),O(null))},[b,se]),ae=w.useCallback(($,le=!1)=>{console.log("startNewGame called:",$,"aiGoesFirst:",le),$==="ai"&&(V.current=le),E($),e(Et()),n(Et()),i($==="ai"&&le?2:1),l(null),u(0),h(!1),p(!1),x(null),g([]),y([]),O(null),Z(null),ue(null),J.playButtonClick()},[]),tt=w.useCallback(()=>{if(m.length===0)return;const $=m[m.length-1];e($.board),n($.boardPieces),g(le=>le.slice(0,-1)),y(le=>le.slice(0,-1)),i($.player),p(!1),x(null),J.playCancel()},[m]);return{board:t,boardPieces:r,currentPlayer:s,selectedPiece:o,rotation:c,flipped:d,gameOver:f,winner:v,usedPieces:S,moveHistory:m,gameMode:b,isAIThinking:j,pendingMove:k,currentPuzzle:P,showHowToPlay:K,showSettings:R,aiDifficulty:I,puzzleDifficulty:M,isGeneratingPuzzle:N,aiAnimatingMove:L,playerAnimatingMove:te,setGameMode:E,setShowHowToPlay:ne,setShowSettings:D,setAiDifficulty:W,setPuzzleDifficulty:fe,setPendingMove:O,handleCellClick:pt,selectPiece:we,rotatePiece:_e,flipPiece:Ye,movePendingPiece:at,confirmMove:et,cancelMove:lt,resetGame:ge,startNewGame:ae,undoMove:tt,loadPuzzle:X,resetCurrentPuzzle:ye}},Cr={CACHED_USER_ID:"deadblock_cached_user_id",CACHED_PROFILE:"deadblock_cached_profile",CACHED_TIMESTAMP:"deadblock_cached_timestamp"},Hb=7*24*60*60*1e3,Rl=t=>{try{return localStorage.getItem(t)}catch(e){return console.warn("[AuthContext] localStorage read error:",e),null}},$l=(t,e)=>{try{localStorage.setItem(t,e)}catch(r){console.warn("[AuthContext] localStorage write error:",r)}},zl=t=>{try{localStorage.removeItem(t)}catch(e){console.warn("[AuthContext] localStorage remove error:",e)}},yo=()=>{try{const t=Rl(Cr.CACHED_USER_ID),e=Rl(Cr.CACHED_PROFILE),r=Rl(Cr.CACHED_TIMESTAMP);if(!t||!e)return null;const n=JSON.parse(e),s=parseInt(r,10)||0,i=Date.now()-s;return console.log("[AuthContext] Loaded cached profile:",{username:n?.username,userId:t,ageMinutes:Math.round(i/6e4)}),{userId:t,profile:n,isExpired:i>Hb}}catch(t){return console.warn("[AuthContext] Error loading cached profile:",t),null}},of=(t,e)=>{try{if(!t||!e)return;$l(Cr.CACHED_USER_ID,t),$l(Cr.CACHED_PROFILE,JSON.stringify(e)),$l(Cr.CACHED_TIMESTAMP,Date.now().toString()),console.log("[AuthContext] Saved profile to cache:",{username:e.username})}catch(r){console.warn("[AuthContext] Error saving profile to cache:",r)}},Fs=()=>{zl(Cr.CACHED_USER_ID),zl(Cr.CACHED_PROFILE),zl(Cr.CACHED_TIMESTAMP),console.log("[AuthContext] Cleared cached profile")},sg=w.createContext({user:null,profile:null,loading:!0,sessionReady:!1,isAuthenticated:!1,isOnlineEnabled:!1,isOAuthCallback:!1,isNewUser:!1,signUp:async()=>{},signIn:async()=>{},signInWithGoogle:async()=>{},signOut:async()=>{},updateProfile:async()=>{},clearOAuthCallback:()=>{},clearNewUser:()=>{},refreshProfile:async()=>{}}),Vb=({children:t})=>{const e=yo(),[r,n]=w.useState(null),[s,i]=w.useState(e?.profile||null),[o,l]=w.useState(!e?.profile),[c,u]=w.useState(!1),[d,h]=w.useState(!1),[f,p]=w.useState(!1),v=w.useRef(!1),x=Qe(),S=w.useCallback(async R=>{const D="https://oyeibyrednwlolmsjlwk.supabase.co",I="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY",W="sb-oyeibyrednwlolmsjlwk-auth-token";try{const N=JSON.parse(localStorage.getItem(W)||"null");if(!N?.access_token||!I)return console.log("[AuthContext] fetchProfileDirect: No auth token available"),null;const A={Authorization:`Bearer ${N.access_token}`,apikey:I,"Content-Type":"application/json",Accept:"application/json"};console.log("[AuthContext] fetchProfileDirect: Fetching via direct API...");const L=Date.now(),B=await fetch(`${D}/rest/v1/profiles?id=eq.${R}&select=*`,{headers:A}),te=Date.now()-L;if(console.log(`[AuthContext] fetchProfileDirect: Response in ${te}ms, status: ${B.status}`),!B.ok){const M=await B.text();return console.error("[AuthContext] fetchProfileDirect: Error response:",M),null}const H=await B.json(),C=Array.isArray(H)?H[0]:H;return C?(console.log("[AuthContext] fetchProfileDirect: Success:",{username:C?.username,id:C?.id}),C):(console.log("[AuthContext] fetchProfileDirect: No profile found (empty result)"),null)}catch(N){return console.error("[AuthContext] fetchProfileDirect: Exception:",N.message),null}},[]),g=w.useCallback(async(R,D=0)=>{if(!oe)return console.log("[AuthContext] fetchProfile: supabase not configured"),null;if(!R)return console.log("[AuthContext] fetchProfile: no userId provided"),null;const I=3;console.log(`[AuthContext] fetchProfile: fetching for ${R}, attempt ${D+1}`);try{const W=await S(R);return!W||!W.id?(console.log("[AuthContext] fetchProfile: No profile data returned"),D<I?(console.log(`[AuthContext] fetchProfile: Retry ${D+1}/${I}...`),await new Promise(N=>setTimeout(N,500*(D+1))),g(R,D+1)):null):(console.log("[AuthContext] fetchProfile success:",{username:W?.username,id:W?.id}),i(W),of(R,W),W)}catch(W){return console.error("[AuthContext] fetchProfile exception:",W),D<I?(await new Promise(N=>setTimeout(N,500*(D+1))),g(R,D+1)):null}},[S]);w.useEffect(()=>{if(!oe){l(!1);return}const R=window.location.href,D=window.location.hash,I=window.location.search,W=D.includes("access_token=")||I.includes("access_token="),N=I.includes("code="),A=W||N;R.includes("/auth/callback")&&!A&&(console.log("Cleaning up empty OAuth callback URL"),window.history.replaceState({},document.title,"/")),A&&(console.log("OAuth callback detected with auth data, processing..."),h(!0));const L=async()=>{if(A){console.log("=== OAuth Callback Processing Started ===");try{const H=new Promise((V,z)=>setTimeout(()=>z(new Error("OAuth timeout")),15e3));console.log("OAuth: Getting session from Supabase...");const C=oe.auth.getSession(),{data:M,error:U}=await Promise.race([C,H.then(()=>({data:null,error:{message:"Timeout"}}))]);if(console.log("OAuth: Session response:",{hasData:!!M,hasSession:!!M?.session,hasUser:!!M?.session?.user,error:U?.message}),U)console.error("OAuth: Error getting session:",U),h(!1);else if(M?.session){console.log("OAuth: Session established successfully",{userId:M.session.user?.id,email:M.session.user?.email}),n(M.session.user);try{console.log("OAuth: Fetching profile...");const V=await g(M.session.user.id);if(console.log("OAuth: Profile result:",{hasProfile:!!V}),V?.created_at){const z=new Date(V.created_at),fe=(new Date-z)/1e3;fe<60&&(console.log("OAuth: New user detected (profile created",fe,"seconds ago)"),p(!0))}}catch(V){console.error("OAuth: Profile fetch failed:",V)}console.log("OAuth: Callback processed successfully, waiting for App.jsx to handle redirect")}else console.log("OAuth: No session in response"),h(!1);console.log("OAuth: Cleaning up URL"),window.history.replaceState({},document.title,"/")}catch(H){if(console.error("OAuth: Callback error:",H),H.message==="OAuth timeout"){console.log("OAuth: Timeout occurred, attempting session recovery...");try{const{data:C}=await oe.auth.getSession();if(C?.session?.user){console.log("OAuth: Session recovery successful!",C.session.user.id),n(C.session.user),g(C.session.user.id).catch(M=>{console.error("OAuth: Recovery profile fetch failed:",M)}),window.history.replaceState({},document.title,"/"),console.log("=== OAuth Callback Processing Finished (recovered) ===");return}}catch(C){console.error("OAuth: Session recovery failed:",C)}}h(!1),window.history.replaceState({},document.title,"/")}console.log("=== OAuth Callback Processing Finished ===")}};(async()=>{console.log("=== Auth Init Started ===");const H=yo();H?.profile&&!v.current&&(console.log("Auth init: Using cached profile for instant display:",H.profile.username),i(H.profile),l(!1));let C=!1;const M=A?2e4:H?.profile?4e3:1e4;console.log("Auth init: Setting timeout for",M,"ms (OAuth:",A,", hasCached:",!!H?.profile,")");const U=setTimeout(async()=>{if(!C){console.log("Auth init: TIMEOUT - completing with current state");try{const ue=(await oe.auth.getSession())?.data?.session?.user;if(ue)console.log("Auth init: Timeout but found real session - setting user:",ue.id),n(ue),s||g(ue.id).catch(fe=>{console.error("Auth init: Timeout profile fetch error:",fe)});else if(H?.profile&&H?.userId){console.log("Auth init: Timeout with valid cache and NO real session - trusting cached auth state"),n({id:H.userId,email:H.profile.email||"cached@user"});const fe=H.userId;setTimeout(async()=>{const we=yo();if(!we?.userId||we.userId!==fe){console.log("Auth init: Background refresh skipped - user state changed");return}console.log("Auth init: Background refresh triggered after timeout");try{const _e=await g(fe);_e?console.log("Auth init: Background refresh successful:",_e.username):console.log("Auth init: Background refresh returned no data")}catch(_e){console.error("Auth init: Background refresh error:",_e)}},500)}else console.log("Auth init: Timeout with no session and no cache")}catch(z){console.error("Auth init: Timeout session check failed:",z),H?.profile&&H?.userId&&(console.log("Auth init: Using cache after session check failure"),n({id:H.userId,email:H.profile.email||"cached@user"}))}u(!0),l(!1)}},M),V=()=>{C=!0,clearTimeout(U)};try{console.log("Auth init: Handling OAuth callback (if any)..."),await L(),console.log("Auth init: OAuth callback handling complete"),console.log("Auth init: Getting current session...");const{data:{session:z},error:ue}=await oe.auth.getSession();if(ue){console.error("Auth init: Error getting session:",ue),V(),u(!0),l(!1);return}if(console.log("Auth init: Session result",{hasSession:!!z,userId:z?.user?.id,email:z?.user?.email}),n(z?.user??null),u(!0),console.log("Auth init: User state set, isAuthenticated will be:",!!z?.user,", sessionReady: true"),H?.profile&&z?.user&&H.userId!==z.user.id&&(console.log("Auth init: Cached profile is for different user, clearing"),Fs(),i(null)),!z?.user){H?.profile&&(console.log("Auth init: No session but have cached profile, clearing"),Fs(),i(null)),V(),u(!0),l(!1);return}console.log("Auth init: Fetching fresh profile for",z.user.id),v.current=!0;const fe=await g(z.user.id);if(console.log("Auth init: Profile fetch result",{hasProfile:!!fe,username:fe?.username}),!fe&&!H?.profile){console.log("Auth init: Profile not found and no cache, starting retry...");for(let we=0;we<3;we++){await new Promise(Ye=>setTimeout(Ye,500*(we+1)));const _e=await g(z.user.id);if(console.log(`Auth init: Retry ${we+1} result:`,{hasProfile:!!_e}),_e)break}}V(),console.log("Auth init: Setting loading to false"),l(!1),console.log("=== Auth Init Complete ===")}catch(z){console.error("Auth init: Error:",z),V(),l(!1)}})();const{data:{subscription:te}}=oe.auth.onAuthStateChange(async(H,C)=>{if(console.log("[AuthContext] Auth event:",H,C?.user?.email),n(C?.user??null),C?.user&&(console.log("[AuthContext] Setting sessionReady=true from",H),u(!0)),H==="SIGNED_IN"&&C?.user)console.log("[AuthContext] SIGNED_IN - fetching profile"),await g(C.user.id),(window.location.pathname.includes("/auth/callback")||window.location.hash||window.location.search)&&window.history.replaceState({},document.title,"/");else if(H==="TOKEN_REFRESHED"&&C?.user){console.log("[AuthContext] TOKEN_REFRESHED - fetching profile for",C.user.id);const M=await g(C.user.id);if(console.log("[AuthContext] TOKEN_REFRESHED - profile fetch result:",{hasProfile:!!M,username:M?.username}),!M){console.log("[AuthContext] TOKEN_REFRESHED - profile not found, retrying...");for(let U=0;U<3;U++){await new Promise(z=>setTimeout(z,1e3*(U+1)));const V=await g(C.user.id);if(console.log(`[AuthContext] TOKEN_REFRESHED - retry ${U+1}:`,{hasProfile:!!V}),V)break}}}else if(H==="INITIAL_SESSION"&&C?.user){console.log("[AuthContext] INITIAL_SESSION - fetching profile for",C.user.id);const M=await g(C.user.id);if(console.log("[AuthContext] INITIAL_SESSION - profile fetch result:",{hasProfile:!!M,username:M?.username}),!M){console.log("[AuthContext] INITIAL_SESSION - profile not found, retrying...");for(let U=0;U<3;U++){await new Promise(z=>setTimeout(z,1e3*(U+1)));const V=await g(C.user.id);if(console.log(`[AuthContext] INITIAL_SESSION - retry ${U+1}:`,{hasProfile:!!V}),V)break}}}else H==="INITIAL_SESSION"&&!C?(console.log("[AuthContext] INITIAL_SESSION - no session, user not logged in"),u(!0),yo()?.profile&&(console.log("[AuthContext] Clearing stale cached profile"),Fs(),i(null))):H==="SIGNED_OUT"&&(n(null),i(null),h(!1),u(!0),Fs(),localStorage.removeItem("deadblock_entry_auth_passed"),console.log("[AuthContext] SIGNED_OUT - cleared user, profile, and cache"))});return()=>te.unsubscribe()},[g]);const m=async(R,D,I)=>{if(!oe)return{error:{message:"Online features not configured"}};if(!I||I.length<3||I.length>20)return{error:{message:"Username must be 3-20 characters"}};if(!/^[a-zA-Z0-9_]+$/.test(I))return{error:{message:"Username can only contain letters, numbers, and underscores"}};try{const L={apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY","Content-Type":"application/json"},B=`https://oyeibyrednwlolmsjlwk.supabase.co/rest/v1/profiles?select=id&email=eq.${encodeURIComponent(R)}&limit=1`,te=await fetch(B,{headers:L});if(te.ok){const H=await te.json();if(H&&H.length>0)return{error:{message:"An account with this email already exists. Please sign in instead."}}}}catch(A){console.log("Email check failed, proceeding:",A)}try{const A=JSON.parse(localStorage.getItem("sb-oyeibyrednwlolmsjlwk-auth-token")||"null"),B={apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY","Content-Type":"application/json",Prefer:"return=minimal"};A?.access_token&&(B.Authorization=`Bearer ${A.access_token}`);const te=`https://oyeibyrednwlolmsjlwk.supabase.co/rest/v1/profiles?select=id&username=eq.${encodeURIComponent(I)}&limit=1`,H=await fetch(te,{headers:B});if(H.ok){const C=await H.json();if(C&&C.length>0)return{error:{message:"Username already taken"}}}}catch(A){console.log("Username check failed, proceeding with signup:",A)}console.log("[AuthContext] Attempting signup for:",R,I);const{data:W,error:N}=await oe.auth.signUp({email:R,password:D,options:{data:{username:I,display_name:I},emailRedirectTo:void 0}});if(N)return console.error("[AuthContext] Signup error:",N),N.message?.includes("500")||N.status===500?{error:{message:"Account creation failed. The username may already exist or there was a server error. Please try a different username."}}:{error:N};if(W?.user){await new Promise(H=>setTimeout(H,500));const{data:A,error:L}=await oe.from("profiles").select("*").eq("id",W.user.id).maybeSingle();L&&console.log("[AuthContext] Profile check error (expected if new):",L.message);let B=A;if(A)await oe.from("profiles").update({email:R}).eq("id",W.user.id);else{console.log("[AuthContext] Profile not created by trigger, creating manually for:",W.user.id);const{data:H,error:C}=await oe.from("profiles").insert({id:W.user.id,username:I,display_name:I,email:R}).select().single();if(C){console.error("[AuthContext] Failed to create profile manually:",C);const{data:M,error:U}=await oe.from("profiles").upsert({id:W.user.id,username:I,display_name:I,email:R}).select().single();U?console.error("[AuthContext] Upsert also failed:",U):B=M}else B=H}if(B)console.log("[AuthContext] Setting profile after signup:",B.username),i(B);else{console.log("[AuthContext] Fetching profile after creation..."),await new Promise(C=>setTimeout(C,300));const{data:H}=await oe.from("profiles").select("*").eq("id",W.user.id).single();H?(console.log("[AuthContext] Got profile on retry:",H.username),i(H)):console.error("[AuthContext] Could not get profile after signup!")}const te=!W.session;return p(!0),{data:W,error:null,needsEmailConfirmation:te,isNewUser:!0}}if(N){let A=N.message;return N.message.includes("database error")?A="Account created but profile setup failed. Please try signing in.":N.message.includes("already registered")?A="An account with this email already exists":N.message.includes("invalid email")?A="Please enter a valid email address":N.message.includes("weak password")&&(A="Password is too weak. Use at least 6 characters"),{data:W,error:{...N,message:A}}}return{data:W,error:N}},y=async(R,D)=>{if(!oe)return{error:{message:"Online features not configured"}};const{data:I,error:W}=await oe.auth.signInWithPassword({email:R,password:D});return{data:I,error:W}},b=async()=>{if(!oe)return{error:{message:"Online features not configured"}};console.log("[AuthContext] Starting Google OAuth with redirect to:",`${window.location.origin}/auth/callback`);try{const{data:R,error:D}=await oe.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,skipBrowserRedirect:!1}});return console.log("[AuthContext] Google OAuth result:",{data:R,error:D}),D?(console.error("[AuthContext] Google OAuth error:",D),{data:R,error:D}):(R?.url&&(console.log("[AuthContext] OAuth URL received, redirecting to:",R.url),window.location.href=R.url),{data:R,error:D})}catch(R){return console.error("[AuthContext] Google OAuth exception:",R),{data:null,error:{message:R.message||"Failed to start Google Sign In"}}}},E=async()=>{if(oe){console.log("[AuthContext] signOut: Starting sign out process"),n(null),i(null),u(!1),Fs(),localStorage.removeItem("deadblock_entry_auth_passed"),localStorage.removeItem("deadblock_pending_invite_code");try{const{error:R}=await oe.auth.signOut();R?console.error("[AuthContext] signOut: Supabase error:",R):console.log("[AuthContext] signOut: Supabase sign out successful")}catch(R){console.error("[AuthContext] signOut: Exception:",R)}return console.log("[AuthContext] signOut: Complete - cleared user, profile, and cache"),{error:null}}},j=async R=>{if(!oe)return{error:{message:"Online features not configured"}};const{data:D,error:I}=await oe.auth.resetPasswordForEmail(R,{redirectTo:`${window.location.origin}/auth/callback?type=recovery`});return{data:D,error:I}},_=async R=>{if(!oe)return{error:{message:"Online features not configured"}};const{data:D,error:I}=await oe.auth.signInWithOtp({email:R,options:{emailRedirectTo:`${window.location.origin}/auth/callback?type=magiclink`}});return{data:D,error:I}},k=async R=>{if(!oe||!r)return{error:{message:"Not authenticated"}};const{data:D,error:I}=await oe.auth.updateUser({email:R});return{data:D,error:I}},O=async R=>{if(!oe||!r)return{error:{message:"Not authenticated"}};const{data:D,error:I}=await oe.auth.updateUser({password:R});return{data:D,error:I}},P=async R=>{if(!oe||!r)return{error:{message:"Not authenticated"}};const{data:D,error:I}=await oe.from("profiles").update(R).eq("id",r.id).select().single();return!I&&D&&(i(D),of(r.id,D)),{data:D,error:I}},Z=async R=>{if(!oe)return{available:!1,error:{message:"Not configured"}};if(s?.username?.toLowerCase()===R.toLowerCase())return{available:!0,error:null};const{data:D,error:I}=await oe.from("profiles").select("id").ilike("username",R).single();return I?.code==="PGRST116"?{available:!0,error:null}:I?{available:!1,error:I}:{available:!1,error:null}},K=()=>{h(!1)},ne=()=>{p(!1)};return a.jsx(sg.Provider,{value:{user:r,profile:s,loading:o,sessionReady:c,isAuthenticated:!!r,isOnlineEnabled:x,isOAuthCallback:d,isNewUser:f,signUp:m,signIn:y,signInWithGoogle:b,signInWithMagicLink:_,signOut:E,resetPassword:j,updateEmail:k,updatePassword:O,updateProfile:P,checkUsernameAvailable:Z,refreshProfile:async()=>r?await g(r.id):null,clearOAuthCallback:K,clearNewUser:ne},children:t})},Fi=()=>{const t=w.useContext(sg);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Gb="sb-oyeibyrednwlolmsjlwk-auth-token",qb="https://oyeibyrednwlolmsjlwk.supabase.co",Kb=()=>{const t=JSON.parse(localStorage.getItem(Gb)||"null"),e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY";return!t?.access_token||!e?null:{Authorization:`Bearer ${t.access_token}`,apikey:e,"Content-Type":"application/json"}},Ll=async(t,e={})=>{const r=Kb();if(!r)return{data:null};let n=`${qb}/rest/v1/${t}?`;const s=[];e.select&&s.push(`select=${encodeURIComponent(e.select)}`),e.eq&&Object.entries(e.eq).forEach(([i,o])=>s.push(`${i}=eq.${o}`)),e.order&&s.push(`order=${e.order}`),e.limit&&s.push(`limit=${e.limit}`),e.single&&(r.Accept="application/vnd.pgrst.object+json"),n+=s.join("&");try{const i=await fetch(n,{headers:r});return i.ok?{data:await i.json()}:{data:null}}catch(i){return console.error("[RealtimeManager] Direct fetch error:",i),{data:null}}};class Yb{constructor(){this.userChannel=null,this.userId=null,this.gameChannel=null,this.currentGameId=null,this.handlers={gameInvite:new Set,friendRequest:new Set,matchFound:new Set,emailInviteUpdated:new Set,rematchRequest:new Set,gameUpdate:new Set,chatMessage:new Set},this.isConnected=!1,this.connectionAttempts=0,this.maxRetries=3,this.idleTimeout=null,this.idleTimeoutMs=5*60*1e3,this.pollingIntervals={},this.usePollingFallback=!1,this.lastGameState=null}async connectUser(e){if(!Qe()||!e)return!1;if(this.userChannel&&this.userId===e)return this.resetIdleTimeout(),!0;await this.disconnectUser(),this.userId=e;try{return this.userChannel=oe.channel(`user-notifications:${e}`,{config:{presence:{key:e}}}).on("postgres_changes",{event:"INSERT",schema:"public",table:"game_invites",filter:`to_user_id=eq.${e}`},n=>{this.notifyHandlers("gameInvite",n.new)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"friends",filter:`friend_id=eq.${e}`},n=>{this.notifyHandlers("friendRequest",n.new)}).on("postgres_changes",{event:"*",schema:"public",table:"games",filter:`player2_id=eq.${e}`},n=>{(n.eventType==="INSERT"||n.eventType==="UPDATE"&&n.new?.status==="active"&&n.old?.status==="pending")&&this.notifyHandlers("matchFound",n.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"email_invites",filter:`from_user_id=eq.${e}`},n=>{(n.new?.status==="accepted"||n.new?.status==="declined")&&this.notifyHandlers("emailInviteUpdated",n.new)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"rematch_requests",filter:`to_user_id=eq.${e}`},n=>{this.notifyHandlers("rematchRequest",n.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"rematch_requests",filter:`from_user_id=eq.${e}`},n=>{this.notifyHandlers("rematchRequest",n.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"rematch_requests",filter:`to_user_id=eq.${e}`},n=>{this.notifyHandlers("rematchRequest",n.new)}),await new Promise(n=>{this.userChannel.subscribe(s=>{s==="SUBSCRIBED"?(this.isConnected=!0,this.connectionAttempts=0,n("connected")):(s==="CHANNEL_ERROR"||s==="TIMED_OUT")&&n("error")}),setTimeout(()=>n("timeout"),1e4)})!=="connected"?(console.warn("[RealtimeManager] Failed to connect, using polling fallback"),this.enablePollingFallback(),!1):(this.resetIdleTimeout(),!0)}catch(r){return console.error("[RealtimeManager] Connection error:",r),this.enablePollingFallback(),!1}}async disconnectUser(){this.userChannel&&(await this.userChannel.unsubscribe(),this.userChannel=null),this.userId=null,this.isConnected=!1,this.clearIdleTimeout(),this.disablePollingFallback()}async connectGame(e){if(!Qe()||!e)return!1;if(this.gameChannel&&this.currentGameId===e)return!0;await this.disconnectGame(),this.currentGameId=e,this.lastGameState=null;try{return this.gameChannel=oe.channel(`game:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"games",filter:`id=eq.${e}`},n=>{this.notifyHandlers("gameUpdate",n.new)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"game_chat",filter:`game_id=eq.${e}`},n=>{this.notifyHandlers("chatMessage",n.new)}),await new Promise(n=>{this.gameChannel.subscribe(s=>{s==="SUBSCRIBED"?n("connected"):(s==="CHANNEL_ERROR"||s==="TIMED_OUT")&&n("error")}),setTimeout(()=>n("timeout"),1e4)})!=="connected"?(console.warn("[RealtimeManager] Game channel failed, using polling"),this.startGamePolling(e),!1):!0}catch(r){return console.error("[RealtimeManager] Game connection error:",r),this.startGamePolling(e),!1}}async disconnectGame(){this.gameChannel&&(await this.gameChannel.unsubscribe(),this.gameChannel=null),this.currentGameId=null,this.lastGameState=null,this.stopGamePolling()}on(e,r){return this.handlers[e]&&this.handlers[e].add(r),()=>this.off(e,r)}off(e,r){this.handlers[e]&&this.handlers[e].delete(r)}notifyHandlers(e,r){this.handlers[e]&&this.handlers[e].forEach(n=>{try{n(r)}catch(s){console.error(`[RealtimeManager] Handler error for ${e}:`,s)}}),this.resetIdleTimeout()}resetIdleTimeout(){this.clearIdleTimeout(),this.idleTimeout=setTimeout(()=>{this.disconnectUser()},this.idleTimeoutMs)}clearIdleTimeout(){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null)}enablePollingFallback(){this.usePollingFallback||(this.usePollingFallback=!0,this.pollingIntervals.invites=setInterval(async()=>{if(!this.userId)return;const{data:e}=await Ll("game_invites",{select:"*",eq:{to_user_id:this.userId,status:"pending"},order:"created_at.desc",limit:5});e?.length>0&&e.filter(n=>{const s=new Date(n.created_at);return Date.now()-s.getTime()<15e3}).forEach(n=>this.notifyHandlers("gameInvite",n))},1e4),this.pollingIntervals.friends=setInterval(async()=>{if(!this.userId)return;const{data:e}=await Ll("friends",{select:"*",eq:{friend_id:this.userId,status:"pending"},order:"created_at.desc",limit:5});e?.length>0&&e.filter(n=>{const s=new Date(n.created_at);return Date.now()-s.getTime()<35e3}).forEach(n=>this.notifyHandlers("friendRequest",n))},3e4))}disablePollingFallback(){this.usePollingFallback=!1,Object.values(this.pollingIntervals).forEach(e=>{e&&clearInterval(e)}),this.pollingIntervals={}}startGamePolling(e){this.pollingIntervals.game=setInterval(async()=>{if(this.currentGameId!==e){this.stopGamePolling();return}const{data:r}=await Ll("games",{select:"*",eq:{id:e},single:!0});if(r){const n=`${r.current_player}-${r.status}-${JSON.stringify(r.board)}`;n!==this.lastGameState&&(this.lastGameState=n,this.notifyHandlers("gameUpdate",r))}},2e3)}stopGamePolling(){this.pollingIntervals.game&&(clearInterval(this.pollingIntervals.game),this.pollingIntervals.game=null),this.lastGameState=null}getStatus(){return{isConnected:this.isConnected,userId:this.userId,currentGameId:this.currentGameId,usePollingFallback:this.usePollingFallback,channelCount:(this.userChannel?1:0)+(this.gameChannel?1:0)}}}const Ws=new Yb;function Jb(){const{user:t,isAuthenticated:e,sessionReady:r}=Fi(),n=w.useRef(!1);return w.useEffect(()=>{const s=async()=>{if(e&&t?.id&&r){if(n.current)return;n.current=!0,console.log("[useRealtimeConnection] Connecting realtime for user:",t.id);const o=await Ws.connectUser(t.id);console.log("[useRealtimeConnection] Connection result:",o?"connected":"polling fallback")}},i=async()=>{!e&&n.current&&(console.log("[useRealtimeConnection] Disconnecting realtime (user logged out)"),await Ws.disconnectUser(),n.current=!1)};return r&&(e&&t?.id?s():i()),()=>{}},[e,t?.id,r]),w.useEffect(()=>{const s=()=>{if(document.visibilityState==="visible"&&e&&t?.id){const i=Ws.getStatus();!i.isConnected&&!i.usePollingFallback&&(console.log("[useRealtimeConnection] Tab visible, reconnecting..."),Ws.connectUser(t.id))}};return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[e,t?.id]),Ws.getStatus()}var Xb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Qb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Zb=(t,e)=>{const r=w.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>w.createElement("svg",{ref:u,...Xb,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${Qb(t)}`,...c},[...e.map(([d,h])=>w.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${t}`,r};var Y=Zb;const vo=Y("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),md=Y("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),af=Y("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),lf=Y("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),xo=Y("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Mo=Y("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ig=Y("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),e1=Y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Tn=Y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),og=Y("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ag=Y("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),t1=Y("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),r1=Y("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),n1=Y("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),su=Y("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),iu=Y("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),lg=Y("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),s1=Y("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),i1=Y("FlipHorizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]),cg=Y("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]),cf=Y("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),o1=Y("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),a1=Y("Hexagon",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]]),Qs=Y("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),uf=Y("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),ou=Y("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),l1=Y("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Ai=Y("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Ti=Y("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),au=Y("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),c1=Y("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),bn=Y("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),u1=Y("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),d1=Y("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),h1=Y("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),ug=Y("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),f1=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),p1=Y("Puzzle",[["path",{d:"M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98 0 0 1-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501 0 1 0-3.214 3.214c.446.166.855.497.925.968a.979.979 0 0 1-.276.837l-1.61 1.61a2.404 2.404 0 0 1-1.705.707 2.402 2.402 0 0 1-1.704-.706l-1.568-1.568a1.026 1.026 0 0 0-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5 0 1 1-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026 0 0 0-.289-.877l-1.568-1.568A2.402 2.402 0 0 1 1.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5 0 1 0 3.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402 0 0 1 12 1.998c.617 0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5 0 1 1 3.237 3.237c-.464.18-.894.527-.967 1.02Z",key:"i0oyt7"}]]),Oi=Y("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ci=Y("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),m1=Y("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),g1=Y("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),y1=Y("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),dg=Y("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]),df=Y("Sliders",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]),hf=Y("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),hg=Y("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),gd=Y("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),v1=Y("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]),yd=Y("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),wr=Y("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Ml=Y("UserPlus2",[["path",{d:"M14 19a6 6 0 0 0-12 0",key:"vej9p1"}],["circle",{cx:"8",cy:"9",r:"4",key:"143rtg"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),fg=Y("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),pg=Y("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),x1=Y("Vibrate",[["path",{d:"m2 8 2 2-2 2 2 2-2 2",key:"sv1b1"}],["path",{d:"m22 8-2 2 2 2-2 2 2 2",key:"101i4y"}],["rect",{width:"8",height:"14",x:"8",y:"5",rx:"1",key:"1oyrl4"}]]),w1=Y("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),b1=Y("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Dl=Y("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ff=Y("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),_1=Y("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),vd=Y("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ur=Y("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Va=Y("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ii=({className:t="",size:e="default"})=>{const r={small:"text-xl",medium:"text-2xl sm:text-3xl",default:"text-2xl sm:text-3xl",large:"text-4xl sm:text-5xl md:text-6xl",xlarge:"text-5xl sm:text-6xl md:text-7xl"},n=r[e]||r.default;return a.jsxs("div",{className:`relative inline-block ${t}`,children:[a.jsxs("h1",{className:`neon-segments font-black tracking-wider flex ${n}`,children:[a.jsx("span",{className:"neon-seg-cyan",children:"DEA"}),a.jsx("span",{className:"neon-seg-purple",children:"DBL"}),a.jsx("span",{className:"neon-seg-pink",children:"OCK"})]}),a.jsx("style",{children:`
        .neon-segments {
          font-family: system-ui, -apple-system, sans-serif;
        }
        .neon-seg-cyan {
          color: #fff;
          text-shadow:
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #22d3ee,
            0 0 40px #22d3ee,
            0 0 60px #22d3ee;
          animation: seg-pulse-cyan 2.5s ease-in-out infinite;
        }
        .neon-seg-purple {
          color: #fff;
          text-shadow:
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #a855f7,
            0 0 40px #a855f7,
            0 0 60px #a855f7;
          animation: seg-pulse-purple 2.5s ease-in-out infinite;
          animation-delay: 0.4s;
        }
        .neon-seg-pink {
          color: #fff;
          text-shadow:
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #ec4899,
            0 0 40px #ec4899,
            0 0 60px #ec4899;
          animation: seg-pulse-pink 2.5s ease-in-out infinite;
          animation-delay: 0.8s;
        }
        @keyframes seg-pulse-cyan {
          0%, 100% {
            text-shadow:
              0 0 5px #fff,
              0 0 10px #fff,
              0 0 20px #22d3ee,
              0 0 40px #22d3ee,
              0 0 60px #22d3ee;
            filter: brightness(1);
          }
          50% {
            text-shadow:
              0 0 5px #fff,
              0 0 15px #fff,
              0 0 30px #22d3ee,
              0 0 60px #22d3ee,
              0 0 80px #22d3ee;
            filter: brightness(1.15);
          }
        }
        @keyframes seg-pulse-purple {
          0%, 100% {
            text-shadow:
              0 0 5px #fff,
              0 0 10px #fff,
              0 0 20px #a855f7,
              0 0 40px #a855f7,
              0 0 60px #a855f7;
            filter: brightness(1);
          }
          50% {
            text-shadow:
              0 0 5px #fff,
              0 0 15px #fff,
              0 0 30px #a855f7,
              0 0 60px #a855f7,
              0 0 80px #a855f7;
            filter: brightness(1.15);
          }
        }
        @keyframes seg-pulse-pink {
          0%, 100% {
            text-shadow:
              0 0 5px #fff,
              0 0 10px #fff,
              0 0 20px #ec4899,
              0 0 40px #ec4899,
              0 0 60px #ec4899;
            filter: brightness(1);
          }
          50% {
            text-shadow:
              0 0 5px #fff,
              0 0 15px #fff,
              0 0 30px #ec4899,
              0 0 60px #ec4899,
              0 0 80px #ec4899;
            filter: brightness(1.15);
          }
        }
      `})]})},wo=[{title:"Welcome to Deadblock!",icon:cg,color:"cyan",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{children:"Deadblock is a strategic puzzle game where you compete to place pentomino pieces on the board."}),a.jsx("p",{className:"text-cyan-300 font-semibold",children:"Your goal: Block your opponent from making any more moves!"})]})},{title:"Placing Pieces",icon:yd,color:"green",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{children:"Each turn, select a piece from your tray and place it on the board."}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tap"})," a piece to select it"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Drag"})," it onto the board"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tap"})," a cell to place the piece there"]})]})]})]})},{title:"Rotating & Flipping",icon:ci,color:"purple",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{children:"Adjust your piece orientation using the controls:"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-purple-400",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Rotate"})," - Turn the piece 90"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-purple-400",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Flip"})," - Mirror the piece"]})]})]}),a.jsx("p",{className:"text-sm text-slate-400",children:"Use the D-pad controls below the board to adjust before confirming."})]})},{title:"Valid Placements",icon:d1,color:"amber",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{children:"Pieces must be placed in valid positions:"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsx("span",{children:"All cells must be empty"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsx("span",{children:"Piece must fit entirely on the board"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-red-400",children:""}),a.jsx("span",{children:"Cannot overlap existing pieces"})]})]}),a.jsx("p",{className:"text-sm text-slate-400",children:"A cyan glow means valid, red means invalid."})]})},{title:"Winning the Game",icon:wr,color:"amber",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-amber-300 font-semibold",children:"You win when your opponent cannot place any of their remaining pieces!"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 space-y-2",children:[a.jsx("p",{children:"Strategy tips:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-amber-400",children:""}),a.jsx("span",{children:"Leave awkward spaces for your opponent"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-amber-400",children:""}),a.jsx("span",{children:"Save flexible pieces for later"})]})]})]})},{title:"Ready to Play!",icon:l1,color:"cyan",content:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{children:"You're all set! Here are some final tips:"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-cyan-400",children:""}),a.jsx("span",{children:"Use Quick Chat to communicate"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-cyan-400",children:""}),a.jsx("span",{children:"Watch the turn timer"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-cyan-400",children:""}),a.jsx("span",{children:"Request a rematch after the game"})]})]}),a.jsx("p",{className:"text-cyan-300 font-semibold text-center mt-4",children:"Good luck and have fun!"})]})}],S1=({isOpen:t,onClose:e})=>{const[r,n]=w.useState(0);if(!t)return null;const s=wo[r],i=s.icon,o=r===wo.length-1,l=r===0,c={cyan:{icon:"text-cyan-400",iconBg:"bg-cyan-500/20 border-cyan-500/50",glow:"shadow-[0_0_30px_rgba(34,211,238,0.3)]",button:"bg-cyan-500 hover:bg-cyan-400",dot:"bg-cyan-400"},green:{icon:"text-green-400",iconBg:"bg-green-500/20 border-green-500/50",glow:"shadow-[0_0_30px_rgba(34,197,94,0.3)]",button:"bg-green-500 hover:bg-green-400",dot:"bg-green-400"},purple:{icon:"text-purple-400",iconBg:"bg-purple-500/20 border-purple-500/50",glow:"shadow-[0_0_30px_rgba(168,85,247,0.3)]",button:"bg-purple-500 hover:bg-purple-400",dot:"bg-purple-400"},amber:{icon:"text-amber-400",iconBg:"bg-amber-500/20 border-amber-500/50",glow:"shadow-[0_0_30px_rgba(245,158,11,0.3)]",button:"bg-amber-500 hover:bg-amber-400",dot:"bg-amber-400"}},u=c[s.color]||c.cyan;return a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:`relative bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl max-w-md w-full border border-slate-600/50 ${u.glow} overflow-hidden`,children:[a.jsx("button",{onClick:e,className:"absolute top-3 right-3 p-2 text-slate-500 hover:text-white transition-colors z-10",children:a.jsx(ur,{size:20})}),a.jsx("div",{className:"p-6 pb-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-14 h-14 rounded-xl ${u.iconBg} border flex items-center justify-center`,children:a.jsx(i,{size:28,className:u.icon})}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:["Step ",r+1," of ",wo.length]}),a.jsx("h2",{className:"text-xl font-bold text-white",children:s.title})]})]})}),a.jsx("div",{className:"px-6 pb-4 text-slate-300 text-sm leading-relaxed min-h-[180px]",children:s.content}),a.jsx("div",{className:"flex justify-center gap-2 pb-4",children:wo.map((d,h)=>a.jsx("button",{onClick:()=>n(h),className:`w-2 h-2 rounded-full transition-all ${h===r?`${u.dot} w-6`:"bg-slate-600 hover:bg-slate-500"}`},h))}),a.jsxs("div",{className:"flex gap-3 p-4 pt-0",children:[!l&&a.jsxs("button",{onClick:()=>n(d=>d-1),className:"flex-1 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-all flex items-center justify-center gap-2",children:[a.jsx(e1,{size:18}),"Back"]}),o?a.jsx("button",{onClick:e,className:`flex-1 py-3 ${u.button} text-white rounded-xl font-bold transition-all shadow-lg`,children:"Let's Play!"}):a.jsxs("button",{onClick:()=>n(d=>d+1),className:`flex-1 py-3 ${u.button} text-white rounded-xl font-bold transition-all shadow-lg flex items-center justify-center gap-2`,children:["Next",a.jsx(Tn,{size:18})]})]}),!o&&a.jsx("div",{className:"text-center pb-4",children:a.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-300 text-sm transition-colors",children:"Skip tutorial"})})]})]})},k1="BEz7oIWn2ESc7ahvq894zbJNKV9dDYRIRNuAvCpuvTMh4NOAFT-U5UeU4H2Y93JK3NN_IXG03VibeeO3Z4ZXmmY";class E1{constructor(){this.swRegistration=null,this.subscription=null,this.initialized=!1,this.supported=!1,this.initPromise=null}isSupported(){const e="serviceWorker"in navigator,r="PushManager"in window,n="Notification"in window;return console.log("[PushService] Support check:",{hasServiceWorker:e,hasPushManager:r,hasNotification:n}),e&&r&&n}async init(){return this.initPromise?this.initPromise:this.initialized?this.supported:(this.initPromise=this._doInit(),this.initPromise)}async _doInit(){if(this.supported=this.isSupported(),!this.supported)return console.log("[PushService] Push notifications not supported on this browser/device"),this.initialized=!0,!1;try{console.log("[PushService] Registering service worker..."),this.swRegistration=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"}),console.log("[PushService] Service worker registered:",this.swRegistration.scope);const e=await navigator.serviceWorker.ready;console.log("[PushService] Service worker ready:",e.active?.state),e.active?.state!=="activated"&&await new Promise(r=>{e.active?e.active.addEventListener("statechange",function n(){this.state==="activated"&&(this.removeEventListener("statechange",n),r())}):e.installing||e.waiting?(e.installing||e.waiting).addEventListener("statechange",function s(){this.state==="activated"&&(this.removeEventListener("statechange",s),r())}):r(),setTimeout(r,5e3)});try{this.subscription=await this.swRegistration.pushManager.getSubscription(),console.log("[PushService] Existing subscription:",this.subscription?"found":"none")}catch(r){console.warn("[PushService] Error checking subscription:",r),this.subscription=null}return this.initialized=!0,this.supported=!0,console.log("[PushService] Initialization complete"),!0}catch(e){return console.error("[PushService] Initialization failed:",e),this.initialized=!0,this.supported=!1,!1}}getPermissionStatus(){return!this.supported||!("Notification"in window)?"unsupported":Notification.permission}isSubscribed(){return!!this.subscription}async subscribe(e){if(console.log("[PushService] Subscribe called for user:",e),!e)throw new Error("User ID required for subscription");if(this.initialized||await this.init(),!this.supported||!this.swRegistration)throw console.error("[PushService] Not supported or not initialized"),new Error("Push notifications not supported or not initialized");try{if(console.log("[PushService] Current permission:",Notification.permission),Notification.permission==="denied")return console.log("[PushService] Permission already denied"),{success:!1,reason:"permission_denied"};const r=await Notification.requestPermission();if(console.log("[PushService] Permission result:",r),r!=="granted")return console.log("[PushService] Permission not granted"),{success:!1,reason:"permission_denied"};const n=this.urlBase64ToUint8Array(k1);if(console.log("[PushService] Creating push subscription..."),this.subscription=await this.swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n}),console.log("[PushService] Push subscription created successfully"),!await this.saveSubscription(e,this.subscription))throw console.error("[PushService] Failed to save subscription to database"),new Error("Failed to save subscription to server");return console.log("[PushService] Subscription saved to database"),{success:!0,subscription:this.subscription}}catch(r){throw console.error("[PushService] Subscription failed:",r),r}}async unsubscribe(e){if(!this.subscription)return console.log("[PushService] No subscription to unsubscribe"),{success:!0};try{return await this.subscription.unsubscribe(),e&&await this.removeSubscription(e),this.subscription=null,console.log("[PushService] Unsubscribed successfully"),{success:!0}}catch(r){throw console.error("[PushService] Unsubscribe failed:",r),r}}async saveSubscription(e,r){if(!oe)return console.error("[PushService] Supabase not configured"),!1;try{const n=r.toJSON();console.log("[PushService] Saving subscription to database...");const{error:s}=await oe.from("push_subscriptions").upsert({user_id:e,endpoint:n.endpoint,p256dh:n.keys.p256dh,auth:n.keys.auth,device_info:this.getDeviceInfo(),updated_at:new Date().toISOString()},{onConflict:"endpoint"});return s?(console.error("[PushService] Error saving subscription:",s),!1):(console.log("[PushService] Subscription saved to Supabase"),!0)}catch(n){return console.error("[PushService] Error saving subscription:",n),!1}}async removeSubscription(e){if(!oe||!this.subscription)return!1;try{const r=this.subscription.endpoint,{error:n}=await oe.from("push_subscriptions").delete().eq("user_id",e).eq("endpoint",r);return n?(console.error("[PushService] Error removing subscription:",n),!1):(console.log("[PushService] Subscription removed from Supabase"),!0)}catch(r){return console.error("[PushService] Error removing subscription:",r),!1}}getDeviceInfo(){const e=navigator.userAgent;let r="Unknown",n="Unknown";return/iPhone|iPad|iPod/.test(e)?r="iOS":/Android/.test(e)?r="Android":/Windows/.test(e)?r="Windows":/Mac/.test(e)?r="Mac":/Linux/.test(e)&&(r="Linux"),/Chrome/.test(e)&&!/Chromium|Edge/.test(e)?n="Chrome":/Firefox/.test(e)?n="Firefox":/Safari/.test(e)&&!/Chrome/.test(e)?n="Safari":/Edge/.test(e)&&(n="Edge"),{device:r,browser:n,userAgent:e.substring(0,200),timestamp:new Date().toISOString()}}urlBase64ToUint8Array(e){const r="=".repeat((4-e.length%4)%4),n=(e+r).replace(/-/g,"+").replace(/_/g,"/"),s=window.atob(n),i=new Uint8Array(s.length);for(let o=0;o<s.length;++o)i[o]=s.charCodeAt(o);return i}async sendTestNotification(){if(!this.swRegistration)throw new Error("Service worker not registered");await this.swRegistration.showNotification("Test Notification",{body:"Push notifications are working!",icon:"/pwa-192x192.png",badge:"/badges/badge-default.svg",tag:"test-notification",renotify:!0})}setupMessageListener(e){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",r=>{console.log("[PushService] Message from SW:",r.data),e&&e(r.data)})}}const mn=new E1,j1=({isOpen:t,onClose:e})=>{const{profile:r,user:n,isAuthenticated:s,signOut:i,updatePassword:o,resetPassword:l,isPasswordRecovery:c,clearPasswordRecovery:u}=Fi(),[d,h]=w.useState(J.isSoundEnabled()),[f,p]=w.useState(J.isMusicEnabled()),[v,x]=w.useState(J.isVibrationEnabled()),[S,g]=w.useState(!1),[m,y]=w.useState(!1),[b,E]=w.useState(!1),[j,_]=w.useState(!1),[k,O]=w.useState(!1),[P,Z]=w.useState("default"),[K,ne]=w.useState(!1),[R,D]=w.useState(!1),[I,W]=w.useState(null),[N,A]=w.useState(!1),[L,B]=w.useState("default"),[te,H]=w.useState(!1),[C,M]=w.useState(null),[U,V]=w.useState(!1),[z,ue]=w.useState(!1),[fe,we]=w.useState(!1),[_e,Ye]=w.useState(!1),[pt,at]=w.useState(""),[et,lt]=w.useState(""),[De,Je]=w.useState(!1),[se,X]=w.useState(""),[ye,ge]=w.useState(""),[ae,tt]=w.useState(!1),[$,le]=w.useState(!1),[Ee,ve]=w.useState(!1),[Be,$e]=w.useState(!1),[F,pe]=w.useState(""),[re,je]=w.useState(()=>{try{const ce=localStorage.getItem("deadblock_notification_prefs");return ce?JSON.parse(ce):{yourTurn:!0,gameInvites:!0,friendRequests:!0,rematchRequests:!0,chatMessages:!0,gameStart:!0,weeklyChallenge:!0}}catch{return{yourTurn:!0,gameInvites:!0,friendRequests:!0,rematchRequests:!0,chatMessages:!0,gameStart:!0,weeklyChallenge:!0}}}),[Se,Wt]=w.useState(!1),It=n?.app_metadata?.provider==="google"||n?.identities?.some(ce=>ce.provider==="google");w.useEffect(()=>{(async()=>{const dn=await mn.init();O(dn),dn&&(Z(mn.getPermissionStatus()),ne(mn.isSubscribed()))})(),"Notification"in window&&(B(Notification.permission),A(Notification.permission==="granted"));const Dn=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;ue(Dn);const Ja=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;V(Ja);const Is=dn=>{dn.preventDefault(),M(dn)};window.addEventListener("beforeinstallprompt",Is);const Wi=()=>{V(!0),M(null)};return window.addEventListener("appinstalled",Wi),()=>{window.removeEventListener("beforeinstallprompt",Is),window.removeEventListener("appinstalled",Wi)}},[]),w.useEffect(()=>{t&&c&&(console.log("[SettingsModal] Password recovery session detected, opening reset form"),Ye(!0))},[t,c]);const Fe=async()=>{if(!(!k||!n?.id)){D(!0),W(null);try{if(K)await mn.unsubscribe(n.id),ne(!1),J.playClickSound?.("click");else{const ce=await mn.subscribe(n.id);ce.success?(ne(!0),Z("granted"),J.playClickSound?.("success"),setTimeout(()=>{mn.sendTestNotification()},500)):ce.reason==="permission_denied"?(Z("denied"),W("Notification permission was denied. Please enable in browser settings.")):W("Failed to enable notifications. Please try again.")}}catch(ce){console.error("[SettingsModal] Push toggle error:",ce),W("An error occurred. Please try again.")}finally{D(!1)}}},dr=async()=>{if(L!=="denied"&&L==="default"){H(!0);try{const ce=await Notification.requestPermission();B(ce),A(ce==="granted"),ce==="granted"&&new Notification("Notifications Enabled!",{body:"You will now receive notifications when it's your turn.",icon:"/pwa-192x192.png"})}catch(ce){console.error("Notification permission error:",ce)}finally{H(!1)}}},Ht=ce=>{const Dn={...re,[ce]:!re[ce]};je(Dn),localStorage.setItem("deadblock_notification_prefs",JSON.stringify(Dn)),J.playClickSound?.("click")},zr=()=>{const ce={yourTurn:!0,gameInvites:!0,friendRequests:!0,rematchRequests:!0,chatMessages:!0,gameStart:!0,weeklyChallenge:!0};je(ce),localStorage.setItem("deadblock_notification_prefs",JSON.stringify(ce)),J.playClickSound?.("success")},Lr=async()=>{if(C){C.prompt();const{outcome:ce}=await C.userChoice;ce==="accepted"&&V(!0),M(null)}else z&&we(!0)},Mr=()=>{J.toggleSound(),h(J.isSoundEnabled()),J.playClickSound?.("click")},br=()=>{J.toggleMusic(),p(J.isMusicEnabled()),J.playClickSound?.("click")},mt=()=>{J.toggleVibration(),x(J.isVibrationEnabled()),J.isVibrationEnabled()&&J.vibrate([50])},Dr=async()=>{y(!0);try{K&&n?.id&&await mn.unsubscribe(n.id),await i(),e()}catch(ce){console.error("Sign out error:",ce)}finally{y(!1),g(!1)}},Ka=async()=>{if(X(""),ge(""),pt.length<6){X("Password must be at least 6 characters");return}if(pt!==et){X("Passwords do not match");return}tt(!0);try{const{error:ce}=await o(pt);ce?X(ce.message||"Failed to update password"):(ge("Password updated successfully!"),at(""),lt(""),u&&u(),setTimeout(()=>{Ye(!1),ge("")},2e3))}catch{X("An error occurred")}finally{tt(!1)}},Ya=async()=>{pe(""),ve(!0);try{const{error:ce}=await l(n?.email);ce?pe(ce.message||"Failed to send reset email"):$e(!0)}catch{pe("An error occurred")}finally{ve(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl w-full max-w-sm max-h-[90vh] overflow-hidden border border-cyan-500/30 shadow-[0_0_50px_rgba(34,211,238,0.2)] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-cyan-500/20 flex-shrink-0",children:[a.jsx("h2",{className:"text-lg font-bold text-cyan-300",children:"Settings"}),a.jsx("button",{onClick:e,className:"p-1.5 hover:bg-slate-700 rounded-lg transition-colors",children:a.jsx(ur,{size:20,className:"text-slate-400"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wide",children:"Audio"}),a.jsxs("button",{onClick:Mr,className:`w-full flex items-center justify-between p-3 rounded-lg transition-all ${d?"bg-cyan-600/20 border border-cyan-500/30":"bg-slate-700/50 border border-slate-600/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d?a.jsx(w1,{size:20,className:"text-cyan-400"}):a.jsx(b1,{size:20,className:"text-slate-500"}),a.jsx("span",{className:d?"text-white":"text-slate-400",children:"Sound Effects"})]}),a.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${d?"bg-cyan-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${d?"translate-x-4":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:br,className:`w-full flex items-center justify-between p-3 rounded-lg transition-all ${f?"bg-cyan-600/20 border border-cyan-500/30":"bg-slate-700/50 border border-slate-600/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(h1,{size:20,className:f?"text-cyan-400":"text-slate-500"}),a.jsx("span",{className:f?"text-white":"text-slate-400",children:"Background Music"})]}),a.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${f?"bg-cyan-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${f?"translate-x-4":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:mt,className:`w-full flex items-center justify-between p-3 rounded-lg transition-all ${v?"bg-cyan-600/20 border border-cyan-500/30":"bg-slate-700/50 border border-slate-600/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(x1,{size:20,className:v?"text-cyan-400":"text-slate-500"}),a.jsx("span",{className:v?"text-white":"text-slate-400",children:"Haptic Feedback"})]}),a.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${v?"bg-cyan-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${v?"translate-x-4":"translate-x-0"}`})})]})]}),s&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wide",children:"Notifications"}),k?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:Fe,disabled:R||P==="denied",className:`w-full flex items-center justify-between p-3 rounded-lg transition-all ${K?"bg-green-600/20 border border-green-500/30":P==="denied"?"bg-red-900/20 border border-red-500/30":"bg-slate-700/50 border border-slate-600/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[R?a.jsx(Ai,{size:20,className:"text-cyan-400 animate-spin"}):K?a.jsx(lf,{size:20,className:"text-green-400"}):a.jsx(af,{size:20,className:P==="denied"?"text-red-400":"text-slate-500"}),a.jsxs("div",{className:"text-left",children:[a.jsx("span",{className:K?"text-white":P==="denied"?"text-red-300":"text-slate-400",children:"Push Notifications"}),a.jsx("p",{className:"text-xs text-slate-500",children:K?"Enabled - even when app is closed":P==="denied"?"Blocked - enable in browser settings":"Get notified when it's your turn"})]})]}),!R&&P!=="denied"&&a.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${K?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${K?"translate-x-4":"translate-x-0"}`})}),P==="denied"&&a.jsx("span",{className:"text-xs text-red-400",children:"Blocked"})]}),I&&a.jsx("p",{className:"text-xs text-red-400 px-3",children:I}),K&&a.jsxs("div",{className:"space-y-1 mt-2",children:[a.jsxs("button",{onClick:()=>Wt(!Se),className:"w-full flex items-center justify-between px-3 py-2 hover:bg-slate-700/30 rounded-lg transition-all",children:[a.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wide",children:"Notification Types"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:ce=>{ce.stopPropagation(),zr()},className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:"Enable All"}),Se?a.jsx(og,{size:14,className:"text-slate-500"}):a.jsx(ig,{size:14,className:"text-slate-500"})]})]}),Se&&a.jsxs("div",{className:"space-y-1 pl-2",children:[a.jsxs("button",{onClick:()=>Ht("yourTurn"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.yourTurn?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Your Turn"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.yourTurn?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.yourTurn?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("gameInvites"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.gameInvites?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Game Invites"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.gameInvites?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.gameInvites?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("friendRequests"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.friendRequests?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Friend Requests"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.friendRequests?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.friendRequests?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("rematchRequests"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.rematchRequests?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Rematch Requests"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.rematchRequests?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.rematchRequests?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("chatMessages"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.chatMessages?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Chat Messages"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.chatMessages?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.chatMessages?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("gameStart"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.gameStart?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Game Started"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.gameStart?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.gameStart?"translate-x-3":"translate-x-0"}`})})]}),a.jsxs("button",{onClick:()=>Ht("weeklyChallenge"),className:"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:re.weeklyChallenge?"text-slate-300 text-sm":"text-slate-500 text-sm",children:"Weekly Challenge"})]}),a.jsx("div",{className:`w-8 h-5 rounded-full p-0.5 transition-colors ${re.weeklyChallenge?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${re.weeklyChallenge?"translate-x-3":"translate-x-0"}`})})]})]})]})]}):a.jsxs("button",{onClick:dr,disabled:te||L==="denied",className:`w-full flex items-center justify-between p-3 rounded-lg transition-all ${N?"bg-green-600/20 border border-green-500/30":L==="denied"?"bg-red-900/20 border border-red-500/30":"bg-slate-700/50 border border-slate-600/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[te?a.jsx(Ai,{size:20,className:"text-cyan-400 animate-spin"}):N?a.jsx(lf,{size:20,className:"text-green-400"}):a.jsx(af,{size:20,className:L==="denied"?"text-red-400":"text-slate-500"}),a.jsxs("div",{className:"text-left",children:[a.jsx("span",{className:N?"text-white":"text-slate-400",children:"Browser Notifications"}),a.jsx("p",{className:"text-xs text-slate-500",children:N?"Enabled (when tab is open)":L==="denied"?"Blocked - enable in browser settings":"Works when browser is open"})]})]}),L!=="denied"&&a.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${N?"bg-green-500":"bg-slate-600"}`,children:a.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${N?"translate-x-4":"translate-x-0"}`})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wide",children:"App Installation"}),U?a.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-green-600/20 border border-green-500/30",children:[a.jsx(Mo,{size:20,className:"text-green-400"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-white",children:"App Installed"}),a.jsx("p",{className:"text-xs text-green-400/80",children:"Running as standalone app"})]})]}):z?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{onClick:()=>we(!fe),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 border border-slate-600/30 hover:bg-slate-700 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(hf,{size:20,className:"text-slate-400"}),a.jsx("span",{className:"text-slate-300",children:"Install App"})]}),a.jsx("span",{className:"text-xs text-slate-500",children:"iOS"})]}),fe&&a.jsxs("div",{className:"p-3 rounded-lg bg-blue-900/20 border border-blue-500/30 text-sm space-y-2",children:[a.jsx("p",{className:"text-blue-300 font-medium",children:"To install on iOS:"}),a.jsxs("ol",{className:"text-blue-200/80 space-y-1 list-decimal list-inside text-xs",children:[a.jsxs("li",{children:["Tap the Share button ",a.jsx("span",{className:"inline-block w-4 h-4 bg-blue-400/30 rounded text-center text-xs",children:""})]}),a.jsx("li",{children:'Scroll down and tap "Add to Home Screen"'}),a.jsx("li",{children:'Tap "Add" to confirm'})]})]})]}):C?a.jsx("button",{onClick:Lr,className:"w-full flex items-center justify-between p-3 rounded-lg bg-cyan-600/20 border border-cyan-500/30 hover:bg-cyan-600/30 transition-colors",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(r1,{size:20,className:"text-cyan-400"}),a.jsxs("div",{className:"text-left",children:[a.jsx("span",{className:"text-white",children:"Install App"}),a.jsx("p",{className:"text-xs text-cyan-400/80",children:"Add to home screen"})]})]})}):a.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-slate-700/50 border border-slate-600/30",children:[a.jsx(hf,{size:20,className:"text-slate-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-slate-400",children:"App Installation"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Not available in this browser"})]})]})]}),s&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wide",children:"Account"}),a.jsxs("div",{className:"p-3 rounded-lg bg-slate-700/30 border border-slate-600/30",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(bn,{size:16,className:"text-slate-500"}),a.jsx("span",{className:"text-slate-400 truncate",children:n?.email})]}),It&&a.jsxs("div",{className:"mt-1 text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(n1,{size:12}),"Signed in with Google"]})]}),(!It||c)&&!_e&&!$&&a.jsxs("button",{onClick:()=>le(!0),className:"w-full flex items-center gap-3 p-3 rounded-lg bg-slate-700/50 border border-slate-600/30 hover:bg-slate-700 transition-colors text-left",children:[a.jsx(ou,{size:20,className:"text-slate-400"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-slate-300",children:"Change Password"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Send password reset email"})]})]}),_e&&a.jsxs("div",{className:"space-y-3 p-3 rounded-lg bg-amber-900/20 border border-amber-500/30",children:[a.jsxs("h4",{className:"text-amber-300 font-bold flex items-center gap-2",children:[a.jsx(ou,{size:16}),"Set New Password"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:De?"text":"password",value:pt,onChange:ce=>at(ce.target.value),placeholder:"New password",className:"w-full pl-10 pr-10 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:border-amber-500 focus:outline-none text-sm"}),a.jsx("button",{type:"button",onClick:()=>Je(!De),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white",children:De?a.jsx(su,{size:16}):a.jsx(iu,{size:16})})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:De?"text":"password",value:et,onChange:ce=>lt(ce.target.value),placeholder:"Confirm new password",className:"w-full pl-10 pr-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:border-amber-500 focus:outline-none text-sm"})]}),se&&a.jsx("p",{className:"text-red-400 text-xs",children:se}),ye&&a.jsxs("p",{className:"text-green-400 text-xs flex items-center gap-1",children:[a.jsx(Mo,{size:14})," ",ye]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:Ka,disabled:ae,className:"flex-1 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-bold text-sm disabled:opacity-50",children:ae?"Updating...":"Update Password"}),a.jsx("button",{onClick:()=>{Ye(!1),at(""),lt(""),X("")},className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm",children:"Cancel"})]})]}),$&&!_e&&a.jsx("div",{className:"space-y-3 p-3 rounded-lg bg-slate-700/50 border border-slate-600/30",children:Be?a.jsxs("div",{className:"text-center py-2",children:[a.jsx(Mo,{size:24,className:"text-green-400 mx-auto mb-2"}),a.jsx("p",{className:"text-green-400 font-bold",children:"Reset Email Sent!"}),a.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Check your inbox for the reset link"}),a.jsx("button",{onClick:()=>{le(!1),$e(!1)},className:"mt-3 text-cyan-400 text-sm hover:text-cyan-300",children:"Done"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-sm text-slate-300",children:["Send a password reset link to ",a.jsx("span",{className:"text-cyan-400",children:n?.email}),"?"]}),F&&a.jsx("p",{className:"text-red-400 text-xs",children:F}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:Ya,disabled:Ee,className:"flex-1 py-2 bg-cyan-600 hover:bg-cyan-500 text-white rounded-lg font-bold text-sm disabled:opacity-50",children:Ee?"Sending...":"Send Reset Email"}),a.jsx("button",{onClick:()=>le(!1),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm",children:"Cancel"})]})]})}),S?a.jsxs("div",{className:"space-y-2 p-3 rounded-lg bg-red-900/20 border border-red-500/30",children:[a.jsx("p",{className:"text-red-300 text-sm",children:"Are you sure you want to sign out?"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:Dr,disabled:m,className:"flex-1 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold text-sm disabled:opacity-50",children:m?"Signing out...":"Sign Out"}),a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm",children:"Cancel"})]})]}):a.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center gap-3 p-3 rounded-lg bg-slate-700/50 border border-slate-600/30 hover:bg-red-900/30 hover:border-red-500/30 transition-colors text-left group",children:[a.jsx(c1,{size:20,className:"text-slate-400 group-hover:text-red-400"}),a.jsx("span",{className:"text-slate-300 group-hover:text-red-300",children:"Sign Out"})]})]})]})]})}):null},Ts="https://oyeibyrednwlolmsjlwk.supabase.co",mg="sb-oyeibyrednwlolmsjlwk-auth-token",Os=()=>{const t=JSON.parse(localStorage.getItem(mg)||"null"),e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95ZWlieXJlZG53bG9sbXNqbHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMzMyNzQsImV4cCI6MjA4MDgwOTI3NH0.GNMI2HOyOn_YHPPgsrkinB5FipLedqo0bTN9PKRQJMY";return!t?.access_token||!e?null:{Authorization:`Bearer ${t.access_token}`,apikey:e,"Content-Type":"application/json"}},Hs=()=>JSON.parse(localStorage.getItem(mg)||"null")?.user?.id||null,os=async(t,e={})=>{const r=Os();if(!r)return{data:null,error:{message:"Not authenticated"}};let n=`${Ts}/rest/v1/${t}`;const s=[];e.select&&s.push(`select=${encodeURIComponent(e.select)}`),e.eq&&Object.entries(e.eq).forEach(([i,o])=>s.push(`${i}=eq.${o}`)),e.neq&&Object.entries(e.neq).forEach(([i,o])=>s.push(`${i}=neq.${o}`)),e.gt&&Object.entries(e.gt).forEach(([i,o])=>s.push(`${i}=gt.${o}`)),e.gte&&Object.entries(e.gte).forEach(([i,o])=>s.push(`${i}=gte.${o}`)),e.lt&&Object.entries(e.lt).forEach(([i,o])=>s.push(`${i}=lt.${o}`)),e.lte&&Object.entries(e.lte).forEach(([i,o])=>s.push(`${i}=lte.${o}`)),e.in&&Object.entries(e.in).forEach(([i,o])=>s.push(`${i}=in.(${o.join(",")})`)),e.or&&s.push(`or=(${e.or})`),e.order&&s.push(`order=${e.order}`),e.limit&&s.push(`limit=${e.limit}`),e.single&&(r.Accept="application/vnd.pgrst.object+json"),s.length&&(n+="?"+s.join("&"));try{const i=await fetch(n,{headers:r});return i.ok?{data:await i.json(),error:null}:{data:null,error:await i.json().catch(()=>({message:i.statusText}))}}catch(i){return{data:null,error:{message:i.message}}}},nS=async(t,e,r={})=>{const n=Os();if(!n)return{data:null,error:{message:"Not authenticated"}};r.returning&&(n.Prefer="return=representation");let s=`${Ts}/rest/v1/${t}`;r.select&&(s+=`?select=${encodeURIComponent(r.select)}`);try{const i=await fetch(s,{method:"POST",headers:n,body:JSON.stringify(e)});if(!i.ok)return{data:null,error:await i.json().catch(()=>({message:i.statusText}))};const o=await i.json();return{data:r.single?o[0]:o,error:null}}catch(i){return{data:null,error:{message:i.message}}}},sS=async(t,e,r,n={})=>{const s=Os();if(!s)return{data:null,error:{message:"Not authenticated"}};n.returning&&(s.Prefer="return=representation");const i=[];r.eq&&Object.entries(r.eq).forEach(([l,c])=>i.push(`${l}=eq.${c}`)),r.or&&i.push(`or=(${r.or})`),n.select&&i.push(`select=${encodeURIComponent(n.select)}`);const o=`${Ts}/rest/v1/${t}?${i.join("&")}`;try{const l=await fetch(o,{method:"PATCH",headers:s,body:JSON.stringify(e)});if(!l.ok)return{data:null,error:await l.json().catch(()=>({message:l.statusText}))};const c=await l.json();return{data:n.single?c[0]:c,error:null}}catch(l){return{data:null,error:{message:l.message}}}},iS=async(t,e)=>{const r=Os();if(!r)return{error:{message:"Not authenticated"}};const n=[];e.eq&&Object.entries(e.eq).forEach(([i,o])=>n.push(`${i}=eq.${o}`)),e.or&&n.push(`or=(${e.or})`);const s=`${Ts}/rest/v1/${t}?${n.join("&")}`;try{const i=await fetch(s,{method:"DELETE",headers:r});return i.ok?{error:null}:{error:await i.json().catch(()=>({message:i.statusText}))}}catch(i){return{error:{message:i.message}}}},kn=async(t,e={})=>{const r=Os();if(!r)return{data:null,error:{message:"Not authenticated"}};const n=`${Ts}/rest/v1/rpc/${t}`;try{const s=await fetch(n,{method:"POST",headers:r,body:JSON.stringify(e)});return s.ok?{data:await s.json(),error:null}:{data:null,error:await s.json().catch(()=>({message:s.statusText}))}}catch(s){return{data:null,error:{message:s.message}}}},N1=async(t,e={})=>{const r=Os();if(!r)return{count:null,error:{message:"Not authenticated"}};r.Prefer="count=exact",r["Range-Unit"]="items",r.Range="0-0";const n=["select=id"];e.eq&&Object.entries(e.eq).forEach(([i,o])=>n.push(`${i}=eq.${o}`)),e.gt&&Object.entries(e.gt).forEach(([i,o])=>n.push(`${i}=gt.${o}`));const s=`${Ts}/rest/v1/${t}?${n.join("&")}`;try{const o=(await fetch(s,{headers:r})).headers.get("content-range");return{count:o?parseInt(o.split("/")[1]):0,error:null}}catch(i){return{count:null,error:{message:i.message}}}},C1={async getUserRating(t){if(!Qe())return{data:null,error:null};const{data:e,error:r}=await os("profiles",{select:"elo_rating,highest_rating,rating_games_played",eq:{id:t},single:!0});return{data:e,error:r}},async getRatingHistory(t,e=50){if(!Qe())return{data:[],error:null};const{data:r,error:n}=await os("rating_history",{select:"id,old_rating,new_rating,change,opponent_rating,result,created_at,game_id",eq:{user_id:t},order:"created_at.desc",limit:e});return{data:r||[],error:n}},async updateRatingsAfterGame(t,e){if(!Qe())return{error:null};const{error:r}=await kn("update_ratings_after_game",{p_game_id:t,p_winner_id:e});return{error:r}},async getRatingLeaderboard(t=100){if(!Qe())return{data:[],error:null};const{data:e,error:r}=await os("profiles",{select:"id,username,avatar_url,elo_rating,highest_rating,rating_games_played,wins,losses",gt:{rating_games_played:0},order:"elo_rating.desc",limit:t});return{data:e?.map((s,i)=>({...s,rank:i+1}))||[],error:r}},async getUserRank(t){if(!Qe())return{rank:null,error:null};const{data:e,error:r}=await os("profiles",{select:"elo_rating",eq:{id:t},single:!0});if(r||!e)return{rank:null,error:r};const{count:n,error:s}=await N1("profiles",{gt:{elo_rating:e.elo_rating,rating_games_played:0}});return{rank:(n||0)+1,error:s}},calculateExpectedChange(t,e,r){const s=1/(1+Math.pow(10,(e-t)/400));return Math.round(32*((r?1:0)-s))},getRatingTier(t){return t>=2200?{name:"Grandmaster",shape:"X",color:"text-amber-400",glowColor:"#f59e0b"}:t>=2e3?{name:"Master",shape:"W",color:"text-purple-400",glowColor:"#a855f7"}:t>=1800?{name:"Expert",shape:"T",color:"text-blue-400",glowColor:"#3b82f6"}:t>=1600?{name:"Advanced",shape:"Y",color:"text-cyan-400",glowColor:"#22d3ee"}:t>=1400?{name:"Intermediate",shape:"L",color:"text-green-400",glowColor:"#22c55e"}:t>=1200?{name:"Beginner",shape:"I",color:"text-sky-400",glowColor:"#38bdf8"}:{name:"Novice",shape:"O",color:"text-teal-400",glowColor:"#2dd4bf"}},getChangeColor(t){return t>0?"text-green-400":t<0?"text-red-400":"text-slate-400"},async getRatingStats(t){if(!Qe())return{data:null,error:null};const{data:e,error:r}=await this.getRatingHistory(t,100);if(r)return{data:null,error:r};if(!e?.length)return{data:{currentStreak:0,bestStreak:0,avgChange:0,recentTrend:"stable"},error:null};let n=0,s=0,i=0,o=0;for(const d of e)o+=d.change,d.result==="win"?(i++,i>s&&(s=i)):i=0;for(const d of e)if(d.result==="win")n++;else break;const c=e.slice(0,10).reduce((d,h)=>d+h.change,0);let u="stable";return c>50?u="rising":c<-50&&(u="falling"),{data:{currentStreak:n,bestStreak:s,avgChange:Math.round(o/e.length),recentTrend:u,gamesAnalyzed:e.length},error:null}},async getHeadToHead(t,e){if(!Qe())return{data:null,error:null};const{data:r,error:n}=await kn("get_head_to_head",{user1_id:t,user2_id:e});return n?{data:null,error:n}:{data:r?.[0]||{total_games:0,user1_wins:0,user2_wins:0,draws:0,last_played:null},error:null}}},P1={X:hg,W:gd,T:Va,Y:yd,L:md,I:a1,O:ag},A1=t=>{const e=C1.getRatingTier(t);return{...e,icon:P1[e.shape]||ag,hexColor:T1(e.glowColor)}},T1=t=>t||"#64748b",pf={X:[[1,0],[0,1],[1,1],[2,1],[1,2]],W:[[0,0],[0,1],[1,1],[1,2],[2,2]],T:[[0,0],[1,0],[2,0],[1,1],[1,2]],Y:[[0,1],[1,0],[1,1],[1,2],[1,3]],L:[[0,0],[0,1],[0,2],[0,3],[1,3]],I:[[0,0],[0,1],[0,2],[0,3],[0,4]],O:[[0,0]]},Ga=w.memo(({shape:t,glowColor:e,size:r="default"})=>{const n=pf[t]||pf.O,s=Math.min(...n.map(([x])=>x)),i=Math.max(...n.map(([x])=>x)),o=Math.min(...n.map(([,x])=>x)),l=Math.max(...n.map(([,x])=>x)),c=i-s+1,u=l-o+1,d={small:{cell:4,gap:1},default:{cell:6,gap:1},medium:{cell:5,gap:1},large:{cell:8,gap:1}},{cell:h,gap:f}=d[r]||d.default,p=c*(h+f),v=u*(h+f);return a.jsx("div",{className:"relative inline-flex items-center justify-center",style:{width:p+4,height:v+4,filter:`drop-shadow(0 0 4px ${e}) drop-shadow(0 0 8px ${e}50)`},children:a.jsx("div",{className:"relative",style:{width:p,height:v},children:n.map(([x,S],g)=>a.jsx("div",{className:"absolute rounded-sm",style:{width:h,height:h,left:(x-s)*(h+f),top:(S-o)*(h+f),backgroundColor:e,boxShadow:"inset 0 1px 2px rgba(255,255,255,0.4), inset 0 -1px 2px rgba(0,0,0,0.3)",border:"1px solid rgba(255,255,255,0.3)"}},g))})})});Ga.displayName="TierIcon";const O1=w.memo(({shape:t,glowColor:e,size:r="default"})=>a.jsxs("div",{className:"relative animate-tier-pulse",children:[a.jsx(Ga,{shape:t,glowColor:e,size:r}),a.jsx("style",{children:`
        @keyframes tier-pulse {
          0%, 100% { 
            filter: drop-shadow(0 0 4px ${e}) drop-shadow(0 0 8px ${e}50);
            transform: scale(1);
          }
          50% { 
            filter: drop-shadow(0 0 8px ${e}) drop-shadow(0 0 16px ${e}80);
            transform: scale(1.05);
          }
        }
        .animate-tier-pulse {
          animation: tier-pulse 2s ease-in-out infinite;
        }
      `})]}));O1.displayName="AnimatedTierIcon";const me={WEEKLY_TOP_3:"weekly_top_3",WEEKLY_FIRST:"weekly_first",SPEED_STREAK_5:"speed_streak_5",SPEED_STREAK_10:"speed_streak_10",SPEED_STREAK_25:"speed_streak_25",SPEED_STREAK_50:"speed_streak_50",PUZZLE_FIRST:"puzzle_first",PUZZLE_EASY_10:"puzzle_easy_10",PUZZLE_MEDIUM_10:"puzzle_medium_10",PUZZLE_HARD_10:"puzzle_hard_10",PUZZLE_TOTAL_100:"puzzle_total_100",ONLINE_FIRST_WIN:"online_first_win",ONLINE_WINS_10:"online_wins_10",ONLINE_WINS_50:"online_wins_50",AI_FIRST_WIN:"ai_first_win",AI_HARD_WIN:"ai_hard_win",AI_HARD_WINS_10:"ai_hard_wins_10",GAMES_PLAYED_100:"games_played_100"};class I1{constructor(){this.cache=null,this.cacheTimestamp=null,this.CACHE_DURATION=6e4}async getUserAchievements(e=!1){if(!Qe())return{data:[],error:"Supabase not configured"};const r=Hs();if(!r)return{data:[],error:"Not authenticated"};if(!e&&this.cache&&this.cacheTimestamp&&Date.now()-this.cacheTimestamp<this.CACHE_DURATION)return{data:this.cache,error:null};try{const{data:n,error:s}=await kn("get_user_achievements",{p_user_id:r});return!s&&n&&(this.cache=n,this.cacheTimestamp=Date.now()),{data:n||[],error:s}}catch(n){return console.error("Error getting achievements:",n),{data:[],error:n.message}}}async getAllAchievements(){if(!Qe())return{data:[],error:"Supabase not configured"};try{const{data:e,error:r}=await os("achievement_definitions",{select:"*",order:"category.asc,points.asc"});return{data:e||[],error:r}}catch(e){return console.error("Error getting achievement definitions:",e),{data:[],error:e.message}}}async hasAchievement(e){const{data:r}=await this.getUserAchievements();return r.some(n=>n.achievement_id===e)}async awardAchievement(e,r={}){if(!Qe())return{success:!1,error:"Supabase not configured"};const n=Hs();if(!n)return{success:!1,error:"Not authenticated"};try{const{data:s,error:i}=await kn("award_achievement",{p_user_id:n,p_achievement_id:e,p_metadata:r});return s?.success&&(this.cache=null,this.cacheTimestamp=null),{success:s?.success||!1,error:s?.error||i}}catch(s){return console.error("Error awarding achievement:",s),{success:!1,error:s.message}}}async checkAchievements(e,r=null){if(!Qe())return console.log("[achievementService] checkAchievements: Supabase not configured"),{data:[],error:null};const n=e||Hs();if(!n)return console.log("[achievementService] checkAchievements: No user ID"),{data:[],error:"Not authenticated"};console.log("[achievementService] checkAchievements: Checking for user",n,"game",r);try{const{data:s,error:i}=await kn("check_achievements",{p_user_id:n,p_game_id:r});return console.log("[achievementService] checkAchievements result:",{data:s,error:i}),s?.length>0&&(this.cache=null,this.cacheTimestamp=null),{data:s||[],error:i}}catch(s){return console.error("[achievementService] checkAchievements error:",s),{data:[],error:s.message}}}async getAchievementStats(e){if(!Qe())return{data:null,error:"Supabase not configured"};const r=e||Hs();if(!r)return{data:null,error:"Not authenticated"};try{const{data:n,error:s}=await kn("get_achievement_stats",{p_user_id:r});if(!s&&n)return{data:n,error:null};console.log("[achievementService] getAchievementStats: RPC failed, calculating manually");const{data:i}=await os("achievement_definitions",{select:"id,points"}),{data:o}=await kn("get_user_achievements",{p_user_id:r}),l=i?.length||0,c=i?.reduce((h,f)=>h+(f.points||0),0)||0,u=o?.length||0,d=o?.reduce((h,f)=>h+(f.points||0),0)||0;return{data:{totalAchievements:l,unlockedCount:u,totalPoints:c,earnedPoints:d,completionPercentage:l>0?Math.round(u/l*100):0},error:null}}catch(n){return console.error("[achievementService] getAchievementStats error:",n),{data:null,error:n.message}}}async getAchievementsWithStatus(e){if(!Qe())return{data:[],error:null};if(!(e||Hs()))return{data:[],error:"Not authenticated"};try{const{data:n,error:s}=await this.getAllAchievements();if(s)return{data:[],error:s};const{data:i,error:o}=await this.getUserAchievements(!0);if(o)return{data:[],error:o};const l=new Map;return i?.forEach(u=>{const d=u.achievement_id||u.achievement?.id;d&&l.set(d,u.unlocked_at||u.earned_at)}),{data:n.map(u=>({...u,unlocked:l.has(u.id),unlockedAt:l.get(u.id)||null})),error:null}}catch(n){return console.error("[achievementService] getAchievementsWithStatus error:",n),{data:[],error:n.message}}}async checkAndAwardAchievements(e){if(!Qe())return[];const r=[];e.speed_best_streak>=5&&(await this.awardAchievement(me.SPEED_STREAK_5)).success&&r.push(me.SPEED_STREAK_5),e.speed_best_streak>=10&&(await this.awardAchievement(me.SPEED_STREAK_10)).success&&r.push(me.SPEED_STREAK_10),e.speed_best_streak>=25&&(await this.awardAchievement(me.SPEED_STREAK_25)).success&&r.push(me.SPEED_STREAK_25),e.speed_best_streak>=50&&(await this.awardAchievement(me.SPEED_STREAK_50)).success&&r.push(me.SPEED_STREAK_50);const n=(e.puzzles_easy_solved||0)+(e.puzzles_medium_solved||0)+(e.puzzles_hard_solved||0);return n>=1&&(await this.awardAchievement(me.PUZZLE_FIRST)).success&&r.push(me.PUZZLE_FIRST),e.puzzles_easy_solved>=10&&(await this.awardAchievement(me.PUZZLE_EASY_10)).success&&r.push(me.PUZZLE_EASY_10),e.puzzles_medium_solved>=10&&(await this.awardAchievement(me.PUZZLE_MEDIUM_10)).success&&r.push(me.PUZZLE_MEDIUM_10),e.puzzles_hard_solved>=10&&(await this.awardAchievement(me.PUZZLE_HARD_10)).success&&r.push(me.PUZZLE_HARD_10),n>=100&&(await this.awardAchievement(me.PUZZLE_TOTAL_100)).success&&r.push(me.PUZZLE_TOTAL_100),(e.ai_easy_wins||0)+(e.ai_medium_wins||0)+(e.ai_hard_wins||0)>=1&&(await this.awardAchievement(me.AI_FIRST_WIN)).success&&r.push(me.AI_FIRST_WIN),e.ai_hard_wins>=1&&(await this.awardAchievement(me.AI_HARD_WIN)).success&&r.push(me.AI_HARD_WIN),e.ai_hard_wins>=10&&(await this.awardAchievement(me.AI_HARD_WINS_10)).success&&r.push(me.AI_HARD_WINS_10),e.games_won>=1&&(await this.awardAchievement(me.ONLINE_FIRST_WIN)).success&&r.push(me.ONLINE_FIRST_WIN),e.games_won>=10&&(await this.awardAchievement(me.ONLINE_WINS_10)).success&&r.push(me.ONLINE_WINS_10),e.games_won>=50&&(await this.awardAchievement(me.ONLINE_WINS_50)).success&&r.push(me.ONLINE_WINS_50),(e.games_played||0)+(e.local_games_played||0)+n+(e.ai_easy_wins||0)+(e.ai_easy_losses||0)+(e.ai_medium_wins||0)+(e.ai_medium_losses||0)+(e.ai_hard_wins||0)+(e.ai_hard_losses||0)>=100&&(await this.awardAchievement(me.GAMES_PLAYED_100)).success&&r.push(me.GAMES_PLAYED_100),r}async checkWeeklyAchievements(e,r){const n=[];return(await this.awardAchievement(me.WEEKLY_FIRST,{challenge_id:r})).success&&n.push(me.WEEKLY_FIRST),e<=3&&(await this.awardAchievement(me.WEEKLY_TOP_3,{challenge_id:r,rank:e})).success&&n.push(me.WEEKLY_TOP_3),n}getAchievementProgress(e){return{speed:{current:e.speed_best_streak||0,milestones:[5,10,25,50],next:this.getNextMilestone(e.speed_best_streak||0,[5,10,25,50])},puzzles:{total:(e.puzzles_easy_solved||0)+(e.puzzles_medium_solved||0)+(e.puzzles_hard_solved||0),milestones:[1,10,50,100]},online:{wins:e.games_won||0,milestones:[1,10,50]},ai:{hardWins:e.ai_hard_wins||0,milestones:[1,10]}}}getNextMilestone(e,r){for(const n of r)if(e<n)return n;return null}clearCache(){this.cache=null,this.cacheTimestamp=null}}const as=new I1,ba={legendary:{bg:"bg-amber-500/20",border:"border-amber-500/50",text:"text-amber-400",glow:"rgba(251,191,36,0.3)"},epic:{bg:"bg-purple-500/20",border:"border-purple-500/50",text:"text-purple-400",glow:"rgba(168,85,247,0.3)"},rare:{bg:"bg-blue-500/20",border:"border-blue-500/50",text:"text-blue-400",glow:"rgba(59,130,246,0.3)"},uncommon:{bg:"bg-green-500/20",border:"border-green-500/50",text:"text-green-400",glow:"rgba(34,197,94,0.3)"},common:{bg:"bg-slate-500/20",border:"border-slate-500/50",text:"text-slate-400",glow:"rgba(100,116,139,0.3)"}},R1={Trophy:wr,Award:md,Star:gd,Zap:Va,Target:yd,Crown:t1,Medal:u1,Flame:s1},$1=({userId:t,playerName:e,onClose:r})=>{const[n,s]=w.useState([]),[i,o]=w.useState(null),[l,c]=w.useState(!0),[u,d]=w.useState(null),[h,f]=w.useState("all"),[p,v]=w.useState(null),x=e?`${e}'s Achievements`:"Achievements";w.useEffect(()=>{S()},[t]);const S=async()=>{c(!0),d(null);try{if(typeof as?.getAchievementsWithStatus!="function"){console.warn("[Achievements] Achievement service method not found"),s([]),o({unlockedCount:0,totalAchievements:0,earnedPoints:0,completionPercentage:0}),c(!1);return}const _=await as.getAchievementsWithStatus(t);if(_.error&&_.error!=="Not authenticated"&&console.warn("[Achievements] Error loading achievements:",_.error),s(_.data||[]),typeof as?.getAchievementStats=="function"){const k=await as.getAchievementStats(t);if(k.data)o(k.data);else{const O=(_.data||[]).filter(K=>K.unlocked).length,P=(_.data||[]).length,Z=(_.data||[]).filter(K=>K.unlocked).reduce((K,ne)=>K+(ne.points||0),0);o({unlockedCount:O,totalAchievements:P,earnedPoints:Z,completionPercentage:P>0?Math.round(O/P*100):0})}}}catch(_){console.error("Error loading achievements:",_),s([]),o({unlockedCount:0,totalAchievements:0,earnedPoints:0,completionPercentage:0})}c(!1)},g=["all","weekly","speed","puzzle","online","ai","general"],m=h==="all"?n:n.filter(_=>_.category===h),y={legendary:0,epic:1,rare:2,uncommon:3,common:4},b=[...m].sort((_,k)=>_.unlocked&&!k.unlocked?-1:!_.unlocked&&k.unlocked?1:(y[_.rarity]||4)-(y[k.rarity]||4)),E=_=>{switch(_){case"weekly":return"";case"speed":return"";case"puzzle":return"";case"online":return"";case"ai":return"";case"general":return"";default:return""}},j=_=>{J.playClickSound?.("select"),v(p===_?null:_)};return a.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-slate-900 rounded-xl max-w-lg w-full max-h-[85vh] flex flex-col border border-amber-500/30 shadow-xl",children:[a.jsxs("div",{className:"p-4 border-b border-amber-500/20 shrink-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(wr,{className:"text-amber-400",size:24}),a.jsx("h2",{className:"text-lg font-bold text-amber-300",children:x})]}),a.jsx("button",{onClick:r,className:"p-1 text-slate-400 hover:text-white transition-colors",children:a.jsx(ur,{size:24})})]}),i&&a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-amber-400",children:[i.unlockedCount,"/",i.totalAchievements]}),a.jsx("div",{className:"text-xs text-slate-400",children:"Unlocked"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-amber-400",children:i.earnedPoints}),a.jsx("div",{className:"text-xs text-slate-400",children:"Points"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-amber-400",children:[i.completionPercentage,"%"]}),a.jsx("div",{className:"text-xs text-slate-400",children:"Complete"})]})]})]}),a.jsx("div",{className:"flex gap-2 p-3 border-b border-amber-500/20 overflow-x-auto shrink-0",style:{WebkitOverflowScrolling:"touch"},children:g.map(_=>a.jsxs("button",{onClick:()=>{J.playClickSound?.("select"),f(_)},className:`
                px-3 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-all
                ${h===_?"bg-amber-500 text-slate-900":"bg-slate-800 text-slate-400 hover:text-white"}
              `,children:[E(_)," ",_.charAt(0).toUpperCase()+_.slice(1)]},_))}),a.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain min-h-0",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y",transform:"translateZ(0)",willChange:"scroll-position"},children:a.jsx("div",{className:"p-4 space-y-3",children:l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(Ai,{className:"animate-spin text-amber-400",size:32})}):b.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(wr,{className:"mx-auto text-slate-600 mb-3",size:48}),a.jsx("p",{className:"text-slate-400",children:"No achievements in this category"})]}):b.map(_=>{const k=ba[_.rarity]||ba.common,O=p===_.id,P=R1[_.icon]||md;return a.jsxs("button",{onClick:()=>j(_.id),className:`
                      w-full text-left rounded-xl border transition-all
                      ${_.unlocked?`${k.bg} ${k.border}`:"bg-slate-800/30 border-slate-700/30 opacity-60"}
                    `,style:_.unlocked?{boxShadow:`0 0 20px ${k.glow}`}:{},children:[a.jsxs("div",{className:"p-3 flex items-center gap-3",children:[a.jsx("div",{className:`
                        w-12 h-12 rounded-lg flex items-center justify-center shrink-0
                        ${_.unlocked?k.bg:"bg-slate-800/50"}
                      `,children:_.unlocked?_.icon?a.jsx("span",{className:"text-2xl",children:_.icon}):a.jsx(P,{size:24,className:k.text}):a.jsx(Ti,{size:20,className:"text-slate-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:`font-bold ${_.unlocked?"text-white":"text-slate-500"}`,children:_.name}),a.jsx("div",{className:`text-sm ${_.unlocked?"text-slate-400":"text-slate-600"}`,children:_.description})]}),a.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:`text-lg font-bold ${_.unlocked?k.text:"text-slate-600"}`,children:["+",_.points]}),a.jsx("div",{className:"text-xs text-slate-500",children:"pts"})]}),O?a.jsx(og,{size:16,className:"text-slate-400"}):a.jsx(ig,{size:16,className:"text-slate-400"})]})]}),O&&a.jsxs("div",{className:"px-3 pb-3 pt-0 border-t border-slate-700/50",children:[a.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs",children:[a.jsxs("span",{className:"text-slate-400",children:["Category: ",a.jsxs("span",{className:"text-slate-300",children:[E(_.category)," ",_.category]})]}),_.unlocked&&_.unlockedAt&&a.jsxs("span",{className:"text-green-400",children:[" Unlocked ",new Date(_.unlockedAt).toLocaleDateString()]})]}),a.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Rarity: ",a.jsx("span",{className:k.text,children:_.rarity})]})]})]},_.id)})})})]})})},oS=({achievement:t,onClose:e})=>{const r=ba[t?.rarity]||ba.common;return t?a.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-50 animate-bounce",children:a.jsxs("div",{className:`
          ${r.bg} border ${r.border} rounded-xl p-4 shadow-xl
          flex items-center gap-4 min-w-[280px]
        `,style:{boxShadow:`0 0 30px ${r.glow}`},children:[a.jsx("div",{className:"text-4xl",children:t.icon||""}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-amber-400 font-bold uppercase tracking-wide",children:"Achievement Unlocked!"}),a.jsx("div",{className:"text-white font-bold",children:t.name}),a.jsxs("div",{className:"text-sm text-slate-400",children:["+",t.points," points"]})]}),a.jsx("button",{onClick:e,className:"p-1 text-slate-400 hover:text-white",children:a.jsx(ur,{size:16})})]})}):null},z1=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-slate-900 rounded-xl max-w-sm w-full overflow-hidden border border-cyan-500/30 shadow-[0_0_50px_rgba(34,211,238,0.2)]",children:[a.jsx("div",{className:"p-4 border-b border-cyan-500/20",children:a.jsxs("div",{className:"flex items-center justify-center gap-2 relative",children:[a.jsx(wr,{size:20,className:"text-cyan-400"}),a.jsx("h2",{className:"text-lg font-bold text-cyan-300",children:"Rating System"}),a.jsx("button",{onClick:t,className:"absolute right-0 p-1 text-slate-400 hover:text-white transition-colors",children:a.jsx(ur,{size:24})})]})}),a.jsxs("div",{className:"p-4 space-y-4 max-h-[70vh] overflow-y-auto",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},children:[a.jsx("p",{className:"text-sm text-slate-400",children:"Your ELO rating changes based on match results. Beat higher-rated players to gain more points!"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-300 mb-2",children:"Rating Tiers"}),[{min:2200,name:"Grandmaster",shape:"X",color:"text-amber-400",glowColor:"#f59e0b",bg:"bg-amber-500/10 border-amber-500/30"},{min:2e3,name:"Master",shape:"W",color:"text-purple-400",glowColor:"#a855f7",bg:"bg-purple-500/10 border-purple-500/30"},{min:1800,name:"Expert",shape:"T",color:"text-blue-400",glowColor:"#3b82f6",bg:"bg-blue-500/10 border-blue-500/30"},{min:1600,name:"Advanced",shape:"Y",color:"text-cyan-400",glowColor:"#22d3ee",bg:"bg-cyan-500/10 border-cyan-500/30"},{min:1400,name:"Intermediate",shape:"L",color:"text-green-400",glowColor:"#22c55e",bg:"bg-green-500/10 border-green-500/30"},{min:1200,name:"Beginner",shape:"I",color:"text-sky-400",glowColor:"#38bdf8",bg:"bg-sky-500/10 border-sky-500/30"},{min:0,name:"Novice",shape:"O",color:"text-teal-400",glowColor:"#2dd4bf",bg:"bg-teal-500/10 border-teal-500/30"}].map(e=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border ${e.bg}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ga,{shape:e.shape,glowColor:e.glowColor,size:"default"}),a.jsx("span",{className:`font-bold ${e.color}`,children:e.name})]}),a.jsxs("span",{className:"text-xs text-slate-500",children:[e.min,"+"]})]},e.name))]}),a.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 border border-slate-700/30",children:a.jsx("p",{className:"text-xs text-slate-500",children:"New players start at 1000 ELO. Win against stronger opponents for bigger gains, lose against weaker opponents for bigger losses."})})]}),a.jsx("div",{className:"p-4 border-t border-cyan-500/20",children:a.jsx("button",{onClick:t,className:"w-full py-2.5 rounded-lg font-bold text-white bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 transition-all",children:"Got It!"})})]})}),L1=({currentUsername:t,onSave:e,onClose:r})=>{const[n,s]=w.useState(t||""),[i,o]=w.useState(""),[l,c]=w.useState(!1),u=async()=>{const d=n.trim().toLowerCase();if(d.length<3){o("Username must be at least 3 characters");return}if(d.length>16){o("Username must be 16 characters or less");return}if(!/^[a-z0-9_]+$/.test(d)){o("Only letters, numbers, and underscores allowed");return}c(!0),o(""),await e(d)?r():(o("Username may be taken. Try another."),c(!1))};return a.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-slate-900 rounded-xl max-w-sm w-full overflow-hidden border border-cyan-500/30 shadow-[0_0_50px_rgba(34,211,238,0.2)]",children:[a.jsx("div",{className:"p-4 border-b border-cyan-500/20",children:a.jsxs("div",{className:"flex items-center justify-center gap-2 relative",children:[a.jsx(ug,{size:20,className:"text-cyan-400"}),a.jsx("h2",{className:"text-lg font-bold text-cyan-300",children:"Edit Username"}),a.jsx("button",{onClick:r,className:"absolute right-0 p-1 text-slate-400 hover:text-white transition-colors",children:a.jsx(ur,{size:24})})]})}),a.jsxs("div",{className:"p-4",children:[a.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value.toLowerCase()),maxLength:16,placeholder:"Enter username",className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500/50",autoFocus:!0}),i&&a.jsx("p",{className:"text-red-400 text-sm mt-2",children:i}),a.jsx("p",{className:"text-slate-500 text-xs mt-2",children:"3-16 characters: letters, numbers, underscores"})]}),a.jsxs("div",{className:"p-4 border-t border-cyan-500/20 flex gap-3",children:[a.jsx("button",{onClick:r,className:"flex-1 py-2.5 rounded-lg font-bold text-slate-300 bg-slate-700 hover:bg-slate-600 transition-all",children:"Cancel"}),a.jsx("button",{onClick:u,disabled:l,className:"flex-1 py-2.5 rounded-lg font-bold text-white bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 transition-all disabled:opacity-50",children:l?"Saving...":"Save"})]})]})})},M1=({onClick:t,onSignIn:e,isOffline:r=!1})=>{const{user:n,profile:s,isAuthenticated:i,updateProfile:o,refreshProfile:l,loading:c}=Fi(),[u,d]=w.useState(!1),[h,f]=w.useState(!1),[p,v]=w.useState(!1),[x,S]=w.useState({unlocked:0,total:0}),[g,m]=w.useState(!1);console.log("[PlayerProfileCard] Render state:",{isOffline:r,isAuthenticated:i,hasUser:!!n,hasProfile:!!s,profileUsername:s?.username,authLoading:c,loadingTimedOut:g});const y=s?A1(s.rating||1e3):null;w.useEffect(()=>{let E;return i&&!s&&!c?E=setTimeout(()=>{console.log("[PlayerProfileCard] Loading timed out after 5s"),m(!0)},5e3):m(!1),()=>{E&&clearTimeout(E)}},[i,s,c]),w.useEffect(()=>{let E=!0;const j=async()=>{if(n?.id&&!s&&l&&!c){console.log("[PlayerProfileCard] Attempting profile refresh for user:",n.id);try{await l()}catch(k){console.error("[PlayerProfileCard] Refresh failed:",k)}}},_=setTimeout(()=>{E&&j()},500);return()=>{E=!1,clearTimeout(_)}},[n?.id,s,l,c]),w.useEffect(()=>{s?.id&&typeof as?.getAchievementStats=="function"&&as.getAchievementStats(s.id).then(E=>{E.data&&S({unlocked:E.data.unlockedCount||0,total:E.data.totalAchievements||0})}).catch(E=>{console.warn("[PlayerProfileCard] Achievement stats error:",E)})},[s?.id]);const b=async E=>{if(!s?.id)return!1;try{const{error:j}=await oe.from("profiles").update({username:E.toLowerCase(),display_name:E}).eq("id",s.id);if(j)throw j;return o&&await o({username:E.toLowerCase(),display_name:E}),!0}catch(j){return console.error("Error saving username:",j),!1}};if(s){const E=s.username||s.display_name||"Player",j=()=>y?.glowColor?{"#f59e0b":"rgba(30, 20, 60, 0.95)","#a855f7":"rgba(20, 40, 40, 0.95)","#3b82f6":"rgba(40, 25, 20, 0.95)","#22d3ee":"rgba(40, 20, 40, 0.95)","#22c55e":"rgba(40, 20, 35, 0.95)","#38bdf8":"rgba(35, 25, 45, 0.95)","#2dd4bf":"rgba(40, 25, 50, 0.95)"}[y.glowColor]||"rgba(15, 23, 42, 0.95)":"rgba(15, 23, 42, 0.9)",_=y?.glowColor||"#22d3ee",k=(ne,R)=>{const D=parseInt(ne.slice(1,3),16),I=parseInt(ne.slice(3,5),16),W=parseInt(ne.slice(5,7),16);return`rgba(${D}, ${I}, ${W}, ${R})`},O={"08":k(_,.08),10:k(_,.1),15:k(_,.15),25:k(_,.25),35:k(_,.35),40:k(_,.4),50:k(_,.5)},P=k(_,.4),Z={background:`linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, ${O[15]} 25%, rgba(30, 41, 59, 0.85) 50%, ${O[10]} 75%, rgba(15, 23, 42, 0.95) 100%)`,border:`2px solid ${P}`,borderRadius:"12px",boxShadow:`0 0 30px ${O[25]}, 0 4px 20px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1), inset 0 0 40px ${O["08"]}`,WebkitBackdropFilter:"blur(8px)",backdropFilter:"blur(8px)"},K={background:`radial-gradient(circle at 30% 30%, ${j()}, rgba(10, 15, 25, 0.98))`,border:`2px solid ${O[50]}`,boxShadow:`0 0 20px ${O[35]}, inset 0 0 15px ${O[15]}, inset 0 2px 4px rgba(255,255,255,0.1)`};return console.log("[PlayerProfileCard] Rendering: AUTHENTICATED view for",E),a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:t,"data-testid":"profile-card-authenticated",className:"w-full transition-all overflow-hidden group",style:Z,children:a.jsxs("div",{className:"flex items-center gap-3 p-3",children:[a.jsx("div",{className:"relative w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0",style:K,children:y&&a.jsx(Ga,{shape:y.shape,glowColor:y.glowColor,size:"medium"})}),a.jsxs("div",{className:"flex-1 text-left min-w-0",children:[a.jsx("div",{className:"font-black text-base tracking-wide truncate",style:{color:"#f1f5f9",textShadow:`0 0 12px ${O[40]}, 0 0 4px rgba(0,0,0,0.8)`},children:E}),a.jsxs("div",{className:"flex items-center gap-2",children:[y&&a.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",style:{color:_,textShadow:`0 0 10px ${O[50]}`},children:y.name}),a.jsxs("span",{style:{color:"#94a3b8",fontSize:"12px",fontWeight:"500"},children:[s.rating||1e3," ELO"]})]})]}),a.jsx(Tn,{size:20,className:"group-hover:translate-x-0.5 transition-all flex-shrink-0",style:{color:_,opacity:.7}})]})}),u&&a.jsx(z1,{onClose:()=>d(!1)}),h&&a.jsx(L1,{currentUsername:s.username,onSave:b,onClose:()=>f(!1)}),p&&a.jsx($1,{userId:s.id,onClose:()=>v(!1)})]})}return i&&!s&&!c&&!g?(console.log("[PlayerProfileCard] Rendering: LOADING state"),a.jsxs("button",{onClick:()=>{console.log("[PlayerProfileCard] Manual refresh triggered"),l&&l()},"data-testid":"profile-card-loading",className:"w-full flex items-center gap-3 p-3 transition-colors cursor-pointer",style:{background:"linear-gradient(135deg, rgba(51, 65, 85, 0.9) 0%, rgba(30, 41, 59, 0.95) 100%)",border:"2px solid rgba(34, 211, 238, 0.3)",borderRadius:"12px",boxShadow:"0 0 20px rgba(34, 211, 238, 0.15), inset 0 1px 0 rgba(255,255,255,0.05)"},children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-700 animate-pulse"}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("div",{className:"h-4 w-24 bg-slate-700 rounded animate-pulse mb-1.5"}),a.jsx("div",{style:{fontSize:"12px",color:"#64748b"},children:"Loading profile... tap to retry"})]})]})):(console.log("[PlayerProfileCard] Rendering: SIGN IN button"),a.jsxs("button",{onClick:e||t,"data-testid":"profile-card-signin",className:"w-full flex items-center gap-3 p-3 transition-all group",style:{background:"linear-gradient(135deg, rgba(51, 65, 85, 0.9) 0%, rgba(30, 41, 59, 0.95) 100%)",border:"2px solid rgba(34, 211, 238, 0.4)",borderRadius:"12px",boxShadow:"0 0 25px rgba(34, 211, 238, 0.15), 0 4px 15px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.08)"},children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, rgba(34, 211, 238, 0.2) 0%, rgba(15, 23, 42, 0.95) 100%)",border:"2px solid rgba(34, 211, 238, 0.5)",boxShadow:"0 0 15px rgba(34, 211, 238, 0.3), inset 0 1px 0 rgba(255,255,255,0.1)"},children:a.jsx(au,{size:20,style:{color:"#22d3ee"}})}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("div",{style:{color:"#22d3ee",fontWeight:"900",fontSize:"14px",letterSpacing:"0.05em",textShadow:"0 0 10px rgba(34, 211, 238, 0.5)"},children:"SIGN IN"}),a.jsx("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"Track stats & compete online"})]}),a.jsx(Tn,{size:20,style:{color:"#22d3ee"},className:"group-hover:translate-x-1 transition-all"})]}))},xd=(t=700)=>{const[e,r]=w.useState({needsScroll:!1,viewportHeight:typeof window<"u"?window.innerHeight:800,viewportWidth:typeof window<"u"?window.innerWidth:400,isMobile:!1,isSmallScreen:!1,safeAreaBottom:0}),n=w.useCallback(()=>{const s=window.innerHeight,i=window.innerWidth,o=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),l=s<t,c=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")||"0")||(o?20:0);r({needsScroll:l,viewportHeight:s,viewportWidth:i,isMobile:o,isSmallScreen:l,safeAreaBottom:c})},[t]);return w.useEffect(()=>{n(),window.addEventListener("resize",n),window.addEventListener("orientationchange",n);const s=setTimeout(n,100);return()=>{window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n),clearTimeout(s)}},[n]),e},mf={X:[[0,1],[1,0],[1,1],[1,2],[2,1]],V:[[0,2],[1,2],[2,0],[2,1],[2,2]],Z:[[0,0],[1,0],[1,1],[1,2],[2,2]],P:[[0,0],[0,1],[0,2],[1,0],[1,1]],W:[[0,2],[1,1],[1,2],[2,0],[2,1]]},D1=({shape:t,color:e,glowColor:r,cellSize:n=18,gap:s=2})=>{const i=mf[t]||mf.T,o=Math.min(...i.map(([p])=>p)),l=Math.max(...i.map(([p])=>p)),c=Math.min(...i.map(([,p])=>p)),u=Math.max(...i.map(([,p])=>p)),d=l-o+1,h=u-c+1,f=i.map(([p,v])=>[p-o,v-c]);return a.jsx("div",{className:"relative flex-shrink-0",style:{width:d*(n+s)-s,height:h*(n+s)-s},children:f.map(([p,v],x)=>a.jsx("div",{className:`absolute ${e} rounded-sm border border-white/20`,style:{width:n,height:n,left:p*(n+s),top:v*(n+s),boxShadow:`0 0 8px ${r}`}},x))})},Vs=({onClick:t,shape:e,color:r,glowColor:n,title:s,subtitle:i,textColor:o,hoverTextColor:l})=>{const c=()=>{J.playButtonClick(),t()};return a.jsx("button",{onClick:c,className:"w-full group",children:a.jsxs("div",{className:"flex items-center gap-3 p-2.5 rounded-xl bg-slate-800/60 border border-slate-700/50 hover:bg-slate-700/80 hover:border-slate-500/50 transition-all duration-200 group-active:scale-[0.98]",children:[a.jsx("div",{className:"flex-shrink-0 flex items-center justify-center transition-transform duration-200 group-hover:scale-110",style:{width:60,height:60},children:a.jsx(D1,{shape:e,color:r,glowColor:n})}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("div",{className:`font-bold text-sm tracking-wide transition-colors ${o} ${l}`,children:s}),a.jsx("div",{className:"text-slate-500 text-xs group-hover:text-slate-400 transition-colors",children:i})]}),a.jsx("div",{className:"text-slate-600 group-hover:text-slate-400 group-hover:translate-x-1 transition-all duration-200 flex-shrink-0",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},U1=({onStartGame:t,onPuzzleSelect:e,onWeeklyChallenge:r,showHowToPlay:n,onToggleHowToPlay:s,showSettings:i,onToggleSettings:o,isOnlineEnabled:l=!1,isAuthenticated:c=!1,isOfflineMode:u=!1,onShowProfile:d,onSignIn:h})=>{const{needsScroll:f}=xd(700),p=Qe(),v=f?{overflow:"auto",WebkitOverflowScrolling:"touch",touchAction:"pan-y pinch-zoom",overscrollBehavior:"contain"}:{overflow:"hidden"};return a.jsxs("div",{className:"fixed inset-0 bg-transparent",style:v,children:[a.jsx("div",{className:"fixed top-1/4 left-1/4 w-64 h-64 bg-pink-500/20 rounded-full blur-3xl pointer-events-none animate-orb-1"}),a.jsx("div",{className:"fixed bottom-1/4 right-1/4 w-64 h-64 bg-cyan-500/20 rounded-full blur-3xl pointer-events-none animate-orb-2"}),a.jsx("div",{className:"fixed top-1/2 right-1/3 w-48 h-48 bg-purple-500/15 rounded-full blur-3xl pointer-events-none animate-orb-3"}),a.jsx("style",{children:`
        @keyframes orb-1 {
          0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.2; }
          33% { transform: translate(30px, -20px) scale(1.1); opacity: 0.3; }
          66% { transform: translate(-20px, 30px) scale(0.9); opacity: 0.15; }
        }
        @keyframes orb-2 {
          0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.2; }
          33% { transform: translate(-25px, 25px) scale(0.95); opacity: 0.25; }
          66% { transform: translate(35px, -15px) scale(1.05); opacity: 0.18; }
        }
        @keyframes orb-3 {
          0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.15; }
          50% { transform: translate(-15px, -25px) scale(1.15); opacity: 0.22; }
        }
        .animate-orb-1 { animation: orb-1 15s ease-in-out infinite; }
        .animate-orb-2 { animation: orb-2 18s ease-in-out infinite; }
        .animate-orb-3 { animation: orb-3 12s ease-in-out infinite; }
      `}),a.jsxs("div",{className:`relative ${f?"min-h-full":"h-full"} flex flex-col items-center justify-center px-4 ${f?"py-8":"py-4"}`,children:[a.jsxs("div",{className:"w-full max-w-sm",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx(Ii,{size:"large"})}),a.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-md rounded-2xl shadow-2xl p-3 sm:p-4 border border-cyan-500/30 shadow-[0_0_40px_rgba(34,211,238,0.3)]",children:[a.jsx("div",{className:"mb-3",children:a.jsx(M1,{onClick:d,onSignIn:h,isOffline:u})}),a.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-cyan-500/30 to-transparent mb-3"}),a.jsxs("div",{className:"space-y-2 mb-3",children:[p&&a.jsx(Vs,{onClick:()=>t("online"),shape:"X",color:"bg-gradient-to-br from-amber-500 to-orange-600",glowColor:"rgba(251,191,36,0.5)",title:"ONLINE MULTIPLAYER",subtitle:u?"Sign in for ranked play":c?"Ranked matches vs humans":"Sign in to play",textColor:"text-amber-300",hoverTextColor:"group-hover:text-amber-200"}),a.jsx(Vs,{onClick:()=>t("ai"),shape:"V",color:"bg-gradient-to-br from-purple-500 to-pink-600",glowColor:"rgba(168,85,247,0.5)",title:"VS A.I.",subtitle:"Challenge the computer",textColor:"text-purple-300",hoverTextColor:"group-hover:text-purple-200"}),a.jsx(Vs,{onClick:()=>t("2player"),shape:"Z",color:"bg-gradient-to-br from-cyan-500 to-blue-600",glowColor:"rgba(34,211,238,0.5)",title:"2 PLAYER",subtitle:"Local multiplayer",textColor:"text-cyan-300",hoverTextColor:"group-hover:text-cyan-200"}),a.jsx(Vs,{onClick:e,shape:"P",color:"bg-gradient-to-br from-green-500 to-emerald-600",glowColor:"rgba(34,197,94,0.5)",title:"PUZZLE",subtitle:"Solve challenges",textColor:"text-green-300",hoverTextColor:"group-hover:text-green-200"}),p&&a.jsx(Vs,{onClick:r,shape:"W",color:"bg-gradient-to-br from-red-500 to-rose-600",glowColor:"rgba(239,68,68,0.5)",title:"WEEKLY CHALLENGE",subtitle:"Compete for best time",textColor:"text-red-300",hoverTextColor:"group-hover:text-red-200"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>{J.playButtonClick(),s(!0)},className:"flex-1 py-2.5 px-3 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-gradient-to-r from-slate-800 to-slate-700 text-cyan-300 border border-cyan-500/40 hover:border-cyan-400/60 hover:shadow-[0_0_15px_rgba(34,211,238,0.3)] hover:text-cyan-200 group",children:[a.jsx(o1,{size:16,className:"group-hover:rotate-12 transition-transform"}),a.jsx("span",{children:"HOW TO PLAY"})]}),a.jsx("button",{onClick:()=>{J.playButtonClick(),o(!0)},className:"py-2.5 px-3 rounded-lg transition-all duration-200 flex items-center justify-center bg-gradient-to-r from-slate-800 to-slate-700 text-slate-400 border border-slate-600/50 hover:border-purple-500/50 hover:text-purple-300 hover:shadow-[0_0_15px_rgba(168,85,247,0.2)] group",children:a.jsx(g1,{size:18,className:"group-hover:rotate-90 transition-transform duration-300"})})]})]})]}),f&&a.jsx("div",{className:"h-8 flex-shrink-0"})]}),a.jsx(S1,{isOpen:n,onClose:()=>s(!1)}),a.jsx(j1,{isOpen:i,onClose:()=>o(!1)})]})},Ul=({text:t="ONLINE",className:e="",size:r="default",color:n="amber",inline:s=!1})=>{const i={tiny:"text-xs",small:"text-sm",default:"text-base sm:text-lg",large:"text-lg sm:text-xl"},o={amber:{primary:"#f59e0b",secondary:"#ea580c"},lime:{primary:"#84cc16",secondary:"#22c55e"},cyan:{primary:"#22d3ee",secondary:"#3b82f6"},purple:{primary:"#a855f7",secondary:"#ec4899"},red:{primary:"#ef4444",secondary:"#f97316"},green:{primary:"#22c55e",secondary:"#10b981"}},l=i[r]||i.default,c=o[n]||o.amber,u=`neon-subtitle-${n}`,d=s?"inline-block":"block";return a.jsxs("div",{className:`relative ${d} ${e}`,children:[a.jsx("span",{className:`${u} font-black tracking-[0.3em] ${l}`,children:t}),a.jsx("style",{children:`
        .${u} {
          font-family: system-ui, -apple-system, sans-serif;
          color: #fff;
          background: transparent;
          -webkit-background-clip: text;
          background-clip: text;
          /* Ensure no filled box appears behind text */
          -webkit-box-decoration-break: clone;
          box-decoration-break: clone;
          /* Pure text-shadow for glow - works consistently across browsers */
          text-shadow:
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px ${c.primary},
            0 0 40px ${c.primary},
            0 0 60px ${c.secondary};
          animation: ${u}-pulse 3s ease-in-out infinite;
          /* Prevent iOS from adding any background decoration */
          -webkit-text-fill-color: #fff;
          paint-order: stroke fill;
        }
        @keyframes ${u}-pulse {
          0%, 100% {
            text-shadow:
              0 0 5px #fff,
              0 0 10px #fff,
              0 0 20px ${c.primary},
              0 0 40px ${c.primary},
              0 0 60px ${c.secondary};
            filter: brightness(1);
          }
          50% {
            text-shadow:
              0 0 5px #fff,
              0 0 15px #fff,
              0 0 30px ${c.primary},
              0 0 50px ${c.primary},
              0 0 70px ${c.secondary};
            filter: brightness(1.1);
          }
        }
        /* iOS Safari specific fix */
        @supports (-webkit-touch-callout: none) {
          .${u} {
            /* Reset any potential iOS-specific rendering issues */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* Ensure transparent background on iOS */
            background-color: transparent !important;
            -webkit-text-stroke: 0;
          }
        }
      `})]})},gg=w.forwardRef(({board:t,boardPieces:e,pendingMove:r,rotation:n=0,flipped:s=!1,gameOver:i=!1,gameMode:o,currentPlayer:l=1,onCellClick:c,aiAnimatingMove:u,playerAnimatingMove:d,selectedPiece:h,customColors:f,onPendingPieceDragStart:p,isDragging:v=!1,dragPreviewCell:x=null,draggedPiece:S=null,dragRotation:g=0,dragFlipped:m=!1,lastMoveCells:y=null},b)=>{const E=Array.isArray(t)?t.map(C=>Array.isArray(C)?C:Array(de).fill(null)):Array(de).fill(null).map(()=>Array(de).fill(null)),j=e||{},[_,k]=w.useState({});w.useEffect(()=>{const C={};for(let M=0;M<de;M++)for(let U=0;U<de;U++)E[M]?.[U]&&(C[`${M},${U}`]={delay:Math.random()*30,duration:8+Math.random()*6});k(C)},[E]);const O=(C,M)=>Array.isArray(j)&&j[C]?j[C][M]:typeof j=="object"?j[`${C},${M}`]:null,P=i||(o==="ai"||o==="puzzle")&&l===2;let Z=[],K=[],ne=[],R=!1,D=null;if(r){const C=Lt(r.piece,n,s);D=li[r.piece]||"bg-gradient-to-br from-cyan-400 to-blue-500",C.forEach(([M,U])=>{const V=r.row+U,z=r.col+M;if(V>=0&&V<de&&z>=0&&z<de){const ue=E[V]?.[z];ue!==null&&ue!==0&&ue!==void 0?ne.push({row:V,col:z}):Z.push({row:V,col:z})}else K.push({row:V,col:z})}),R=K.length===0&&ne.length===0&&lr(E,r.row,r.col,C)}let I=[];const W=u?.isWinning||!1;u&&Lt(u.piece,u.rotation||0,u.flipped||!1).forEach(([M,U])=>{const V=u.row+U,z=u.col+M;V>=0&&V<de&&z>=0&&z<de&&I.push({row:V,col:z})});let N=[];const A=d?.isWinning||!1;d&&Lt(d.piece,d.rotation||0,d.flipped||!1).forEach(([M,U])=>{const V=d.row+U,z=d.col+M;V>=0&&V<de&&z>=0&&z<de&&N.push({row:V,col:z})});let L=[],B=null;if(v&&x&&S){const C=Lt(S,g,m);B=li[S]||"bg-gradient-to-br from-cyan-400 to-blue-500";let M=0,U=C.length;C.forEach(([V,z])=>{const ue=x.row+z,fe=x.col+V;if(ue>=0&&ue<de&&fe>=0&&fe<de){const we=E[ue]?.[fe],_e=we===null||we===0||we===void 0;_e&&M++,L.push({row:ue,col:fe,isValid:_e})}}),M===U&&lr(E,x.row,x.col,C)}const te=C=>{if(f){if(C===1)return f.player1||"bg-gradient-to-br from-cyan-400 to-blue-500";if(C===2)return f.player2||"bg-gradient-to-br from-orange-400 to-red-500"}return C===1?"bg-gradient-to-br from-cyan-400 via-cyan-500 to-blue-600":C===2?o==="2player"?"bg-gradient-to-br from-pink-400 via-pink-500 to-rose-600":"bg-gradient-to-br from-orange-400 via-orange-500 to-red-600":""},H=(C,M)=>{P||c&&c(C,M)};return a.jsxs("div",{className:"relative",ref:b,children:[a.jsx("div",{className:"grid grid-cols-8 gap-0.5 sm:gap-1 p-1.5 sm:p-2 rounded-lg bg-slate-800/60 backdrop-blur-sm border border-slate-700/50",style:{boxShadow:"0 0 30px rgba(0,0,0,0.3), inset 0 0 20px rgba(0,0,0,0.2)"},children:E.map((C,M)=>C.map((U,V)=>{const z=Z.some(ae=>ae.row===M&&ae.col===V),ue=ne.some(ae=>ae.row===M&&ae.col===V),fe=I.some(ae=>ae.row===M&&ae.col===V),we=N.some(ae=>ae.row===M&&ae.col===V),_e=U!==null&&U!==0&&U!==void 0,Ye=O(M,V),pt=y?.some(ae=>ae.row===M&&ae.col===V)||!1,at=L.find(ae=>ae.row===M&&ae.col===V),et=!!at,lt=at?.isValid!==!1,De=Ye?li[Ye]:null,Je=_e?De||te(U):"",se=_[`${M},${V}`],X=z?Z.findIndex(ae=>ae.row===M&&ae.col===V):-1,ye=ae=>{if(!z||!p||!r)return;ae.stopPropagation();const tt=ae.touches?.[0];if(!tt)return;const $=ae.currentTarget?.getBoundingClientRect()||null;p(r.piece,tt.clientX,tt.clientY,$)},ge=ae=>{if(!z||!p||!r||ae.button!==0)return;ae.stopPropagation();const tt=ae.currentTarget?.getBoundingClientRect()||null;p(r.piece,ae.clientX,ae.clientY,tt)};return a.jsxs("div",{onClick:()=>H(M,V),onTouchStart:z?ye:void 0,onMouseDown:z?ge:void 0,className:`
                  game-cell w-9 h-9 sm:w-12 sm:h-12 rounded-md relative overflow-hidden
                  transition-all duration-300 cursor-pointer
                  ${_e?Je:"bg-slate-700/40 hover:bg-slate-600/50"}
                  ${_e?"shadow-lg":""}
                  ${ue?"overlap-cell":""}
                  ${fe?W?"ai-winning-cell":"ai-placing-cell":""}
                  ${we?A?"player-winning-cell":"player-placing-cell":""}
                  ${z?"pending cursor-grab active:cursor-grabbing":""}
                  ${pt&&!z&&!fe&&!we?"last-move-cell":""}
                `,style:z?{animationDelay:`${X*.15}s`,touchAction:"none",userSelect:"none"}:void 0,children:[_e&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/15 via-transparent to-black/15 pointer-events-none"}),_e&&se&&a.jsx("div",{className:`absolute inset-0 pointer-events-none rounded-md ${U===1?"breathing-glow-cyan":o==="2player"?"breathing-glow-pink":"breathing-glow-orange"}`,style:{animationDelay:`-${se.delay}s`,animationDuration:`${se.duration}s`}}),z&&a.jsxs("div",{className:"absolute inset-0 pointer-events-none transition-opacity duration-75",style:{opacity:v?0:1},children:[a.jsx("div",{className:`absolute inset-0 ${D} rounded-md`}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/15 via-transparent to-black/15 rounded-md"}),a.jsx("div",{className:`absolute inset-0 pending-glow ${R?"valid":"invalid"} rounded-md`}),a.jsx("div",{className:"absolute inset-0 pending-shine rounded-md overflow-hidden"})]}),z&&a.jsx("div",{className:"absolute inset-0 rounded-md pointer-events-none transition-opacity duration-75",style:{opacity:v?0:1,border:R?"2px solid rgba(34, 211, 238, 0.7)":"2px solid rgba(239, 68, 68, 0.7)",boxShadow:R?"0 0 10px rgba(34, 211, 238, 0.4), inset 0 0 8px rgba(34, 211, 238, 0.2)":"0 0 10px rgba(239, 68, 68, 0.4), inset 0 0 8px rgba(239, 68, 68, 0.2)"}}),ue&&a.jsx("div",{className:"absolute inset-0 overlap-warning rounded-md"}),fe&&a.jsx("div",{className:"absolute inset-0 ai-drop-effect rounded-md"}),we&&a.jsx("div",{className:"absolute inset-0 player-drop-effect rounded-md"}),et&&!_e&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`absolute inset-0 ${B} rounded-md opacity-60`}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 via-transparent to-black/10 rounded-md"}),a.jsx("div",{className:"absolute inset-0 rounded-md pointer-events-none drag-preview-pulse",style:{border:lt?"2px solid rgba(34, 211, 238, 0.8)":"2px solid rgba(239, 68, 68, 0.8)",boxShadow:lt?"0 0 12px rgba(34, 211, 238, 0.5), inset 0 0 8px rgba(34, 211, 238, 0.3)":"0 0 12px rgba(239, 68, 68, 0.5), inset 0 0 8px rgba(239, 68, 68, 0.3)"}})]}),et&&_e&&a.jsx("div",{className:"absolute inset-0 rounded-md pointer-events-none",style:{border:"2px solid rgba(239, 68, 68, 0.9)",boxShadow:"0 0 15px rgba(239, 68, 68, 0.6), inset 0 0 10px rgba(239, 68, 68, 0.4)",background:"rgba(239, 68, 68, 0.2)"}}),pt&&!z&&!fe&&!we&&a.jsx("div",{className:"absolute inset-0 rounded-md pointer-events-none last-move-indicator",style:{border:"2px solid rgba(251, 191, 36, 0.8)",boxShadow:"0 0 12px rgba(251, 191, 36, 0.5), inset 0 0 6px rgba(251, 191, 36, 0.3)"}})]},`${M}-${V}`)}))}),K.length>0&&a.jsx("div",{className:"absolute pointer-events-none",style:{top:0,left:0,right:0,bottom:0},children:K.map((C,M)=>{const U=window.innerWidth<640?36:48,V=window.innerWidth<640?2:4,z=window.innerWidth<640?6:8,ue=z+C.col*(U+V),fe=z+C.row*(U+V);return a.jsx("div",{className:"absolute ghost-cell-warning rounded-md",style:{width:U,height:U,left:ue,top:fe}},M)})}),r&&a.jsx("div",{className:`absolute inset-0 pointer-events-none rounded-lg transition-all duration-500 ${R?"ring-2 ring-cyan-400/40 shadow-[0_0_20px_rgba(34,211,238,0.2)]":"ring-2 ring-red-500/40 shadow-[0_0_20px_rgba(239,68,68,0.3)]"}`,style:{margin:"-2px"}}),a.jsx("style",{children:`
        /* ============================================
           PENDING PIECE - SUBTLE GLOW & SHINE
           Slower, more elegant animations
           ============================================ */
        
        .pending-glow {
          animation: pending-glow-pulse 3s ease-in-out infinite;
        }
        
        .pending-glow.valid {
          background: radial-gradient(circle at center, rgba(34, 211, 238, 0.15) 0%, transparent 70%);
        }
        
        .pending-glow.invalid {
          background: radial-gradient(circle at center, rgba(239, 68, 68, 0.15) 0%, transparent 70%);
        }
        
        @keyframes pending-glow-pulse {
          0%, 100% { opacity: 0.5; }
          50% { opacity: 1; }
        }
        
        .pending-shine {
          /* v7.9: Subtle edge glow sweep instead of white flash */
          background: linear-gradient(
            120deg,
            transparent 0%,
            transparent 40%,
            rgba(34, 211, 238, 0.2) 50%,
            transparent 60%,
            transparent 100%
          );
          background-size: 200% 100%;
          animation: pending-shine-roll 5s ease-in-out infinite;
        }
        
        @keyframes pending-shine-roll {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
        
        /* ============================================
           OVERLAPPING CELLS - CLEAR WARNING
           ============================================ */
        .overlap-cell {
          box-shadow: 
            0 0 15px rgba(239, 68, 68, 0.8),
            0 0 30px rgba(239, 68, 68, 0.4),
            inset 0 0 15px rgba(239, 68, 68, 0.6) !important;
          border: 3px solid rgba(255, 100, 100, 1) !important;
        }
        
        .overlap-warning {
          background: repeating-linear-gradient(
            45deg,
            rgba(239, 68, 68, 0.6),
            rgba(239, 68, 68, 0.6) 4px,
            rgba(255, 150, 150, 0.6) 4px,
            rgba(255, 150, 150, 0.6) 8px
          );
          animation: overlap-pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes overlap-pulse {
          0%, 100% { opacity: 0.7; }
          50% { opacity: 1; }
        }
        
        /* ============================================
           GHOST CELLS (OUT OF BOUNDS)
           ============================================ */
        .ghost-cell-warning {
          background: rgba(239, 68, 68, 0.25);
          border: 2px dashed rgba(239, 68, 68, 0.8);
          animation: ghost-pulse 2s ease-in-out infinite;
        }
        
        @keyframes ghost-pulse {
          0%, 100% { 
            border-color: rgba(239, 68, 68, 0.8);
            background: rgba(239, 68, 68, 0.25);
          }
          50% { 
            border-color: rgba(255, 100, 100, 1);
            background: rgba(239, 68, 68, 0.4);
          }
        }
        
        /* ============================================
           AI PLACING ANIMATION
           ============================================ */
        .ai-placing-cell {
          box-shadow: 
            0 0 20px rgba(168, 85, 247, 0.8),
            0 0 40px rgba(168, 85, 247, 0.4) !important;
          border: 2px solid rgba(168, 85, 247, 0.8) !important;
        }
        
        /* v7.8: AI WINNING MOVE ANIMATION - Golden pulsing glow */
        .ai-winning-cell {
          animation: winning-pulse 0.5s ease-in-out infinite alternate;
          border: 3px solid rgba(251, 191, 36, 1) !important;
        }
        
        .ai-drop-effect {
          /* v7.9: Edge glow animation instead of radial flash */
          animation: ai-drop-glow 0.6s ease-out;
        }
        
        @keyframes ai-drop-glow {
          0% { 
            opacity: 0;
            box-shadow: 
              0 0 20px rgba(168, 85, 247, 0.9),
              0 0 40px rgba(168, 85, 247, 0.6),
              0 0 60px rgba(168, 85, 247, 0.3);
          }
          50% {
            opacity: 1;
            box-shadow: 
              0 0 25px rgba(168, 85, 247, 0.8),
              0 0 50px rgba(168, 85, 247, 0.5),
              0 0 75px rgba(168, 85, 247, 0.25);
          }
          100% { 
            opacity: 1;
            box-shadow: 
              0 0 6px rgba(168, 85, 247, 0.3),
              0 0 12px rgba(168, 85, 247, 0.15);
          }
        }
        
        /* ============================================
           PLAYER PLACING ANIMATION
           ============================================ */
        .player-placing-cell {
          box-shadow: 
            0 0 20px rgba(34, 211, 238, 0.8),
            0 0 40px rgba(34, 211, 238, 0.4) !important;
          border: 2px solid rgba(34, 211, 238, 0.8) !important;
        }
        
        /* v7.8: PLAYER WINNING MOVE ANIMATION - Golden pulsing glow */
        .player-winning-cell {
          animation: winning-pulse 0.5s ease-in-out infinite alternate;
          border: 3px solid rgba(251, 191, 36, 1) !important;
        }
        
        /* v7.8: Winning move pulse animation - shared by both AI and player */
        @keyframes winning-pulse {
          0% { 
            box-shadow: 
              0 0 20px rgba(251, 191, 36, 0.9),
              0 0 40px rgba(251, 191, 36, 0.6),
              0 0 60px rgba(251, 191, 36, 0.3),
              inset 0 0 15px rgba(251, 191, 36, 0.4);
            transform: scale(1);
          }
          100% { 
            box-shadow: 
              0 0 30px rgba(251, 191, 36, 1),
              0 0 60px rgba(251, 191, 36, 0.8),
              0 0 90px rgba(251, 191, 36, 0.4),
              inset 0 0 25px rgba(251, 191, 36, 0.6);
            transform: scale(1.05);
          }
        }
        
        .player-drop-effect {
          /* v7.9: Edge glow animation instead of radial flash */
          animation: player-drop-glow 0.6s ease-out;
        }
        
        @keyframes player-drop-glow {
          0% { 
            opacity: 0;
            box-shadow: 
              0 0 20px rgba(34, 211, 238, 0.9),
              0 0 40px rgba(34, 211, 238, 0.6),
              0 0 60px rgba(34, 211, 238, 0.3);
          }
          50% {
            opacity: 1;
            box-shadow: 
              0 0 25px rgba(34, 211, 238, 0.8),
              0 0 50px rgba(34, 211, 238, 0.5),
              0 0 75px rgba(34, 211, 238, 0.25);
          }
          100% { 
            opacity: 1;
            box-shadow: 
              0 0 6px rgba(34, 211, 238, 0.3),
              0 0 12px rgba(34, 211, 238, 0.15);
          }
        }
        
        /* ============================================
           v7.7: DRAG PREVIEW HIGHLIGHTING
           Shows where piece will land during drag
           ============================================ */
        .drag-preview-pulse {
          animation: drag-preview-glow 0.8s ease-in-out infinite;
        }
        
        @keyframes drag-preview-glow {
          0%, 100% { 
            opacity: 0.7;
            transform: scale(1);
          }
          50% { 
            opacity: 1;
            transform: scale(1.02);
          }
        }
        
        /* ============================================
           v7.9: LAST MOVE HIGHLIGHTING
           Shows opponent's most recent move with amber glow
           ============================================ */
        .last-move-cell {
          position: relative;
          z-index: 2;
        }
        
        .last-move-indicator {
          animation: last-move-pulse 2s ease-in-out infinite;
        }
        
        @keyframes last-move-pulse {
          0%, 100% { 
            border-color: rgba(251, 191, 36, 0.6);
            box-shadow: 0 0 8px rgba(251, 191, 36, 0.4), inset 0 0 4px rgba(251, 191, 36, 0.2);
          }
          50% { 
            border-color: rgba(251, 191, 36, 1);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.7), inset 0 0 8px rgba(251, 191, 36, 0.4);
          }
        }
        
        /* ============================================
           PLACED PIECE AMBIENT EFFECTS
           v7.9: Breathing edge glow - similar to NeonTitle effect
           - Edge-only glow using box-shadow (no white flash inside)
           - Uses piece's own color (cyan/orange/pink)
           - Slow, random timing so pieces don't glow in sync
           ============================================ */
        
        /* Cyan breathing glow (Player 1) */
        .breathing-glow-cyan {
          animation: breathing-cyan ease-in-out infinite alternate;
        }
        
        @keyframes breathing-cyan {
          0% { 
            box-shadow: 
              0 0 3px rgba(34, 211, 238, 0.2),
              0 0 6px rgba(34, 211, 238, 0.1);
          }
          100% { 
            box-shadow: 
              0 0 8px rgba(34, 211, 238, 0.5),
              0 0 16px rgba(34, 211, 238, 0.3),
              0 0 24px rgba(34, 211, 238, 0.15);
          }
        }
        
        /* Orange breathing glow (AI / Player 2 in AI mode) */
        .breathing-glow-orange {
          animation: breathing-orange ease-in-out infinite alternate;
        }
        
        @keyframes breathing-orange {
          0% { 
            box-shadow: 
              0 0 3px rgba(251, 146, 60, 0.2),
              0 0 6px rgba(251, 146, 60, 0.1);
          }
          100% { 
            box-shadow: 
              0 0 8px rgba(251, 146, 60, 0.5),
              0 0 16px rgba(251, 146, 60, 0.3),
              0 0 24px rgba(251, 146, 60, 0.15);
          }
        }
        
        /* Pink breathing glow (Player 2 in 2-player mode) */
        .breathing-glow-pink {
          animation: breathing-pink ease-in-out infinite alternate;
        }
        
        @keyframes breathing-pink {
          0% { 
            box-shadow: 
              0 0 3px rgba(236, 72, 153, 0.2),
              0 0 6px rgba(236, 72, 153, 0.1);
          }
          100% { 
            box-shadow: 
              0 0 8px rgba(236, 72, 153, 0.5),
              0 0 16px rgba(236, 72, 153, 0.3),
              0 0 24px rgba(236, 72, 153, 0.15);
          }
        }
        
        /* v7.8: Allow scroll pass-through on board cells */
        /* Cells without pending pieces allow scroll */
        .game-cell {
          touch-action: manipulation;
        }
        
        /* Pending piece cells can be dragged */
        .game-cell.pending {
          touch-action: none;
          cursor: grab;
        }
        
        .game-cell.pending:active {
          cursor: grabbing;
        }
      `})]})});gg.displayName="GameBoard";const B1=({name:t,coords:e})=>{if(!e||!Array.isArray(e)||e.length===0)return null;const r=Math.min(...e.map(([c])=>c)),n=Math.max(...e.map(([c])=>c)),s=Math.min(...e.map(([,c])=>c)),i=Math.max(...e.map(([,c])=>c)),o=n-r+1,l=i-s+1;return a.jsx("div",{className:"inline-flex flex-col gap-0.5",children:Array(l).fill().map((c,u)=>a.jsx("div",{className:"flex gap-0.5",children:Array(o).fill().map((d,h)=>{const f=e.some(([p,v])=>p===h+r&&v===u+s);return a.jsx("div",{className:`w-2 h-2 sm:w-3 sm:h-3 rounded-sm relative overflow-hidden ${f?li[t]:"bg-transparent"}`,children:f&&a.jsx("div",{className:"absolute inset-0 opacity-30 bg-[repeating-linear-gradient(0deg,transparent,transparent_1px,rgba(255,255,255,0.2)_1px,rgba(255,255,255,0.2)_2px)]"})},h)})},u))})},F1=({usedPieces:t=[],selectedPiece:e,pendingMove:r,gameOver:n,gameMode:s,currentPlayer:i,isMobile:o,isGeneratingPuzzle:l,onSelectPiece:c,createDragHandlers:u,isDragging:d,draggedPiece:h})=>{const f=Array.isArray(t)?t:[];return a.jsxs("div",{className:`bg-slate-900/90 backdrop-blur-md rounded-2xl shadow-xl p-2 border border-cyan-500/30 shadow-[0_0_25px_rgba(34,211,238,0.15),inset_0_0_30px_rgba(0,0,0,0.3)] mt-2 ${l?"opacity-50":""}`,children:[a.jsx("div",{className:"grid grid-cols-6 gap-1.5",children:Qt&&Object.entries(Qt).map(([p,v])=>{const x=f.includes(p),S=e===p,g=d&&h===p,m=u?u(p):{},{style:y,...b}=m,E=100;let j=null,_={x:0,y:0},k=null,O=!1,P=!1;const Z=(D,I)=>{if(P)return;P=!0;const W={touches:[{clientX:D,clientY:I}],currentTarget:{getBoundingClientRect:()=>k},preventDefault:()=>{},stopPropagation:()=>{}};b.onTouchStart&&b.onTouchStart(W)},K=D=>{const I=D.touches[0];_={x:I.clientX,y:I.clientY},k=D.currentTarget.getBoundingClientRect(),O=!1,P=!1,j=setTimeout(()=>{!O&&!P&&Z(I.clientX,I.clientY)},E)},ne=D=>{const I=D.touches[0],W=Math.abs(I.clientX-_.x),N=Math.abs(I.clientY-_.y);(W>5||N>5)&&(O=!0,j&&(clearTimeout(j),j=null),P||Z(I.clientX,I.clientY)),P&&b.onTouchMove&&b.onTouchMove(D)},R=D=>{j&&(clearTimeout(j),j=null),!P&&!O&&!x&&!l&&c(p),P&&b.onTouchEnd&&b.onTouchEnd(D)};return a.jsxs("div",{onTouchStart:K,onTouchMove:ne,onTouchEnd:R,onMouseDown:b.onMouseDown,onClick:()=>{!x&&!l&&!d&&c(p)},className:`p-1.5 rounded-lg transition-all flex items-center justify-center relative overflow-hidden cursor-pointer ${x?"bg-slate-800/30 opacity-25 cursor-not-allowed border border-slate-700/30":g?"bg-slate-700/50 ring-2 ring-cyan-400/50 opacity-50 border border-cyan-500/30":S?"bg-slate-700/80 ring-2 ring-cyan-400 shadow-[0_0_25px_rgba(34,211,238,0.7),inset_0_0_15px_rgba(34,211,238,0.2)] border border-cyan-400/50":"bg-slate-800/60 hover:bg-slate-700/70 border border-cyan-500/20 hover:border-cyan-500/40 hover:shadow-[0_0_15px_rgba(34,211,238,0.3)]"}`,style:{touchAction:"none",WebkitUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none",...y},children:[S&&!g&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/20 to-transparent pointer-events-none"}),g&&a.jsx("div",{className:"absolute inset-0 bg-cyan-400/10 pointer-events-none animate-pulse"}),a.jsx(B1,{name:p,coords:v})]},p)})}),a.jsxs("div",{className:"text-xs font-semibold text-cyan-300/80 text-center mt-2 tracking-widest relative",children:[a.jsxs("span",{className:"relative z-10",children:["PIECES: ",f.length,"/12 USED"]}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-cyan-500/10 to-transparent"})]}),!n&&!l&&a.jsx("div",{className:"text-[10px] text-cyan-400/60 text-center mt-1 font-medium tracking-wide",children:"TAP TO SELECT  HOLD TO DRAG"})]})},pr=({onClick:t,disabled:e,children:r,color:n="cyan",className:s="",title:i=""})=>{const o={cyan:"from-cyan-500 to-blue-600 shadow-[0_0_15px_rgba(34,211,238,0.4)] hover:shadow-[0_0_25px_rgba(34,211,238,0.6)]",amber:"from-amber-500 to-orange-600 shadow-[0_0_15px_rgba(251,191,36,0.4)] hover:shadow-[0_0_25px_rgba(251,191,36,0.6)]",green:"from-green-500 to-emerald-600 shadow-[0_0_15px_rgba(34,197,94,0.4)] hover:shadow-[0_0_25px_rgba(34,197,94,0.6)]",red:"from-red-500 to-rose-600 shadow-[0_0_15px_rgba(239,68,68,0.4)] hover:shadow-[0_0_25px_rgba(239,68,68,0.6)]",purple:"from-purple-500 to-violet-600 shadow-[0_0_15px_rgba(168,85,247,0.4)] hover:shadow-[0_0_25px_rgba(168,85,247,0.6)]",indigo:"from-indigo-500 to-blue-600 shadow-[0_0_15px_rgba(99,102,241,0.4)] hover:shadow-[0_0_25px_rgba(99,102,241,0.6)]",slate:"from-slate-600 to-slate-700 shadow-[0_0_10px_rgba(100,116,139,0.3)] hover:shadow-[0_0_15px_rgba(100,116,139,0.5)]",rose:"from-rose-500 to-pink-600 shadow-[0_0_15px_rgba(244,63,94,0.4)] hover:shadow-[0_0_25px_rgba(244,63,94,0.6)]"};return a.jsx("button",{onClick:t,disabled:e,title:i,className:`
        bg-gradient-to-r ${o[n]}
        text-white font-bold rounded-xl px-3 py-2 text-xs
        transition-all duration-200
        hover:scale-105 active:scale-95
        disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:shadow-none
        flex items-center justify-center gap-1
        ${s}
      `,children:r})},W1=({selectedPiece:t,pendingMove:e,canConfirm:r,gameOver:n,gameMode:s,currentPlayer:i,isGeneratingPuzzle:o,moveCount:l=0,onRotate:c,onFlip:u,onConfirm:d,onCancel:h,onReset:f,onRetryPuzzle:p,onMenu:v,onQuitGame:x,hideResetButtons:S=!1})=>{const g=!((s==="ai"||s==="puzzle")&&i===2),m=t||e,y=s==="puzzle",b=s==="online",E=l>0,j=()=>{J.playButtonClick(),f&&f()},_=()=>{J.playButtonClick(),p&&p()},k=()=>{J.playButtonClick(),v&&v()},O=()=>{J.playButtonClick(),x&&x(E)};return a.jsxs("div",{className:"flex gap-2 justify-between mt-2 flex-wrap",children:[v&&a.jsxs(pr,{onClick:k,color:"rose",title:"Back to menu",children:[a.jsx(Qs,{size:14}),a.jsx("span",{className:"hidden sm:inline",children:"HOME"})]}),x&&b&&!n&&a.jsx(pr,{onClick:O,color:E?"red":"amber",title:E?"Forfeit game (counts as loss)":"Cancel game (no stats recorded)",children:E?a.jsxs(a.Fragment,{children:[a.jsx(lg,{size:14}),a.jsx("span",{className:"hidden sm:inline",children:"FORFEIT"})]}):a.jsxs(a.Fragment,{children:[a.jsx(vd,{size:14}),a.jsx("span",{className:"hidden sm:inline",children:"QUIT"})]})}),a.jsxs(pr,{onClick:c,disabled:!m||n||!g||o,color:"cyan",className:"flex-1",children:[a.jsx(m1,{size:14}),"ROTATE"]}),a.jsxs(pr,{onClick:u,disabled:!m||n||!g||o,color:"purple",className:"flex-1",children:[a.jsx(i1,{size:14}),"FLIP"]}),e&&r&&!o&&a.jsxs(a.Fragment,{children:[a.jsxs(pr,{onClick:h,color:"slate",className:"flex-1",children:[a.jsx(ur,{size:14}),"CANCEL"]}),a.jsxs(pr,{onClick:()=>{console.log("[ControlButtons] CONFIRM clicked! onConfirm:",typeof d),d?d():console.error("[ControlButtons] onConfirm is not defined!")},color:"green",className:"flex-1",children:[a.jsx(Mo,{size:14}),"CONFIRM"]})]}),(!e||!r)&&!o&&a.jsxs(a.Fragment,{children:[e&&a.jsxs(pr,{onClick:h,color:"slate",className:"flex-1",children:[a.jsx(ur,{size:14}),"CANCEL"]}),!e&&!S&&a.jsx(a.Fragment,{children:y?a.jsxs(a.Fragment,{children:[p&&a.jsxs(pr,{onClick:_,color:"cyan",className:"flex-1",title:"Retry this puzzle from the beginning",children:[a.jsx(ci,{size:14}),"RETRY"]}),f&&a.jsxs(pr,{onClick:j,color:"slate",className:"flex-1",title:"Generate a new puzzle",children:[a.jsx(Oi,{size:14}),"NEW"]})]}):f&&a.jsxs(pr,{onClick:j,color:"slate",className:"flex-1",title:"Reset game",children:[a.jsx(Oi,{size:14}),"RESET"]})})]}),o&&a.jsxs("div",{className:"flex-1 px-3 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-xl text-xs font-bold flex items-center justify-center gap-1 shadow-[0_0_15px_rgba(34,211,238,0.5)]",children:[a.jsx(Ai,{size:14,className:"animate-spin"}),a.jsx("span",{children:"GENERATING..."})]})]})},H1=({onMove:t})=>{const e=w.useRef(!1),r=w.useRef(0),n="w-8 h-8 sm:w-10 sm:h-10 bg-cyan-600/80 hover:bg-cyan-500 active:bg-cyan-400 text-white rounded-lg shadow-[0_0_12px_rgba(34,211,238,0.4)] flex items-center justify-center border border-cyan-400/50 active:scale-90 transition-all duration-100 touch-manipulation select-none",s=w.useCallback(c=>{const u=Date.now();return u-r.current<80?(console.log("[DPad] Debounced:",c),!1):(r.current=u,console.log("[DPad] Executing move:",c),t(c),!0)},[t]),i=w.useCallback((c,u)=>{u.preventDefault(),u.stopPropagation(),e.current=!0,s(c),setTimeout(()=>{e.current=!1},300)},[s]),o=w.useCallback((c,u)=>{if(u.preventDefault(),u.stopPropagation(),e.current){console.log("[DPad] Click ignored (touch was used)");return}s(c)},[s]),l=c=>({onTouchStart:u=>i(c,u),onClick:u=>o(c,u),onTouchEnd:u=>u.preventDefault()});return a.jsx("div",{className:"flex justify-center mt-0 mb-1",children:a.jsxs("div",{className:"relative w-24 h-24 sm:w-28 sm:h-28",children:[a.jsx("button",{type:"button",...l("up"),className:`absolute top-0 left-1/2 -translate-x-1/2 ${n}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 15l7-7 7 7"})})}),a.jsx("button",{type:"button",...l("down"),className:`absolute bottom-0 left-1/2 -translate-x-1/2 ${n}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 9l-7 7-7-7"})})}),a.jsx("button",{type:"button",...l("left"),className:`absolute left-0 top-1/2 -translate-y-1/2 ${n}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),a.jsx("button",{type:"button",...l("right"),className:`absolute right-0 top-1/2 -translate-y-1/2 ${n}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 sm:w-8 sm:h-8 bg-slate-800 rounded-full border border-cyan-500/50 shadow-[0_0_8px_rgba(34,211,238,0.3)]"})]})})},V1=({isAIThinking:t,gameOver:e,winner:r,gameMode:n,aiDifficulty:s})=>{if(e){const i=r===1,o=n==="2player";let l,c,u,d,h;return o?(r===1?(l="from-cyan-400 via-blue-400 to-cyan-400",c="rgba(34,211,238,0.6)",u="border-cyan-500/50",h="PLAYER 1 WINS"):(l="from-pink-400 via-rose-400 to-pink-400",c="rgba(236,72,153,0.6)",u="border-pink-500/50",h="PLAYER 2 WINS"),d=wr):i?(l="from-cyan-400 via-purple-400 to-pink-400",c="rgba(168,85,247,0.6)",u="border-purple-500/50",d=wr,h=n==="puzzle"?"PUZZLE COMPLETE":"VICTORY"):(l="from-red-400 via-orange-400 to-red-400",c="rgba(239,68,68,0.6)",u="border-red-500/50",d=dg,h=n==="puzzle"?"NO MOVES LEFT":"GAME OVER"),a.jsxs("div",{className:`mb-2 p-2 bg-slate-900/80 border ${u} rounded-lg text-center relative overflow-hidden`,style:{boxShadow:`0 0 20px ${c}, inset 0 0 20px ${c}20`},children:[a.jsx("div",{className:"absolute inset-0 opacity-30 animate-shimmer-bg",style:{background:`linear-gradient(90deg, transparent, ${c}, transparent)`,backgroundSize:"200% 100%"}}),a.jsxs("div",{className:"relative flex items-center justify-center gap-2",children:[a.jsx(d,{size:14,className:"animate-pulse",style:{color:c.replace("0.6","1")}}),a.jsx("span",{className:`text-xs font-bold tracking-[0.2em] bg-gradient-to-r ${l} bg-clip-text text-transparent`,style:{textShadow:`0 0 10px ${c}`},children:h}),a.jsx(d,{size:14,className:"animate-pulse",style:{color:c.replace("0.6","1")}})]}),a.jsx("style",{children:`
          @keyframes shimmer-bg {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
          }
          .animate-shimmer-bg { animation: shimmer-bg 3s ease-in-out infinite; }
        `})]})}return null},G1=({color:t="cyan"})=>{const e=t==="pink"?"#ec4899":"#22d3ee";return a.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[[0,1,2,3].map(r=>a.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-lg border-2 animate-expand-ring",style:{width:100,height:100,borderColor:e,animationDelay:`${r*.4}s`,boxShadow:`0 0 30px ${e}, inset 0 0 30px ${e}40`}},r)),a.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${e}40 0%, transparent 70%)`}}),a.jsx("div",{className:"absolute top-0 w-1 h-full animate-scan-vertical",style:{background:`linear-gradient(to bottom, transparent, ${e}, transparent)`,boxShadow:`0 0 20px ${e}`}})]})},q1=()=>{const t=Object.keys(Qt).slice(0,8);return a.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:t.map((e,r)=>{const n=r/t.length*360,s=150+Math.random()*100;return a.jsx("div",{className:"absolute left-1/2 top-1/2 w-8 h-8 animate-piece-fly",style:{"--fly-x":`${Math.cos(n*Math.PI/180)*s}px`,"--fly-y":`${Math.sin(n*Math.PI/180)*s}px`,"--rotation":`${Math.random()*720-360}deg`,animationDelay:`${r*.1}s`},children:a.jsx("div",{className:"w-full h-full bg-cyan-400 rounded shadow-[0_0_15px_#22d3ee]"})},e)})})},K1=()=>a.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[[[20,20],[80,20],[20,80],[80,80],[50,50]].map(([t,e],r)=>a.jsx("div",{className:"absolute w-4 h-4 rounded-full animate-node-glow",style:{left:`${t}%`,top:`${e}%`,transform:"translate(-50%, -50%)",background:"#22d3ee",boxShadow:"0 0 20px #22d3ee, 0 0 40px #22d3ee",animationDelay:`${r*.15}s`}},r)),[{x1:20,y1:20,x2:50,y2:50},{x1:80,y1:20,x2:50,y2:50},{x1:20,y1:80,x2:50,y2:50},{x1:80,y1:80,x2:50,y2:50}].map((t,e)=>{const r=Math.sqrt(Math.pow(t.x2-t.x1,2)+Math.pow(t.y2-t.y1,2)),n=Math.atan2(t.y2-t.y1,t.x2-t.x1)*180/Math.PI;return a.jsx("div",{className:"absolute h-0.5 origin-left animate-line-draw",style:{left:`${t.x1}%`,top:`${t.y1}%`,width:`${r}%`,transform:`rotate(${n}deg)`,background:"linear-gradient(90deg, #22d3ee, #a855f7)",boxShadow:"0 0 10px #22d3ee",animationDelay:`${e*.2}s`}},e)})]}),Y1=()=>a.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 animate-static-noise opacity-20"}),a.jsx("div",{className:"absolute inset-0 animate-scan-down opacity-40",style:{background:"repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(239,68,68,0.1) 2px, rgba(239,68,68,0.1) 4px)"}}),[1,2,3].map(t=>a.jsx("div",{className:"absolute w-full h-8 animate-glitch-slice",style:{top:`${20+t*25}%`,background:"linear-gradient(90deg, transparent, rgba(239,68,68,0.3), rgba(236,72,153,0.3), transparent)",animationDelay:`${t*.2}s`}},t))]}),J1=()=>{const t=["FATAL ERROR","SYSTEM HALT","GAME OVER","NO MOVES"];return a.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden font-mono",children:[t.map((e,r)=>a.jsx("div",{className:"absolute text-red-500 text-sm animate-fall-glitch whitespace-nowrap",style:{left:`${10+r*20}%`,animationDelay:`${r*.3}s`,textShadow:"0 0 10px #ef4444"},children:e},r)),a.jsx("div",{className:"absolute bottom-1/3 left-1/2 -translate-x-1/2 text-red-400 text-2xl animate-blink",children:"_"})]})},X1=()=>{const t=w.useMemo(()=>Array.from({length:25}).map((e,r)=>({id:r,x:r%5*20+10,y:Math.floor(r/5)*20+10,delay:Math.random()*.5,rotation:(Math.random()-.5)*90,fallX:(Math.random()-.5)*100})),[]);return a.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:t.map(e=>a.jsx("div",{className:"absolute w-12 h-12 border border-red-500/50 rounded animate-shard-fall",style:{left:`${e.x}%`,top:`${e.y}%`,transform:"translate(-50%, -50%)","--fall-x":`${e.fallX}px`,"--rotation":`${e.rotation}deg`,animationDelay:`${e.delay}s`,background:"linear-gradient(135deg, rgba(239,68,68,0.1), transparent)"}},e.id))})},Bl=(t,e=!1)=>{if(e)switch(t){case"easy":return"EASY";case"medium":return"MEDIUM";case"hard":return"HARD";default:return""}switch(t){case"beginner":return"BEGINNER A.I.";case"intermediate":return"INTERMEDIATE A.I.";case"expert":return"EXPERT A.I.";case"hard":return"HARD A.I.";default:return"A.I."}},Q1=({isWin:t,isPuzzle:e,gameMode:r,winner:n,onClose:s,onRetry:i,onNewGame:o,onMenu:l,onRematch:c,onDifficultySelect:u,opponentName:d,difficulty:h,puzzleDifficulty:f})=>{const[p,v]=w.useState(0);w.useEffect(()=>{v(Math.floor(Math.random()*3))},[]);const x=()=>{J.playButtonClick(),s(),i?.()},S=()=>{J.playButtonClick(),s(),o?.()},g=()=>{J.playButtonClick(),s(),l?.()},m=()=>{J.playButtonClick(),c?.()},y=()=>{J.playButtonClick(),s(),u?.()},b=r==="2player",E=r==="online",j=r==="ai",_=()=>e?t?"COMPLETE!":"FAILED":b?n===1?"PLAYER 1 WINS!":"PLAYER 2 WINS!":E?t?"VICTORY!":"DEFEAT":t?"YOU WIN!":"YOU LOSE",k=()=>{if(e){const I=f?Bl(f,!0):"";return t?I?`${I} puzzle solved!`:"Puzzle solved successfully":I?`${I} puzzle failed`:"No moves remaining"}if(b)return n===1?"Player 1 dominated the board":"Player 2 dominated the board";if(E){const I=d||"Opponent";return t?`You defeated ${I}`:`${I} wins this round`}if(j&&h){const I=Bl(h);return t?`You defeated the ${I}`:`The ${I} wins this round`}return t?"You defeated the A.I.":"The A.I. wins this round"},O=b||t,P=b?n===1?"cyan":"pink":t?"cyan":"red",K={cyan:{border:"border-cyan-500/50",shadow:"shadow-[0_0_50px_rgba(34,211,238,0.4)]",text:"text-cyan-400",glow:"#22d3ee",btn:"bg-cyan-600 hover:bg-cyan-500"},pink:{border:"border-pink-500/50",shadow:"shadow-[0_0_50px_rgba(236,72,153,0.4)]",text:"text-pink-400",glow:"#ec4899",btn:"bg-pink-600 hover:bg-pink-500"},red:{border:"border-red-500/50",shadow:"shadow-[0_0_50px_rgba(239,68,68,0.4)]",text:"text-red-400",glow:"#ef4444",btn:"bg-red-600 hover:bg-red-500"}}[P],D=O?[a.jsx(G1,{color:P==="pink"?"pink":"cyan"},"grid"),a.jsx(q1,{},"explode"),a.jsx(K1,{},"circuit")][p]:[a.jsx(Y1,{},"static"),a.jsx(J1,{},"crash"),a.jsx(X1,{},"shatter")][p];return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-sm animate-fade-in",onClick:s}),D,a.jsxs("div",{className:`relative bg-slate-900/95 rounded-xl p-6 sm:p-8 max-w-sm w-full border-2 ${K.border} ${K.shadow} animate-modal-pop`,children:[a.jsx("button",{onClick:s,className:"absolute top-3 right-3 text-slate-500 hover:text-white transition-colors z-10",children:a.jsx(ur,{size:20})}),a.jsx("div",{className:"flex justify-center mb-4",children:O?a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 rounded-full blur-xl animate-pulse",style:{background:`${K.glow}40`}}),b?a.jsx("div",{className:`relative w-16 h-16 rounded-full flex items-center justify-center animate-float ${n===1?"bg-cyan-500":"bg-pink-500"}`,children:a.jsxs("span",{className:"text-white font-bold text-2xl",children:["P",n]})}):a.jsx(wr,{size:64,className:`relative ${K.text} animate-float`})]}):a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 bg-red-500/30 rounded-full blur-xl animate-pulse"}),a.jsx(dg,{size:64,className:"relative text-red-400 animate-shake"})]})}),a.jsx("h2",{className:`text-center text-2xl sm:text-3xl font-bold mb-1 ${K.text}`,style:{textShadow:`0 0 20px ${K.glow}`},children:_()}),a.jsx("p",{className:"text-center text-slate-400 text-sm mb-6",children:k()}),j&&h&&a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${h==="expert"||h==="hard"?"bg-purple-500/30 text-purple-300 border border-purple-500/50":h==="intermediate"?"bg-amber-500/30 text-amber-300 border border-amber-500/50":"bg-green-500/30 text-green-300 border border-green-500/50"}`,children:Bl(h).toUpperCase()})}),E&&d&&a.jsx("div",{className:"flex justify-center mb-4",children:a.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-bold bg-amber-500/30 text-amber-300 border border-amber-500/50",children:["vs ",d]})}),a.jsx("div",{className:"space-y-2",children:E?a.jsxs(a.Fragment,{children:[c&&a.jsxs("button",{onClick:m,className:`w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 transition-all ${K.btn} text-white border border-white/10`,children:[a.jsx(Oi,{size:16}),"PLAY AGAIN"]}),a.jsxs("button",{onClick:g,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 transition-all border border-slate-600",children:[a.jsx(Qs,{size:16}),"MENU"]})]}):e?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:x,className:`w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 transition-all ${K.btn} text-white border border-white/10`,children:[a.jsx(ci,{size:16}),"RETRY"]}),a.jsxs("button",{onClick:S,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 transition-all border border-slate-600",children:[a.jsx(Oi,{size:16}),"NEW PUZZLE"]}),a.jsxs("button",{onClick:y,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 transition-all border border-slate-600",children:[a.jsx(df,{size:16}),"PUZZLE DIFFICULTY"]}),a.jsxs("button",{onClick:g,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-400 transition-all border border-slate-700",children:[a.jsx(Qs,{size:16}),"MENU"]})]}):b?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:x,className:`w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 transition-all ${K.btn} text-white border border-white/10`,children:[a.jsx(ci,{size:16}),"PLAY AGAIN"]}),a.jsxs("button",{onClick:g,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-400 transition-all border border-slate-700",children:[a.jsx(Qs,{size:16}),"MENU"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:x,className:`w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 transition-all ${K.btn} text-white border border-white/10`,children:[a.jsx(ci,{size:16}),"PLAY AGAIN"]}),a.jsxs("button",{onClick:y,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 transition-all border border-slate-600",children:[a.jsx(df,{size:16}),"A.I. DIFFICULTY"]}),a.jsxs("button",{onClick:g,className:"w-full py-3 rounded-lg font-bold tracking-wide flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-400 transition-all border border-slate-700",children:[a.jsx(Qs,{size:16}),"MENU"]})]})})]}),a.jsx("style",{children:`
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }

        @keyframes modal-pop {
          0% { opacity: 0; transform: scale(0.9) translateY(20px); }
          70% { transform: scale(1.02); }
          100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        .animate-modal-pop { animation: modal-pop 0.4s ease-out; }

        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }
        .animate-float { animation: float 2s ease-in-out infinite; }

        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          20%, 60% { transform: translateX(-4px); }
          40%, 80% { transform: translateX(4px); }
        }
        .animate-shake { animation: shake 0.5s ease-in-out infinite; }

        @keyframes expand-ring {
          0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
          100% { transform: translate(-50%, -50%) scale(4); opacity: 0; }
        }
        .animate-expand-ring { animation: expand-ring 2s ease-out infinite; }

        @keyframes scan-vertical {
          0% { left: 0; }
          100% { left: 100%; }
        }
        .animate-scan-vertical { animation: scan-vertical 2s linear infinite; }

        @keyframes piece-fly {
          0% { transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
          100% { transform: translate(calc(-50% + var(--fly-x)), calc(-50% + var(--fly-y))) rotate(var(--rotation)); opacity: 0; }
        }
        .animate-piece-fly { animation: piece-fly 1.5s ease-out forwards; }

        @keyframes node-glow {
          0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.3); }
        }
        .animate-node-glow { animation: node-glow 1s ease-in-out infinite; }

        @keyframes line-draw {
          0% { width: 0; opacity: 0; }
          100% { opacity: 1; }
        }
        .animate-line-draw { animation: line-draw 0.5s ease-out forwards; }

        @keyframes static-noise {
          0%, 100% { opacity: 0.2; }
          50% { opacity: 0.3; }
        }
        .animate-static-noise {
          background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
          animation: static-noise 0.2s steps(5) infinite;
        }

        @keyframes scan-down {
          0% { transform: translateY(-100%); }
          100% { transform: translateY(100%); }
        }
        .animate-scan-down { animation: scan-down 1s linear infinite; }

        @keyframes glitch-slice {
          0%, 100% { transform: translateX(0); opacity: 0; }
          20% { transform: translateX(-20px); opacity: 1; }
          40% { transform: translateX(20px); opacity: 0.5; }
          60% { transform: translateX(-10px); opacity: 1; }
          80% { transform: translateX(10px); opacity: 0; }
        }
        .animate-glitch-slice { animation: glitch-slice 1.5s ease-in-out infinite; }

        @keyframes fall-glitch {
          0% { top: -20px; opacity: 1; }
          100% { top: 110%; opacity: 0; }
        }
        .animate-fall-glitch { animation: fall-glitch 2s linear infinite; }

        @keyframes blink {
          0%, 50% { opacity: 1; }
          51%, 100% { opacity: 0; }
        }
        .animate-blink { animation: blink 1s step-end infinite; }

        @keyframes shard-fall {
          0% { transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
          100% { transform: translate(calc(-50% + var(--fall-x)), calc(-50% + 200px)) rotate(var(--rotation)); opacity: 0; }
        }
        .animate-shard-fall { animation: shard-fall 1.5s ease-in forwards; }
      `})]})},yg=w.memo(({piece:t,position:e,offset:r={x:0,y:0},rotation:n=0,flipped:s=!1,isValid:i=!1,isValidDrop:o,isDragging:l=!0,hasValidCell:c=!0})=>{const u=c||o||i,d=typeof window<"u"&&window.innerWidth<640,h=d?36:48,f=d?2:4;if(!t||!e||!l)return null;const p=Lt(t,n,s);if(!p||p.length===0)return null;const v=Math.min(...p.map(([k])=>k)),x=Math.max(...p.map(([k])=>k)),S=Math.min(...p.map(([,k])=>k)),g=Math.max(...p.map(([,k])=>k)),m=(x-v+1)*(h+f)-f,y=(g-S+1)*(h+f)-f,b=li[t]||"bg-gradient-to-br from-cyan-400 to-blue-500",E=u?"rgba(34, 211, 238, 0.8)":"rgba(239, 68, 68, 0.8)",j=u?"0 0 25px rgba(34,211,238,0.5), 0 0 50px rgba(34,211,238,0.3)":"0 0 15px rgba(239,68,68,0.4), 0 0 30px rgba(239,68,68,0.2)",_=d?40:20;return a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed pointer-events-none z-[9999]",style:{left:e.x-m/2,top:e.y-y/2-_,transform:"translate3d(0, 0, 0)",willChange:"left, top"},children:a.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${x-v+1}, ${h}px)`,gap:`${f}px`,filter:`drop-shadow(${j.split(",")[0]})`},children:p.map(([k,O],P)=>{const Z=k-v,K=O-S;return a.jsxs("div",{className:`rounded-md sm:rounded-lg relative overflow-hidden ${b}`,style:{width:h,height:h,gridColumn:Z+1,gridRow:K+1,boxShadow:`0 0 12px ${E}, inset 0 0 8px rgba(255,255,255,0.2)`},children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/35 via-transparent to-black/20"}),a.jsx("div",{className:"absolute inset-0 rounded-md sm:rounded-lg",style:{border:`2px solid ${E}`,opacity:.8}})]},P)})})})})});yg.displayName="DragOverlay";const _r={beginner:{gridColor:"rgba(34,197,94,0.4)",glow1:"bg-green-500/30",glow2:"bg-emerald-400/20",panelBorder:"border-green-500/40",panelShadow:"shadow-[0_0_40px_rgba(34,197,94,0.3)]",label:"BEGINNER",labelBg:"from-green-600 via-emerald-500 to-green-600",labelGlow:"shadow-[0_0_30px_rgba(34,197,94,0.8)]",labelBorder:"border-green-400/50"},intermediate:{gridColor:"rgba(251,191,36,0.4)",glow1:"bg-amber-500/30",glow2:"bg-orange-400/20",panelBorder:"border-amber-500/40",panelShadow:"shadow-[0_0_40px_rgba(251,191,36,0.3)]",label:"INTERMEDIATE",labelBg:"from-amber-600 via-orange-500 to-amber-600",labelGlow:"shadow-[0_0_30px_rgba(251,191,36,0.8)]",labelBorder:"border-amber-400/50"},expert:{gridColor:"rgba(168,85,247,0.4)",glow1:"bg-purple-500/30",glow2:"bg-pink-400/20",panelBorder:"border-purple-500/40",panelShadow:"shadow-[0_0_40px_rgba(168,85,247,0.3)]",label:"EXPERT",labelBg:"from-purple-600 via-pink-500 to-purple-600",labelGlow:"shadow-[0_0_30px_rgba(168,85,247,0.8)]",labelBorder:"border-purple-400/50"},default:{gridColor:"rgba(34,211,238,0.3)",glow1:"bg-cyan-500/20",glow2:"bg-pink-500/15",panelBorder:"border-cyan-500/20",panelShadow:"",label:"",labelBg:"",labelGlow:"",labelBorder:""}},Z1=(t,e,r)=>{if(t==="ai")switch(e){case Pt.RANDOM:return _r.beginner;case Pt.AVERAGE:return _r.intermediate;case Pt.PROFESSIONAL:return _r.expert;default:return _r.intermediate}if(t==="puzzle")switch(r){case Ae.EASY:return _r.beginner;case Ae.MEDIUM:return _r.intermediate;case Ae.HARD:return _r.expert;default:return _r.beginner}return _r.default},e_=({currentPlayer:t,gameMode:e,theme:r,isAIThinking:n,aiDifficulty:s,puzzleDifficulty:i})=>{const o=e==="ai",l=e==="puzzle",c=o||l?"YOU":"PLAYER 1",u=o||l?"AI":"PLAYER 2",h=(()=>{if(o)switch(s){case Pt.RANDOM:return{text:"BEGINNER",color:"from-green-600 to-emerald-600",glow:"rgba(34,197,94,0.6)"};case Pt.AVERAGE:return{text:"INTERMEDIATE",color:"from-amber-500 to-orange-600",glow:"rgba(251,191,36,0.6)"};case Pt.PROFESSIONAL:return{text:"EXPERT",color:"from-purple-500 to-pink-600",glow:"rgba(168,85,247,0.6)"};default:return{text:"INTERMEDIATE",color:"from-amber-500 to-orange-600",glow:"rgba(251,191,36,0.6)"}}if(l)switch(i){case Ae.EASY:return{text:"EASY",color:"from-green-600 to-emerald-600",glow:"rgba(34,197,94,0.6)"};case Ae.MEDIUM:return{text:"MEDIUM",color:"from-amber-500 to-orange-600",glow:"rgba(251,191,36,0.6)"};case Ae.HARD:return{text:"HARD",color:"from-purple-500 to-pink-600",glow:"rgba(168,85,247,0.6)"};default:return{text:"PUZZLE",color:"from-cyan-500 to-blue-600",glow:"rgba(34,211,238,0.6)"}}return null})();return a.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3 py-2",children:[a.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all duration-300 ${t===1?"bg-cyan-500/20 border border-cyan-400/50 shadow-[0_0_15px_rgba(34,211,238,0.4)]":"bg-slate-800/50 border border-slate-700/50"}`,children:[a.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${t===1?"bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.8)] animate-pulse":"bg-slate-600"}`}),a.jsx("span",{className:`text-xs font-bold tracking-wide ${t===1?"text-cyan-300":"text-slate-500"}`,children:c})]}),(o||l)&&h?a.jsx("div",{className:`px-3 py-1 rounded-full bg-gradient-to-r ${h.color} border border-white/20`,style:{boxShadow:`0 0 15px ${h.glow}`},children:a.jsx("span",{className:"text-white text-[10px] font-black tracking-wider",children:h.text})}):a.jsx("span",{className:"text-slate-600 font-bold text-sm",children:"VS"}),a.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all duration-300 ${t===2?"bg-pink-500/20 border border-pink-400/50 shadow-[0_0_15px_rgba(236,72,153,0.4)]":"bg-slate-800/50 border border-slate-700/50"}`,children:[a.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${t===2?"bg-pink-400 shadow-[0_0_10px_rgba(236,72,153,0.8)] animate-pulse":"bg-slate-600"}`}),a.jsxs("span",{className:`text-xs font-bold tracking-wide ${t===2?"text-pink-300":"text-slate-500"}`,children:[u,n&&t===2&&a.jsx("span",{className:"ml-1 text-[10px] text-pink-400/70",children:"..."})]})]})]})},t_=({board:t,boardPieces:e,usedPieces:r,currentPlayer:n,selectedPiece:s,rotation:i,flipped:o,pendingMove:l,gameOver:c,winner:u,gameMode:d,aiDifficulty:h,puzzleDifficulty:f,isAIThinking:p,isGeneratingPuzzle:v,aiAnimatingMove:x,playerAnimatingMove:S,moveCount:g=0,onCellClick:m,onSelectPiece:y,onRotate:b,onFlip:E,onMovePiece:j,onConfirm:_,onCancel:k,onReset:O,onMenu:P,onRetryPuzzle:Z,onDifficultySelect:K,onQuitGame:ne,setPendingMove:R})=>{const{needsScroll:D,viewportHeight:I}=xd(850),[W,N]=w.useState(!1),[A,L]=w.useState(!1),[B,te]=w.useState(!1),[H,C]=w.useState(null),M=typeof window<"u"&&window.innerWidth<640,[U,V]=w.useState(!1),[z,ue]=w.useState(null),[fe,we]=w.useState({x:0,y:0}),[_e,Ye]=w.useState({x:0,y:0}),[pt,at]=w.useState(!1),[et,lt]=w.useState(null),De=w.useRef(null),Je=w.useRef(null),se=w.useRef(!1),X=Z1(d,h,f),ye=d==="puzzle",ge=u===1,ae=l&&(()=>{const pe=Lt(l.piece,i,o),re=lr(t,l.row,l.col,pe);return console.log("[GameScreen] canConfirm:",{piece:l.piece,row:l.row,col:l.col,isValid:re}),re})();w.useEffect(()=>{console.log("[GameScreen] Confirm state:",{pendingMove:!!l,canConfirm:ae,gameMode:d,currentPlayer:n})},[l,ae,d,n]),w.useEffect(()=>{if(l){const pe=Lt(l.piece,i,o),re=lr(t,l.row,l.col,pe);C(re?null:"Invalid placement!")}else C(null)},[l,i,o,t]),w.useEffect(()=>{if(c&&u!==null){const pe=setTimeout(()=>{N(!0)},500);return()=>clearTimeout(pe)}},[c,u]);const tt=()=>{N(!1)},$=w.useCallback((pe,re)=>{if(!Je.current)return null;const{left:je,top:Se,width:Wt,height:It}=Je.current,Fe=Wt/de,dr=It/de,zr=typeof window<"u"&&window.innerWidth<640?40:20,Lr=pe-je,Mr=re-zr-Se,br=Math.floor(Lr/Fe),mt=Math.floor(Mr/dr),Dr=4;return mt>=-Dr&&mt<de+Dr&&br>=-Dr&&br<de+Dr?{row:mt,col:br}:null},[]),le=w.useCallback((pe,re,je,Se)=>{if(c||r.includes(pe)||(d==="ai"||d==="puzzle")&&n===2)return;const Wt=re-(Se.left+Se.width/2),It=je-(Se.top+Se.height/2);ue(pe),we({x:re,y:je}),Ye({x:Wt,y:It}),V(!0),se.current=!0,y?.(pe),J.playPieceSelect(),document.body.style.overflow="hidden",document.body.style.touchAction="none"},[c,r,d,n,y]),Ee=w.useCallback((pe,re,je,Se)=>{if(c||(d==="ai"||d==="puzzle")&&n===2)return;const Wt=re-(Se.left+Se.width/2),It=je-(Se.top+Se.height/2);ue(pe),we({x:re,y:je}),Ye({x:Wt,y:It}),V(!0),se.current=!0,J.playPieceSelect(),document.body.style.overflow="hidden",document.body.style.touchAction="none"},[c,d,n]),ve=w.useCallback((pe,re)=>{if(!U||!z)return;we({x:pe,y:re}),De.current&&(Je.current=De.current.getBoundingClientRect());const je=$(pe,re);if(je){const Se=Lt(z,i,o),Wt=Math.min(...Se.map(([mt])=>mt)),It=Math.max(...Se.map(([mt])=>mt)),Fe=Math.min(...Se.map(([,mt])=>mt)),dr=Math.max(...Se.map(([,mt])=>mt)),Ht=Math.floor((It+Wt)/2),zr=Math.floor((dr+Fe)/2),Lr=je.row-zr,Mr=je.col-Ht;lt({row:Lr,col:Mr});const br=lr(t,Lr,Mr,Se);at(br)}else lt(null),at(!1)},[U,z,i,o,t,$]),Be=w.useCallback(()=>{U&&(et&&z&&R&&R({piece:z,row:et.row,col:et.col}),V(!1),ue(null),we({x:0,y:0}),Ye({x:0,y:0}),at(!1),lt(null),se.current=!1,document.body.style.overflow="",document.body.style.touchAction="")},[U,et,z,R]),$e=w.useCallback(pe=>{if(c||r.includes(pe))return{};if((d==="ai"||d==="puzzle")&&n===2)return{};let re=null;return{onTouchStart:Fe=>{if(se.current)return;const dr=Fe.touches[0];re=Fe.currentTarget.getBoundingClientRect(),De.current&&(Je.current=De.current.getBoundingClientRect()),le(pe,dr.clientX,dr.clientY,re)},onTouchMove:Fe=>{se.current&&(Fe.preventDefault(),ve(Fe.touches[0].clientX,Fe.touches[0].clientY))},onTouchEnd:Fe=>{se.current&&(Fe.preventDefault(),Be())},onMouseDown:Fe=>{Fe.button===0&&(se.current||(re=Fe.currentTarget.getBoundingClientRect(),De.current&&(Je.current=De.current.getBoundingClientRect()),le(pe,Fe.clientX,Fe.clientY,re)))}}},[c,r,d,n,le,ve,Be]);w.useEffect(()=>{if(!U)return;const pe=Se=>{ve(Se.clientX,Se.clientY)},re=()=>{Be()},je=Se=>{Se.key==="Escape"&&(Be(),k?.())};return window.addEventListener("mousemove",pe),window.addEventListener("mouseup",re),window.addEventListener("keydown",je),()=>{window.removeEventListener("mousemove",pe),window.removeEventListener("mouseup",re),window.removeEventListener("keydown",je)}},[U,ve,Be,k]),w.useEffect(()=>{if(!U)return;const pe=je=>{je.touches&&je.touches[0]&&(ve(je.touches[0].clientX,je.touches[0].clientY),je.cancelable&&je.preventDefault())},re=()=>{Be()};return window.addEventListener("touchmove",pe,{passive:!1}),window.addEventListener("touchend",re),()=>{window.removeEventListener("touchmove",pe),window.removeEventListener("touchend",re)}},[U,ve,Be]),w.useEffect(()=>()=>{document.body.style.overflow="",document.body.style.touchAction=""},[]);const F=w.useCallback((pe,re)=>{U||m?.(pe,re)},[U,m]);return a.jsxs("div",{className:D?"min-h-screen bg-transparent":"h-screen bg-transparent overflow-hidden",style:D?{overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:U?"none":"pan-y"}:{},children:[a.jsx("div",{className:`fixed top-0 right-0 w-96 h-96 ${X.glow1} rounded-full blur-3xl pointer-events-none`}),a.jsx("div",{className:`fixed bottom-0 left-0 w-80 h-80 ${X.glow2} rounded-full blur-3xl pointer-events-none`}),a.jsx("div",{className:`relative ${D?"min-h-screen":"h-full"} flex flex-col`,children:a.jsxs("div",{className:`flex-1 flex flex-col items-center justify-start px-2 sm:px-4 ${D?"pt-4 pb-2":"pt-2"}`,children:[a.jsxs("div",{className:"text-center mb-2",children:[a.jsx(Ii,{size:"medium"}),d==="ai"&&a.jsx(Ul,{text:"VS AI",size:"small",className:"mt-1"}),d==="puzzle"&&a.jsx(Ul,{text:"PUZZLE MODE",size:"small",className:"mt-1"}),d==="2player"&&a.jsx(Ul,{text:"2 PLAYER",size:"small",className:"mt-1"})]}),a.jsxs("div",{className:`w-full max-w-md ${D?"":"flex-shrink-0"}`,children:[a.jsx(e_,{currentPlayer:n,gameMode:d,theme:X,isAIThinking:p,aiDifficulty:h,puzzleDifficulty:f}),a.jsx(V1,{isAIThinking:p,gameOver:c,winner:u,gameMode:d,aiDifficulty:h}),a.jsx("div",{className:"flex justify-center pb-1",children:a.jsx(gg,{ref:De,board:t,boardPieces:e,pendingMove:l,rotation:i,flipped:o,gameOver:c,gameMode:d,currentPlayer:n,onCellClick:F,onPendingPieceDragStart:Ee,aiAnimatingMove:x,playerAnimatingMove:S,selectedPiece:s,isDragging:U,dragPreviewCell:et,draggedPiece:z,dragRotation:i,dragFlipped:o})}),l&&!v&&!U&&a.jsxs("div",{className:"flex items-start justify-center gap-3 mb-2",children:[a.jsx("div",{className:"flex-shrink-0 w-24",children:H&&a.jsx("div",{className:"error-message-box bg-red-900/80 border border-red-500/60 rounded-lg p-2 text-center shadow-[0_0_15px_rgba(239,68,68,0.4)]",children:a.jsx("span",{className:"text-red-300 text-xs font-bold leading-tight block",children:H})})}),a.jsx(H1,{onMove:j}),a.jsx("div",{className:"flex-shrink-0 w-24"})]}),a.jsx(W1,{selectedPiece:s,pendingMove:l,canConfirm:ae,gameOver:c,gameMode:d,currentPlayer:n,isGeneratingPuzzle:v,moveCount:g,onRotate:b,onFlip:E,onConfirm:_,onCancel:k,onReset:O,onRetryPuzzle:Z,onMenu:P,onQuitGame:ne?pe=>{te(pe),L(!0)}:null})]}),a.jsx("div",{className:D?"":"flex-1 min-h-0 overflow-auto",children:a.jsx(F1,{usedPieces:r,selectedPiece:s,pendingMove:l,gameOver:c,gameMode:d,currentPlayer:n,isMobile:M,isGeneratingPuzzle:v,onSelectPiece:y,createDragHandlers:$e,isDragging:U,draggedPiece:z})}),D&&a.jsx("div",{className:"h-8"})]})}),a.jsx(yg,{isDragging:U,piece:z,position:fe,offset:_e,rotation:i,flipped:o,isValid:pt}),W&&a.jsx(Q1,{isWin:ge,isPuzzle:ye,gameMode:d,winner:u,onClose:tt,onRetry:ye?Z:O,onNewGame:O,onMenu:P,onDifficultySelect:K}),A&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl p-6 max-w-sm w-full border border-slate-600/50 shadow-[0_0_50px_rgba(0,0,0,0.5)]",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${B?"bg-red-500/20 border-2 border-red-500/50":"bg-amber-500/20 border-2 border-amber-500/50"}`,children:B?a.jsx(lg,{size:32,className:"text-red-400"}):a.jsx(vd,{size:32,className:"text-amber-400"})})}),a.jsx("h2",{className:`text-xl font-bold text-center mb-2 ${B?"text-red-400":"text-amber-400"}`,children:B?"Forfeit Game?":"Cancel Game?"}),a.jsx("p",{className:"text-slate-300 text-center text-sm mb-6",children:B?"This will count as a loss. Are you sure you want to forfeit?":"No moves have been made yet. This game will not affect your stats."}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>L(!1),className:"flex-1 py-3 px-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-all border border-slate-500/50",children:"Keep Playing"}),a.jsx("button",{onClick:()=>{L(!1),ne&&ne(B)},className:`flex-1 py-3 px-4 rounded-xl font-bold transition-all border ${B?"bg-red-600 hover:bg-red-500 text-white border-red-400/50":"bg-amber-600 hover:bg-amber-500 text-white border-amber-400/50"}`,children:B?"Forfeit":"Quit"})]})]})}),a.jsx("style",{children:`
        .error-message-box {
          animation: error-shake 0.5s ease-in-out, error-pulse 1.5s ease-in-out infinite;
        }
        @keyframes error-shake {
          0%, 100% { transform: translateX(0); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
          20%, 40%, 60%, 80% { transform: translateX(2px); }
        }
        @keyframes error-pulse {
          0%, 100% { box-shadow: 0 0 15px rgba(239,68,68,0.4); }
          50% { box-shadow: 0 0 25px rgba(239,68,68,0.6); }
        }
      `})]})},r_=()=>{const t=Object.keys(Qt),e=16,r=4,n=4,s=100/r,i=100/n,o=[];for(let l=0;l<e;l++){const c=l%r,u=Math.floor(l/r)%n,d=c*s,h=u*i,f=Math.random()*s*.8,p=Math.random()*i*.8;o.push({id:l,piece:t[Math.floor(Math.random()*t.length)],startX:d+f,startY:h+p,delay:Math.random()*15-15/2,duration:12+Math.random()*18,floatX:(Math.random()-.5)*100,floatY:(Math.random()-.5)*80,rotation:Math.random()*360,rotationSpeed:(Math.random()-.5)*180,scale:.5+Math.random()*.6,fadeOffset:Math.random()*.4})}return o},n_=r_(),gf={menu:[{color:"#22d3ee",glow:"rgba(34,211,238,0.5)"},{color:"#ec4899",glow:"rgba(236,72,153,0.5)"},{color:"#a855f7",glow:"rgba(168,85,247,0.5)"}],online:[{color:"#f59e0b",glow:"rgba(245,158,11,0.5)"},{color:"#f97316",glow:"rgba(249,115,22,0.5)"},{color:"#eab308",glow:"rgba(234,179,8,0.5)"}],game:[{color:"#22d3ee",glow:"rgba(34,211,238,0.5)"},{color:"#a855f7",glow:"rgba(168,85,247,0.5)"},{color:"#6366f1",glow:"rgba(99,102,241,0.5)"}],puzzle:[{color:"#10b981",glow:"rgba(16,185,129,0.5)"},{color:"#22d3ee",glow:"rgba(34,211,238,0.5)"},{color:"#14b8a6",glow:"rgba(20,184,166,0.5)"}],auth:[{color:"#6366f1",glow:"rgba(99,102,241,0.5)"},{color:"#8b5cf6",glow:"rgba(139,92,246,0.5)"},{color:"#a855f7",glow:"rgba(168,85,247,0.5)"}]},s_=`
  .gb-container {
    position: fixed;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
    z-index: 0;
    background-color: #020617;
  }
  
  .gb-grid {
    position: absolute;
    inset: 0;
    opacity: 0.25;
    animation: gb-grid-drift 30s ease-in-out infinite;
  }
  
  @keyframes gb-grid-drift {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(10px, 10px); }
  }
  
  .gb-piece {
    position: absolute;
    pointer-events: none;
    will-change: transform, opacity;
  }
`,vg=w.memo(({data:t,colors:e})=>{const{piece:r,startX:n,startY:s,delay:i,duration:o,floatX:l,floatY:c,rotation:u,rotationSpeed:d,scale:h,fadeOffset:f}=t,p=Qt[r]||Qt.T,v=Math.min(...p.map(([b])=>b)),x=Math.min(...p.map(([,b])=>b)),S=t.id%e.length,{color:g,glow:m}=e[S],y=`gb-float-${t.id}`;return a.jsxs("div",{className:"gb-piece",style:{left:`${n}%`,top:`${s}%`,filter:`drop-shadow(0 0 10px ${m})`},children:[a.jsx("style",{children:`
        @keyframes ${y} {
          0% {
            transform: translate(0, 0) rotate(${u}deg) scale(${h});
            opacity: 0;
          }
          ${10+f*20}% {
            opacity: 0.6;
          }
          25% {
            transform: translate(${l*.4}px, ${c*.3}px) rotate(${u+d*.25}deg) scale(${h*1.05});
            opacity: 0.7;
          }
          50% {
            transform: translate(${l}px, ${c}px) rotate(${u+d*.5}deg) scale(${h*1.1});
            opacity: 0.8;
          }
          75% {
            transform: translate(${l*.6}px, ${c*1.2}px) rotate(${u+d*.75}deg) scale(${h*1.05});
            opacity: 0.6;
          }
          ${90-f*10}% {
            opacity: 0.4;
          }
          100% {
            transform: translate(0, 0) rotate(${u+d}deg) scale(${h});
            opacity: 0;
          }
        }
      `}),a.jsx("div",{style:{animation:`${y} ${o}s ease-in-out infinite`,animationDelay:`${i}s`},children:a.jsx("div",{style:{transform:`scale(${h})`},children:p.map(([b,E],j)=>a.jsx("div",{className:"absolute rounded-sm",style:{width:10,height:10,left:(b-v)*12,top:(E-x)*12,backgroundColor:g,boxShadow:`0 0 12px ${m}`}},j))})})]})});vg.displayName="FloatingPiece";const xg=w.memo(({theme:t="menu"})=>{const e=w.useRef(!1);w.useEffect(()=>{if(e.current)return;if(document.getElementById("gb-styles")){e.current=!0;return}const s=document.createElement("style");s.id="gb-styles",s.textContent=s_,document.head.appendChild(s),e.current=!0},[]);const r=gf[t]||gf.menu,n=r[0]?.glow||"rgba(34,211,238,0.3)";return a.jsxs("div",{className:"gb-container",children:[a.jsx("div",{className:"gb-grid",style:{backgroundImage:`
            linear-gradient(${n} 1px, transparent 1px),
            linear-gradient(90deg, ${n} 1px, transparent 1px)
          `,backgroundSize:"50px 50px"}}),n_.map(s=>a.jsx(vg,{data:s,colors:r},s.id))]})});xg.displayName="GlobalBackground";var wg={exports:{}},i_="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",o_=i_,a_=o_;function bg(){}function _g(){}_g.resetWarningCache=bg;var l_=function(){function t(n,s,i,o,l,c){if(c!==a_){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:_g,resetWarningCache:bg};return r.PropTypes=r,r};wg.exports=l_();var c_=wg.exports;const Mt=lu(c_),yf={fullscreen:"min-h-screen",container:"min-h-[400px]",inline:"min-h-[200px]",small:"min-h-[100px]"},wd=({variant:t="fullscreen",message:e="Loading...",showLogo:r=!0,transparent:n=!1})=>{const s=yf[t]||yf.fullscreen,i=n?"bg-transparent":"bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950";return a.jsxs("div",{className:`${s} ${i} flex flex-col items-center justify-center relative overflow-hidden`,children:[!n&&a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`
              linear-gradient(rgba(34, 211, 238, 0.15) 1px, transparent 1px),
              linear-gradient(90deg, rgba(34, 211, 238, 0.15) 1px, transparent 1px)
            `,backgroundSize:"40px 40px"}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-cyan-500/20 rounded-full blur-[60px] animate-pulse"}),a.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-24 h-24 bg-purple-500/15 rounded-full blur-[50px] animate-pulse",style:{animationDelay:"0.5s"}})]}),a.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[r&&t==="fullscreen"?a.jsx("div",{className:"mb-6",children:a.jsx("h1",{className:"text-4xl font-black font-['Orbitron'] tracking-wider bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500 bg-clip-text text-transparent animate-pulse",children:"DEADBLOCK"})}):a.jsx(qa,{size:t==="small"?"sm":"md"}),t!=="small"&&a.jsx("div",{className:"w-48 h-1 bg-slate-800 rounded-full overflow-hidden mt-4",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 via-purple-500 to-cyan-500 rounded-full animate-loading-bar",style:{backgroundSize:"200% 100%"}})}),a.jsx("p",{className:"mt-4 text-sm text-cyan-400/80 font-['Orbitron'] tracking-widest animate-pulse",children:e})]}),a.jsx("style",{children:`
        @keyframes loading-bar {
          0% { 
            transform: translateX(-100%);
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
          100% { 
            transform: translateX(100%);
            background-position: 0% 50%;
          }
        }
        .animate-loading-bar {
          animation: loading-bar 1.5s ease-in-out infinite;
        }
      `})]})},qa=({size:t="md",className:e=""})=>{const r={sm:"w-6 h-6 border-2",md:"w-10 h-10 border-3",lg:"w-16 h-16 border-4"};return a.jsx("div",{className:`
        ${r[t]||r.md}
        ${e}
        rounded-full 
        border-cyan-500/30 
        border-t-cyan-400 
        animate-spin
      `})};wd.propTypes={variant:Mt.oneOf(["fullscreen","container","inline","small"]),message:Mt.string,showLogo:Mt.bool,transparent:Mt.bool};wd.defaultProps={variant:"fullscreen",message:"Loading...",showLogo:!0,transparent:!1};qa.propTypes={size:Mt.oneOf(["sm","md","lg"]),className:Mt.string};qa.defaultProps={size:"md",className:""};Mt.string,Mt.string,Mt.oneOf(["none","sm","md","lg","full"]),Mt.string;Mt.string;Mt.number,Mt.string;const St=({children:t,fallback:e=null,variant:r="fullscreen",message:n="Loading..."})=>{const s=a.jsx(wd,{variant:r,message:n});return a.jsx(w.Suspense,{fallback:e||s,children:t})},u_=({children:t,fallback:e=null})=>{const r=a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(qa,{size:"md"})});return a.jsx(w.Suspense,{fallback:e||r,children:t})};function wt(t){const e=w.lazy(t);return e.preload=t,e}const d_=wt(()=>be(()=>import("./PuzzleSelect-BbNAWsei.js"),__vite__mapDeps([0,1,2,3]))),h_=wt(()=>be(()=>import("./SpeedPuzzleScreen-rYlulggE.js"),__vite__mapDeps([4,2,5]))),f_=wt(()=>be(()=>import("./DifficultySelector-z7FNP3aQ.js"),__vite__mapDeps([6,1]))),p_=wt(()=>be(()=>import("./WeeklyChallengeMenu-BqhD-qPz.js"),__vite__mapDeps([7,1,8,9,10,5]))),m_=wt(()=>be(()=>import("./WeeklyChallengeScreen-CcMY13-p.js"),__vite__mapDeps([11,8,5,10]))),g_=wt(()=>be(()=>import("./WeeklyLeaderboard-B1Apot1g.js"),__vite__mapDeps([12,8,10])));wt(()=>be(()=>import("./PlayerStatsModal-DSH7rXvy.js"),__vite__mapDeps([13,8,9,14,15])));const y_=wt(()=>be(()=>import("./AuthScreen-C7JP4sg5.js"),[])),v_=wt(()=>be(()=>import("./OnlineMenu-Zq3I1gHM.js"),__vite__mapDeps([16,17,18,19,20,21,5,15,9,10,22,23,24,25]))),x_=wt(()=>be(()=>import("./MatchmakingScreen-BnYnTXTP.js"),__vite__mapDeps([26,1,24,3])));wt(()=>be(()=>import("./OnlineGameScreen-DNkQDosp.js"),__vite__mapDeps([27,17,19,23,10])));wt(()=>be(()=>import("./UserProfile-BElF1E3B.js"),__vite__mapDeps([28,17,20,21,5,15,9,10,14])));wt(()=>be(()=>import("./Leaderboard-Cfx2t2ZS.js"),__vite__mapDeps([29,15])));wt(()=>be(()=>import("./SpectatorView-WDgcaXPl.js").then(t=>t.a),__vite__mapDeps([22,23])));wt(()=>be(()=>import("./GameReplay-DyvkTJ-H.js"),__vite__mapDeps([30,10,25,21,5])));const w_=()=>{y_.preload(),v_.preload(),x_.preload()},b_=()=>{d_.preload(),h_.preload(),f_.preload()},__=()=>{p_.preload(),m_.preload(),g_.preload()},Fl=({onComplete:t,onOfflineMode:e,forceOnlineOnly:r=!1,intendedDestination:n="online-menu",inviteInfo:s=null,inviteLoading:i=!1,inviteError:o=null,onCancelInvite:l=null})=>{const{signIn:c,signUp:u,signInWithGoogle:d,signInWithMagicLink:h,resetPassword:f,resendConfirmationEmail:p}=Fi(),{needsScroll:v}=xd(700),x=!!s||i,[S,g]=w.useState("select"),[m,y]=w.useState(""),[b,E]=w.useState(""),[j,_]=w.useState(""),[k,O]=w.useState(!1),[P,Z]=w.useState(!1),[K,ne]=w.useState(""),[R,D]=w.useState(""),[I,W]=w.useState(!1),[N,A]=w.useState(!1),L=()=>{ne(""),D(""),W(!1)},B=X=>{J.playClickSound?.("select"),g(X),L()},te=async X=>{X.preventDefault(),L(),Z(!0),J.playButtonClick?.();try{const ye=await c(m,b);ye.error?(ne(ye.error.message),ye.needsEmailConfirmation&&W(!0)):t?.()}catch{ne("An unexpected error occurred")}Z(!1)},H=async X=>{if(X.preventDefault(),L(),Z(!0),J.playButtonClick?.(),!j||j.length<3){ne("Username must be at least 3 characters"),Z(!1);return}if(!m||!m.includes("@")){ne("Please enter a valid email address"),Z(!1);return}if(!b||b.length<6){ne("Password must be at least 6 characters"),Z(!1);return}try{const ye=await u(m,b,j);ye.error?ne(ye.error.message):ye.needsEmailConfirmation?D("Account created! Check your email and click the verification link, then come back and sign in."):(D("Account created! Signing you in..."),setTimeout(()=>{t?.()},1e3))}catch{ne("An unexpected error occurred")}Z(!1)},C=async X=>{X.preventDefault(),L(),Z(!0),J.playButtonClick?.();try{if(!m||!m.includes("@")){ne("Please enter a valid email address"),Z(!1);return}const{error:ye}=await f(m);ye?ne(ye.message):D("Password reset email sent! Check your inbox (and junk/spam folder).")}catch{ne("An unexpected error occurred")}Z(!1)},M=async X=>{X.preventDefault(),L(),Z(!0),J.playButtonClick?.();try{if(!m||!m.includes("@")){ne("Please enter a valid email address"),Z(!1);return}const{error:ye}=await h(m);ye?ne(ye.message):D("Magic link sent! Check your email (and junk/spam folder) to sign in.")}catch{ne("An unexpected error occurred")}Z(!1)},U=async()=>{L(),J.playButtonClick?.(),Z(!0);try{const{data:X,error:ye}=await d();if(ye){ne(ye.message),Z(!1);return}setTimeout(()=>{document.visibilityState==="visible"&&(ne("Could not redirect to Google. Please try again or use another sign-in method."),Z(!1))},3e3)}catch{ne("Failed to start Google Sign In. Please try again."),Z(!1)}},V=async()=>{if(!(!m||N)){A(!0),J.playButtonClick?.();try{const{error:X}=await p(m);X?ne("Could not resend email: "+X.message):(D("Confirmation email sent! Check your inbox (and junk/spam folder)."),W(!1))}catch{ne("Failed to resend confirmation email")}A(!1)}},z=()=>{J.playButtonClick?.(),e?.()},ue=()=>{J.playButtonClick?.(),l?.()},fe=v?{overflow:"auto",WebkitOverflowScrolling:"touch",touchAction:"pan-y pinch-zoom",overscrollBehavior:"contain",height:"100%",minHeight:"100dvh"}:{},we=()=>i?a.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-amber-900/40 to-orange-900/40 border border-amber-500/50 rounded-xl shadow-[0_0_20px_rgba(251,191,36,0.2)]",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ai,{size:20,className:"text-amber-400 animate-spin"}),a.jsx("span",{className:"text-amber-300 text-sm font-medium",children:"Loading game invite..."})]})}):o?a.jsx("div",{className:"mb-4 p-4 bg-red-900/30 border border-red-500/50 rounded-xl",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vd,{size:20,className:"text-red-400"}),a.jsx("div",{className:"flex-1",children:a.jsx("span",{className:"text-red-300 text-sm",children:o})}),l&&a.jsx("button",{onClick:ue,className:"text-red-400 hover:text-red-300 text-xs underline",children:"Dismiss"})]})}):s?a.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-amber-900/40 to-orange-900/40 border border-amber-500/50 rounded-xl shadow-[0_0_25px_rgba(251,191,36,0.25)]",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2.5 bg-amber-500/20 rounded-lg border border-amber-400/30",children:a.jsx(v1,{size:24,className:"text-amber-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-amber-300 font-bold text-sm mb-1 flex items-center gap-2",children:" Game Invitation"}),a.jsxs("p",{className:"text-slate-200 text-sm",children:[a.jsx("span",{className:"text-amber-200 font-bold",children:s.from_username||s.from_display_name||"A player"})," ","has challenged you to a game!"]})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-amber-500/20",children:a.jsx("p",{className:"text-amber-200/80 text-xs",children:" Sign in or create an account to accept the challenge"})}),l&&a.jsx("button",{onClick:ue,className:"mt-2 text-slate-400 hover:text-slate-300 text-xs underline",children:"Cancel and go to main menu"})]}):null,_e=()=>a.jsxs("div",{className:"mb-5 grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"p-3 bg-gradient-to-br from-cyan-900/30 to-blue-900/30 border border-cyan-500/30 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(_1,{size:14,className:"text-cyan-400"}),a.jsx("span",{className:"text-cyan-300 text-xs font-bold uppercase tracking-wider",children:"Online"})]}),a.jsxs("ul",{className:"space-y-1.5 text-xs text-slate-300",children:[a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(wr,{size:10,className:"text-amber-400"}),a.jsx("span",{children:"Compete globally"})]}),a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(gd,{size:10,className:"text-purple-400"}),a.jsx("span",{children:"Track stats & rank"})]}),a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(pg,{size:10,className:"text-green-400"}),a.jsx("span",{children:"Challenge friends"})]})]})]}),a.jsxs("div",{className:"p-3 bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-slate-600/30 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ff,{size:14,className:"text-slate-400"}),a.jsx("span",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider",children:"Offline"})]}),a.jsxs("ul",{className:"space-y-1.5 text-xs text-slate-400",children:[a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(Va,{size:10,className:"text-slate-500"}),a.jsx("span",{children:"Play vs AI"})]}),a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(y1,{size:10,className:"text-slate-500"}),a.jsx("span",{children:"No account needed"})]}),a.jsxs("li",{className:"flex items-center gap-1.5",children:[a.jsx(cf,{size:10,className:"text-slate-500"}),a.jsx("span",{children:"Play anywhere"})]})]})]})]}),Ye=()=>{const X=[{id:"login",name:"SIGN IN",subtitle:"Existing Account",description:"Access your profile and continue your progress",icon:au,colors:{gradient:"from-green-600 to-emerald-600",glow:"rgba(34,197,94,0.6)",text:"text-green-300",ring:"ring-green-500/50",bg:"bg-green-900/30",border:"border-green-500/40"}},{id:"signup",name:"CREATE ACCOUNT",subtitle:"New Player",description:"Join and start tracking your stats",icon:Ml,colors:{gradient:"from-amber-500 to-orange-600",glow:"rgba(251,191,36,0.6)",text:"text-amber-300",ring:"ring-amber-500/50",bg:"bg-amber-900/30",border:"border-amber-500/40"}},{id:"google",name:"GOOGLE",subtitle:"Quick Sign-In",description:"Use your Google account for instant access",icon:cf,colors:{gradient:"from-purple-500 to-pink-600",glow:"rgba(168,85,247,0.6)",text:"text-purple-300",ring:"ring-purple-500/50",bg:"bg-purple-900/30",border:"border-purple-500/40"}}];!r&&!x&&X.push({id:"offline",name:"PLAY OFFLINE",subtitle:"No Account",description:"Jump right in - stats won't be saved",icon:ff,colors:{gradient:"from-red-600 to-rose-600",glow:"rgba(239,68,68,0.5)",text:"text-red-300",ring:"ring-red-500/50",bg:"bg-red-900/30",border:"border-red-500/40"}});const ye=ge=>{J.playButtonClick?.(),ge==="login"?B("login"):ge==="signup"?B("signup"):ge==="google"?U():ge==="offline"&&z()};return a.jsxs("div",{className:"space-y-3",children:[a.jsx(we,{}),!x&&a.jsx(_e,{}),K&&a.jsx("div",{className:"p-3 bg-red-900/50 border border-red-500/50 rounded-xl text-red-300 text-sm shadow-[0_0_15px_rgba(239,68,68,0.2)]",children:K}),a.jsx("div",{className:"space-y-2",children:X.map(ge=>{const ae=ge.icon,tt=ge.id==="google",$=P&&tt,Ee={login:{from:"#16a34a",to:"#059669"},signup:{from:"#f59e0b",to:"#ea580c"},google:{from:"#a855f7",to:"#db2777"},offline:{from:"#dc2626",to:"#e11d48"}}[ge.id];return a.jsxs("button",{onClick:()=>ye(ge.id),disabled:$,className:`w-full p-3 rounded-xl transition-all duration-300 relative overflow-hidden group
                  ${ge.colors.bg} ${ge.colors.border} border-2
                  hover:border-white/40 hover:ring-4 ${ge.colors.ring}
                  active:scale-[0.98] disabled:opacity-70 disabled:cursor-wait`,style:{boxShadow:`0 0 20px ${ge.colors.glow.replace("0.6","0.2")}`},onMouseEnter:ve=>{ve.currentTarget.style.boxShadow=`0 0 35px ${ge.colors.glow}`,ve.currentTarget.style.background=`linear-gradient(to right, ${Ee.from}, ${Ee.to})`},onMouseLeave:ve=>{ve.currentTarget.style.boxShadow=`0 0 20px ${ge.colors.glow.replace("0.6","0.2")}`,ve.currentTarget.style.background=""},children:[a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-xl opacity-0 group-hover:opacity-100",children:a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shine"})}),a.jsxs("div",{className:"relative flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300
                      bg-gradient-to-br ${ge.colors.gradient} group-hover:scale-110`,style:{boxShadow:`0 0 15px ${ge.colors.glow}`},children:$?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):tt?a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[a.jsx("path",{fill:"#fff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#fff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#fff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#fff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}):a.jsx(ae,{size:20,className:"text-white"})}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("h3",{className:`font-black tracking-wide text-sm group-hover:text-white transition-colors ${ge.colors.text}`,children:ge.name}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-slate-700/50 text-slate-400 group-hover:bg-white/20 group-hover:text-white transition-colors",children:ge.subtitle})]}),a.jsx("p",{className:"text-xs text-slate-400 group-hover:text-white/80 transition-colors",children:ge.description})]}),a.jsx(Tn,{size:20,className:`flex-shrink-0 transition-all duration-300 group-hover:translate-x-1 group-hover:text-white ${ge.colors.text}`})]})]},ge.id)})})]})},pt=()=>a.jsxs("div",{className:"space-y-4",children:[a.jsx(we,{}),a.jsxs("button",{type:"button",onClick:()=>B("select"),className:"flex items-center gap-2 text-slate-400 hover:text-green-300 text-sm transition-colors group",children:[a.jsx(vo,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to options"]}),a.jsxs("div",{className:"text-center mb-2",children:[a.jsx("div",{className:"w-14 h-14 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-3 border border-green-400/30",children:a.jsx(uf,{size:28,className:"text-green-400"})}),a.jsx("h3",{className:"text-white font-bold text-lg",children:"Sign In"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Welcome back! Enter your credentials"})]}),K&&a.jsx("div",{className:"p-3 bg-red-900/50 border border-red-500/50 rounded-xl text-red-300 text-sm",children:K}),R&&a.jsxs("div",{className:"p-3 bg-green-900/50 border border-green-500/50 rounded-xl text-green-300 text-sm flex items-start gap-2",children:[a.jsx(xo,{size:16,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:R})]}),I&&a.jsxs("div",{className:"p-3 bg-amber-900/30 border border-amber-500/50 rounded-xl",children:[a.jsx("p",{className:"text-amber-200 text-sm mb-2",children:"Haven't verified your email yet?"}),a.jsx("button",{onClick:V,disabled:N,className:"text-amber-300 hover:text-amber-200 text-sm font-medium flex items-center gap-2 disabled:opacity-50",children:N?a.jsxs(a.Fragment,{children:[a.jsx(Oi,{size:14,className:"animate-spin"})," Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(bn,{size:14})," Resend confirmation email"]})})]}),a.jsxs("form",{onSubmit:te,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-400 text-xs mb-1.5 uppercase tracking-wider",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(bn,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:"email",value:m,onChange:X=>y(X.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-green-500 focus:ring-1 focus:ring-green-500/50 focus:outline-none transition-all",placeholder:"your@email.com",required:!0,autoComplete:"email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-400 text-xs mb-1.5 uppercase tracking-wider",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:k?"text":"password",value:b,onChange:X=>E(X.target.value),className:"w-full pl-10 pr-12 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-green-500 focus:ring-1 focus:ring-green-500/50 focus:outline-none transition-all",placeholder:"Enter password",required:!0,autoComplete:"current-password"}),a.jsx("button",{type:"button",onClick:()=>O(!k),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300",children:k?a.jsx(su,{size:16}):a.jsx(iu,{size:16})})]})]}),a.jsxs("button",{type:"submit",disabled:P,className:`w-full p-3 rounded-xl transition-all duration-300 relative overflow-hidden group
            bg-green-900/30 border-2 border-green-500/40
            hover:border-white/40 hover:ring-4 ring-green-500/50
            active:scale-[0.98] disabled:opacity-50`,style:{boxShadow:"0 0 20px rgba(34,197,94,0.2)"},onMouseEnter:X=>{X.currentTarget.style.boxShadow="0 0 35px rgba(34,197,94,0.6)",X.currentTarget.style.background="linear-gradient(to right, #16a34a, #059669)"},onMouseLeave:X=>{X.currentTarget.style.boxShadow="0 0 20px rgba(34,197,94,0.2)",X.currentTarget.style.background=""},children:[a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-xl opacity-0 group-hover:opacity-100",children:a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shine"})}),a.jsxs("div",{className:"relative flex items-center justify-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300
                bg-gradient-to-br from-green-600 to-emerald-600 group-hover:scale-110`,style:{boxShadow:"0 0 15px rgba(34,197,94,0.6)"},children:P?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(au,{size:20,className:"text-white"})}),a.jsx("span",{className:"font-black tracking-wide text-sm text-green-300 group-hover:text-white transition-colors",children:"SIGN IN"}),a.jsx(Tn,{size:20,className:"flex-shrink-0 transition-all duration-300 group-hover:translate-x-1 group-hover:text-white text-green-300"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4 pt-2",children:[a.jsxs("button",{onClick:()=>B("forgot-password"),className:"text-slate-400 hover:text-amber-400 text-xs transition-colors flex items-center gap-1",children:[a.jsx(ou,{size:12}),"Forgot Password?"]}),a.jsx("span",{className:"text-slate-600",children:"|"}),a.jsxs("button",{onClick:()=>B("magic-link"),className:"text-slate-400 hover:text-purple-400 text-xs transition-colors flex items-center gap-1",children:[a.jsx(Dl,{size:12}),"Magic Link"]})]})]}),at=()=>a.jsxs("div",{className:"space-y-4",children:[a.jsx(we,{}),a.jsxs("button",{type:"button",onClick:()=>B("select"),className:"flex items-center gap-2 text-slate-400 hover:text-amber-300 text-sm transition-colors group",children:[a.jsx(vo,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to options"]}),a.jsxs("div",{className:"text-center mb-2",children:[a.jsx("div",{className:"w-14 h-14 bg-amber-500/20 rounded-full flex items-center justify-center mx-auto mb-3 border border-amber-400/30",children:a.jsx(Ml,{size:28,className:"text-amber-400"})}),a.jsx("h3",{className:"text-white font-bold text-lg",children:"Create Account"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Join Deadblock with email & password"})]}),K&&a.jsx("div",{className:"p-3 bg-red-900/50 border border-red-500/50 rounded-xl text-red-300 text-sm",children:K}),R&&a.jsxs("div",{className:"p-3 bg-green-900/50 border border-green-500/50 rounded-xl text-green-300 text-sm flex items-start gap-2",children:[a.jsx(xo,{size:16,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:R})]}),a.jsxs("form",{onSubmit:H,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-400 text-xs mb-1.5 uppercase tracking-wider",children:"Username"}),a.jsxs("div",{className:"relative",children:[a.jsx(fg,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:"text",value:j,onChange:X=>_(X.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-amber-500 focus:ring-1 focus:ring-amber-500/50 focus:outline-none transition-all",placeholder:"Choose a username",required:!0,minLength:3,autoComplete:"username"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-400 text-xs mb-1.5 uppercase tracking-wider",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(bn,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:"email",value:m,onChange:X=>y(X.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-amber-500 focus:ring-1 focus:ring-amber-500/50 focus:outline-none transition-all",placeholder:"your@email.com",required:!0,autoComplete:"email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-400 text-xs mb-1.5 uppercase tracking-wider",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:k?"text":"password",value:b,onChange:X=>E(X.target.value),className:"w-full pl-10 pr-12 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-amber-500 focus:ring-1 focus:ring-amber-500/50 focus:outline-none transition-all",placeholder:"At least 6 characters",required:!0,minLength:6,autoComplete:"new-password"}),a.jsx("button",{type:"button",onClick:()=>O(!k),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300",children:k?a.jsx(su,{size:16}):a.jsx(iu,{size:16})})]})]}),a.jsxs("button",{type:"submit",disabled:P,className:`w-full p-3 rounded-xl transition-all duration-300 relative overflow-hidden group
            bg-amber-900/30 border-2 border-amber-500/40
            hover:border-white/40 hover:ring-4 ring-amber-500/50
            active:scale-[0.98] disabled:opacity-50`,style:{boxShadow:"0 0 20px rgba(251,191,36,0.2)"},onMouseEnter:X=>{X.currentTarget.style.boxShadow="0 0 35px rgba(251,191,36,0.6)",X.currentTarget.style.background="linear-gradient(to right, #f59e0b, #ea580c)"},onMouseLeave:X=>{X.currentTarget.style.boxShadow="0 0 20px rgba(251,191,36,0.2)",X.currentTarget.style.background=""},children:[a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-xl opacity-0 group-hover:opacity-100",children:a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shine"})}),a.jsxs("div",{className:"relative flex items-center justify-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300
                bg-gradient-to-br from-amber-500 to-orange-600 group-hover:scale-110`,style:{boxShadow:"0 0 15px rgba(251,191,36,0.6)"},children:P?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(Ml,{size:20,className:"text-white"})}),a.jsx("span",{className:"font-black tracking-wide text-sm text-amber-300 group-hover:text-white transition-colors",children:x?"CREATE & JOIN":"CREATE ACCOUNT"}),a.jsx(Tn,{size:20,className:"flex-shrink-0 transition-all duration-300 group-hover:translate-x-1 group-hover:text-white text-amber-300"})]})]})]}),a.jsxs("p",{className:"text-slate-500 text-xs text-center",children:["Already have an account?"," ",a.jsx("button",{onClick:()=>B("login"),className:"text-green-400 hover:text-green-300",children:"Sign in"})]})]}),et=()=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{type:"button",onClick:()=>B("login"),className:"flex items-center gap-2 text-slate-400 hover:text-amber-300 text-sm transition-colors group",children:[a.jsx(vo,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to sign in"]}),a.jsxs("div",{className:"text-center mb-2",children:[a.jsx("div",{className:"w-14 h-14 bg-amber-500/20 rounded-full flex items-center justify-center mx-auto mb-3 border border-amber-400/30",children:a.jsx(uf,{size:28,className:"text-amber-400"})}),a.jsx("h3",{className:"text-white font-bold text-lg",children:"Reset Password"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Enter your email to receive a reset link"})]}),K&&a.jsx("div",{className:"p-3 bg-red-900/50 border border-red-500/50 rounded-xl text-red-300 text-sm",children:K}),R&&a.jsxs("div",{className:"p-3 bg-green-900/50 border border-green-500/50 rounded-xl text-green-300 text-sm flex items-start gap-2",children:[a.jsx(xo,{size:16,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:R})]}),a.jsxs("form",{onSubmit:C,className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(bn,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:"email",value:m,onChange:X=>y(X.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-amber-500 focus:ring-1 focus:ring-amber-500/50 focus:outline-none transition-all",placeholder:"your@email.com",required:!0,autoComplete:"email"})]}),a.jsx("button",{type:"submit",disabled:P||!!R,className:"w-full py-3 bg-gradient-to-r from-amber-600 to-orange-600 text-white font-bold rounded-xl hover:from-amber-500 hover:to-orange-500 transition-all flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(251,191,36,0.25)] disabled:opacity-50 border border-amber-400/30",children:P?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(bn,{size:18}),a.jsx("span",{children:"Send Reset Link"})]})})]})]}),lt=()=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{type:"button",onClick:()=>B("login"),className:"flex items-center gap-2 text-slate-400 hover:text-green-300 text-sm transition-colors group",children:[a.jsx(vo,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to sign in"]}),a.jsxs("div",{className:"text-center mb-2",children:[a.jsx("div",{className:"w-14 h-14 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-3 border border-purple-400/30",children:a.jsx(Dl,{size:28,className:"text-purple-400"})}),a.jsx("h3",{className:"text-white font-bold text-lg",children:"Magic Link"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Sign in without a password"})]}),K&&a.jsx("div",{className:"p-3 bg-red-900/50 border border-red-500/50 rounded-xl text-red-300 text-sm",children:K}),R&&a.jsxs("div",{className:"p-3 bg-green-900/50 border border-green-500/50 rounded-xl text-green-300 text-sm flex items-start gap-2",children:[a.jsx(xo,{size:16,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:R})]}),a.jsxs("form",{onSubmit:M,className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(bn,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),a.jsx("input",{type:"email",value:m,onChange:X=>y(X.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-800/80 rounded-xl text-white border border-slate-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500/50 focus:outline-none transition-all",placeholder:"your@email.com",required:!0,autoComplete:"email"})]}),a.jsx("button",{type:"submit",disabled:P||!!R,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-violet-600 text-white font-bold rounded-xl hover:from-purple-500 hover:to-violet-500 transition-all flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(139,92,246,0.25)] disabled:opacity-50 border border-purple-400/30",children:P?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Dl,{size:18}),a.jsx("span",{children:"Send Magic Link"})]})})]}),a.jsx("p",{className:"text-slate-500 text-xs text-center",children:" We'll send a link to your email that signs you in instantly"})]}),De={glow1:{color:"bg-cyan-500/35",pos:"top-20 left-10"},glow2:{color:"bg-blue-500/30",pos:"bottom-32 right-10"},glow3:{color:"bg-purple-500/20",pos:"top-1/2 left-1/2"},cardBg:"bg-gradient-to-br from-slate-900/95 via-cyan-950/40 to-slate-900/95",cardBorder:"border-cyan-500/40",cardShadow:"shadow-[0_0_50px_rgba(34,211,238,0.3),inset_0_0_20px_rgba(34,211,238,0.05)]"},se=x?x?{glow1:{color:"bg-amber-500/35",pos:"top-20 left-10"},glow2:{color:"bg-orange-500/30",pos:"bottom-32 right-10"},glow3:{color:"bg-yellow-500/20",pos:"top-1/2 left-1/2"},cardBg:"bg-gradient-to-br from-slate-900/95 via-amber-950/40 to-slate-900/95",cardBorder:"border-amber-500/40",cardShadow:"shadow-[0_0_50px_rgba(251,191,36,0.3),inset_0_0_20px_rgba(251,191,36,0.05)]"}:De:De;return a.jsxs("div",{className:"min-h-screen bg-transparent flex flex-col",style:fe,children:[a.jsx("div",{className:`fixed ${se.glow1.pos} w-80 h-80 ${se.glow1.color} rounded-full blur-3xl pointer-events-none transition-all duration-700`}),a.jsx("div",{className:`fixed ${se.glow2.pos} w-72 h-72 ${se.glow2.color} rounded-full blur-3xl pointer-events-none transition-all duration-700`}),a.jsx("div",{className:`fixed ${se.glow3.pos} w-64 h-64 ${se.glow3.color} rounded-full blur-3xl pointer-events-none transition-all duration-700`}),a.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center p-4 pt-12 sm:pt-16",style:{paddingTop:"max(48px, env(safe-area-inset-top))",paddingBottom:"max(80px, env(safe-area-inset-bottom))"},children:[a.jsx("div",{className:"flex-shrink-0 h-8 sm:h-16 md:h-24"}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"text-center mb-3",children:a.jsx(Ii,{size:"large"})}),a.jsx("p",{className:"text-slate-400 text-sm mb-4 text-center max-w-xs px-2",children:x?" Sign in to accept your game challenge!":"Strategic pentomino puzzle battles. Challenge the AI, solve puzzles, or compete online!"}),a.jsxs("div",{className:`w-full max-w-sm ${se.cardBg} backdrop-blur-md rounded-2xl p-5 border ${se.cardBorder} ${se.cardShadow} transition-all duration-500`,children:[S==="select"&&Ye(),S==="login"&&pt(),S==="signup"&&at(),S==="forgot-password"&&et(),S==="magic-link"&&lt()]})]}),a.jsx("div",{className:"flex-1"})]}),a.jsx("div",{className:"relative z-10 text-center pb-5 px-4",style:{paddingBottom:"max(20px, env(safe-area-inset-bottom))"},children:a.jsx("p",{className:"text-slate-600 text-xs",children:" 2025 Deadblock. All rights reserved."})}),a.jsx("style",{children:`
        @keyframes shine {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(200%); }
        }
        .group:hover .group-hover\\:animate-shine {
          animation: shine 1.5s ease-in-out;
        }
      `})]})},S_=({username:t,onClose:e,onEditUsername:r})=>{const[n,s]=w.useState(0),i=[{icon:hg,iconColor:"text-amber-400",iconBg:"from-amber-500 to-orange-600",title:"Welcome to Deadblock!",content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-slate-300",children:["You've joined the ultimate ",a.jsx("span",{className:"text-cyan-400 font-bold",children:"pentomino puzzle"})," battle arena!"]}),a.jsx("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-cyan-500/20",children:a.jsxs("p",{className:"text-sm text-slate-400",children:["Your goal: ",a.jsx("span",{className:"text-white font-medium",children:"Place pieces strategically to block your opponent"})," from making any moves."]})})]})},{icon:fg,iconColor:"text-cyan-400",iconBg:"from-cyan-500 to-blue-600",title:"Your Profile",content:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-slate-300",children:"Your username is currently:"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-cyan-500/30 flex items-center justify-between",children:[a.jsx("span",{className:"text-cyan-400 font-bold text-lg",children:t}),a.jsxs("button",{onClick:()=>{J.playButtonClick(),r()},className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 rounded-lg text-sm font-medium transition-colors",children:[a.jsx(ug,{size:14}),"Change"]})]}),a.jsx("p",{className:"text-sm text-slate-500",children:"You can change your username anytime by tapping your profile card on the main menu."})]})},{icon:cg,iconColor:"text-purple-400",iconBg:"from-purple-500 to-pink-600",title:"Game Modes",content:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3 bg-slate-800/40 rounded-lg p-3 border border-slate-700/50",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Va,{size:16,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold text-sm",children:"VS AI"}),a.jsx("p",{className:"text-slate-400 text-xs",children:"Practice against computer opponents"})]})]}),a.jsxs("div",{className:"flex items-start gap-3 bg-slate-800/40 rounded-lg p-3 border border-slate-700/50",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500 to-yellow-600 flex items-center justify-center flex-shrink-0",children:a.jsx(pg,{size:16,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold text-sm",children:"Online"}),a.jsx("p",{className:"text-slate-400 text-xs",children:"Challenge friends & climb the leaderboard"})]})]}),a.jsxs("div",{className:"flex items-start gap-3 bg-slate-800/40 rounded-lg p-3 border border-slate-700/50",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(p1,{size:16,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold text-sm",children:"Puzzles"}),a.jsx("p",{className:"text-slate-400 text-xs",children:"Solve challenges & test your skills"})]})]})]})},{icon:wr,iconColor:"text-amber-400",iconBg:"from-amber-500 to-yellow-600",title:"Earn & Progress",content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-slate-300",children:["Win online matches to ",a.jsx("span",{className:"text-amber-400 font-bold",children:"increase your ELO rating"})," and climb through the ranks!"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 border border-slate-700/50 text-center",children:[a.jsx("span",{className:"text-slate-500",children:"Novice"}),a.jsx("div",{className:"text-slate-400 font-bold",children:"0+"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 border border-slate-700/50 text-center",children:[a.jsx("span",{className:"text-green-400",children:"Intermediate"}),a.jsx("div",{className:"text-green-400 font-bold",children:"1400+"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 border border-slate-700/50 text-center",children:[a.jsx("span",{className:"text-purple-400",children:"Master"}),a.jsx("div",{className:"text-purple-400 font-bold",children:"2000+"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 border border-slate-700/50 text-center",children:[a.jsx("span",{className:"text-amber-400",children:"Grandmaster"}),a.jsx("div",{className:"text-amber-400 font-bold",children:"2200+"})]})]}),a.jsx("p",{className:"text-sm text-slate-500 text-center",children:"Unlock achievements as you progress!"})]})}],o=i[n],l=n===i.length-1,c=o.icon,u=()=>{J.playButtonClick(),l?e():s(h=>h+1)},d=()=>{J.playButtonClick(),e()};return a.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-sm bg-slate-900 rounded-2xl border border-cyan-500/30 shadow-[0_0_60px_rgba(34,211,238,0.2)] overflow-hidden animate-scaleIn",children:[a.jsxs("div",{className:`bg-gradient-to-r ${o.iconBg} p-5 relative`,children:[a.jsx("button",{onClick:d,className:"absolute top-3 right-3 p-1.5 text-white/60 hover:text-white transition-colors rounded-full hover:bg-white/10",children:a.jsx(ur,{size:18})}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center mb-3 shadow-lg",children:a.jsx(c,{size:32,className:"text-white"})}),a.jsx("h2",{className:"text-xl font-black text-white text-center",children:o.title})]}),a.jsx("div",{className:"flex justify-center gap-2 mt-4",children:i.map((h,f)=>a.jsx("div",{className:`h-1.5 rounded-full transition-all ${f===n?"w-6 bg-white":f<n?"w-1.5 bg-white/60":"w-1.5 bg-white/30"}`},f))})]}),a.jsx("div",{className:"p-5",children:o.content}),a.jsxs("div",{className:"px-5 pb-5 flex gap-3",children:[!l&&a.jsx("button",{onClick:d,className:"flex-1 py-3 rounded-xl font-bold text-slate-400 bg-slate-800/50 hover:bg-slate-800 transition-colors border border-slate-700/50",children:"Skip"}),a.jsxs("button",{onClick:u,className:`flex-1 py-3 rounded-xl font-bold text-white transition-all active:scale-[0.98] flex items-center justify-center gap-2 ${l?"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 shadow-[0_0_20px_rgba(34,211,238,0.4)]":"bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600"}`,children:[l?"Let's Play!":"Next",a.jsx(Tn,{size:18})]})]})]})})},k_=()=>{const[t,e]=w.useState(!1),[r,n]=w.useState(!0);w.useEffect(()=>{const o=navigator.userAgent||"",l=navigator.platform||"",c=/iPhone|iPad|iPod/.test(o)||l==="MacIntel"&&navigator.maxTouchPoints>1,u=/Macintosh/.test(o)&&/Safari/.test(o)&&!/Chrome/.test(o),d=window.navigator.standalone===!0||window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||window.matchMedia("(display-mode: minimal-ui)").matches||document.referrer.includes("android-app://")||window.matchMedia("(display-mode: window-controls-overlay)").matches,h=window.navigator.standalone||window.location.search.includes("utm_source=homescreen")||sessionStorage.getItem("pwa-launched")==="true";let f=!1;try{f=localStorage.getItem("pwa-was-installed")==="true"}catch{}if(d)try{sessionStorage.setItem("pwa-launched","true"),localStorage.setItem("pwa-was-installed","true")}catch{}const p=/Safari/.test(o)&&!/CriOS/.test(o)&&!/FxiOS/.test(o)&&!/OPiOS/.test(o)&&!/EdgiOS/.test(o)&&!/Chrome/.test(o)&&!/Chromium/.test(o);n(p||u);let v=!1;try{const g=localStorage.getItem("ios-pwa-dismissed");g&&(v=(Date.now()-parseInt(g))/864e5<7)}catch(g){console.log("localStorage error:",g)}if(console.log("[PWA Install Prompt - iOS/Safari]",{isIOS:c,isMacSafari:u,isStandalone:d,isLaunchedFromHomeScreen:h,wasInstalled:f,isSafari:p,wasDismissed:v,ua:o.substring(0,100),platform:l}),(c||u)&&!(d||h||f)&&!v){const g=setTimeout(()=>{console.log("[PWA Install Prompt - iOS/Safari] Showing prompt"),e(!0)},3e3);return()=>clearTimeout(g)}},[]);const s=()=>{e(!1);try{localStorage.setItem("pwa-was-installed","true"),localStorage.setItem("ios-pwa-dismissed",Date.now().toString())}catch{}},i=()=>{e(!1);try{localStorage.setItem("pwa-was-installed","true"),localStorage.setItem("ios-pwa-dismissed",(Date.now()+10*365*24*60*60*1e3).toString())}catch{}};return t?a.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-end justify-center z-[9999] p-4",onClick:s,children:[a.jsxs("div",{className:"bg-slate-900 rounded-2xl p-5 max-w-sm w-full border border-cyan-500/40 shadow-[0_0_30px_rgba(34,211,238,0.4)] mb-4",onClick:o=>o.stopPropagation(),style:{animation:"slideUp 0.3s ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-11 h-11 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-xl flex items-center justify-center",children:a.jsx("span",{className:"text-xl",children:""})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-bold text-cyan-300",children:"Install Deadblock"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Add to Home Screen"})]})]}),a.jsx("button",{onClick:s,className:"p-1 text-slate-500 hover:text-white",children:a.jsx(ur,{size:20})})]}),r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 p-3 bg-slate-800/60 rounded-lg",children:[a.jsx("div",{className:"w-7 h-7 bg-cyan-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-cyan-400 font-bold text-sm",children:"1"})}),a.jsxs("p",{className:"text-slate-200 text-sm flex-1",children:["Tap the ",a.jsx("span",{className:"text-cyan-400 font-semibold",children:"Share"})," button"]}),a.jsx("div",{className:"w-9 h-9 bg-slate-700 rounded-lg flex items-center justify-center",children:a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"}),a.jsx("polyline",{points:"16 6 12 2 8 6"}),a.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-3 p-3 bg-slate-800/60 rounded-lg",children:[a.jsx("div",{className:"w-7 h-7 bg-purple-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-purple-400 font-bold text-sm",children:"2"})}),a.jsxs("p",{className:"text-slate-200 text-sm flex-1",children:["Scroll down and tap ",a.jsx("span",{className:"text-purple-400 font-semibold",children:'"Add to Home Screen"'})]}),a.jsx("div",{className:"w-9 h-9 bg-slate-700 rounded-lg flex items-center justify-center",children:a.jsx(f1,{size:18,className:"text-purple-400"})})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-slate-800/60 rounded-lg",children:[a.jsx("div",{className:"w-7 h-7 bg-green-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-green-400 font-bold text-sm",children:"3"})}),a.jsxs("p",{className:"text-slate-200 text-sm flex-1",children:["Tap ",a.jsx("span",{className:"text-green-400 font-semibold",children:'"Add"'})," in the top right corner"]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-500 text-xs mb-4",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Share button is at the bottom of Safari"}),a.jsx("span",{children:""})]})]}):a.jsxs("div",{className:"mb-4",children:[a.jsxs("p",{className:"text-slate-300 text-sm mb-3",children:["To install this app, please open this page in ",a.jsx("span",{className:"text-cyan-400 font-bold",children:"Safari"}),"."]}),a.jsxs("div",{className:"p-3 bg-slate-800/60 rounded-lg",children:[a.jsx("p",{className:"text-slate-400 text-xs",children:" Copy this URL and paste it in Safari:"}),a.jsx("p",{className:"text-cyan-400 text-xs mt-1 break-all font-mono",children:window.location.origin})]}),a.jsx("p",{className:"text-slate-500 text-xs mt-3",children:"PWA installation requires Safari on iOS devices."})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:i,className:"flex-1 py-2.5 bg-slate-800 text-slate-400 rounded-lg text-xs font-semibold hover:bg-slate-700 transition-colors",children:"Don't show again"}),a.jsx("button",{onClick:s,className:"flex-1 py-2.5 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-lg text-sm font-semibold hover:opacity-90 transition-opacity",children:"Got it!"})]})]}),a.jsx("style",{children:`
        @keyframes slideUp {
          from { 
            opacity: 0; 
            transform: translateY(50px); 
          }
          to { 
            opacity: 1; 
            transform: translateY(0); 
          }
        }
      `})]}):null},E_=w.lazy(()=>be(()=>import("./PuzzleSelect-BbNAWsei.js"),__vite__mapDeps([0,1,2,3]))),j_=w.lazy(()=>be(()=>import("./SpeedPuzzleScreen-rYlulggE.js"),__vite__mapDeps([4,2,5]))),N_=w.lazy(()=>be(()=>import("./DifficultySelector-z7FNP3aQ.js"),__vite__mapDeps([6,1]))),C_=w.lazy(()=>be(()=>import("./WeeklyChallengeMenu-BqhD-qPz.js"),__vite__mapDeps([7,1,8,9,10,5]))),P_=w.lazy(()=>be(()=>import("./WeeklyChallengeScreen-CcMY13-p.js"),__vite__mapDeps([11,8,5,10]))),A_=w.lazy(()=>be(()=>import("./WeeklyLeaderboard-B1Apot1g.js"),__vite__mapDeps([12,8,10]))),T_=w.lazy(()=>be(()=>import("./PlayerStatsModal-DSH7rXvy.js"),__vite__mapDeps([13,8,9,14,15]))),vf=w.lazy(()=>be(()=>import("./OnlineMenu-Zq3I1gHM.js"),__vite__mapDeps([16,17,18,19,20,21,5,15,9,10,22,23,24,25]))),O_=w.lazy(()=>be(()=>import("./MatchmakingScreen-BnYnTXTP.js"),__vite__mapDeps([26,1,24,3]))),I_=w.lazy(()=>be(()=>import("./OnlineGameScreen-DNkQDosp.js"),__vite__mapDeps([27,17,19,23,10]))),R_=w.lazy(()=>be(()=>import("./UserProfile-BElF1E3B.js"),__vite__mapDeps([28,17,20,21,5,15,9,10,14]))),$_=w.lazy(()=>be(()=>import("./Leaderboard-Cfx2t2ZS.js"),__vite__mapDeps([29,15]))),z_=w.lazy(()=>be(()=>import("./SpectatorView-WDgcaXPl.js").then(t=>t.a),__vite__mapDeps([22,23]))),L_=w.lazy(()=>be(()=>import("./GameReplay-DyvkTJ-H.js"),__vite__mapDeps([30,10,25,21,5])));function M_({onBgThemeChange:t}){const[e,r]=w.useState(!1),[n,s]=w.useState(null),[i,o]=w.useState(!1),[l,c]=w.useState(()=>localStorage.getItem("deadblock_pending_invite_code")||null),[u,d]=w.useState(null),[h,f]=w.useState(!1),[p,v]=w.useState(null),[x,S]=w.useState(!1),[g,m]=w.useState(!1),[y,b]=w.useState(!1),[E,j]=w.useState(()=>localStorage.getItem("deadblock_pending_auth_destination")||"online-menu"),[_,k]=w.useState(()=>localStorage.getItem("deadblock_entry_auth_passed")==="true");w.useEffect(()=>{_&&localStorage.setItem("deadblock_entry_auth_passed","true")},[_]);const[O,P]=w.useState(()=>localStorage.getItem("deadblock_pending_online_intent")==="true"),[Z,K]=w.useState(null),[ne,R]=w.useState(null),[D,I]=w.useState(null),{isAuthenticated:W,loading:N,isOnlineEnabled:A,isOAuthCallback:L,clearOAuthCallback:B,profile:te,isNewUser:H,clearNewUser:C}=Fi();Jb();const[M,U]=w.useState(!1),[V,z]=w.useState(!1);w.useEffect(()=>{H&&te&&!M&&U(!0)},[H,te,M]),w.useEffect(()=>{const Ne=new URLSearchParams(window.location.search).get("invite");Ne&&(c(Ne),localStorage.setItem("deadblock_pending_invite_code",Ne),window.history.replaceState({},document.title,"/"),A&&(async()=>{f(!0),v(null);try{const{inviteService:bt}=await be(async()=>{const{inviteService:hn}=await import("./inviteService-DhtWqPFk.js");return{inviteService:hn}},[]),{data:Vt,error:_t}=await bt.getInviteByCode(Ne);Vt&&!_t?d(Vt):_t&&v(_t.message)}catch(bt){console.error("App: Error fetching invite info:",bt),v(bt.message||"Failed to load invite")}finally{f(!1)}})())},[A]);const ue=Pf.useRef(null);ue.current=async ee=>{const Ne=l||localStorage.getItem("deadblock_pending_invite_code");if(Ne&&W&&te?.id&&A)try{const{inviteService:hr}=await be(async()=>{const{inviteService:_t}=await import("./inviteService-DhtWqPFk.js");return{inviteService:_t}},[]),{data:bt,error:Vt}=await hr.acceptInviteByCode(Ne,te.id);bt?.success&&bt?.game_id?(c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code"),(!localStorage.getItem("deadblock_has_played_online")||H)&&(z(!0),localStorage.setItem("deadblock_has_played_online","true")),s(bt.game_id),ee&&ee("online-game")):Vt?(Vt.message!=="Cannot accept your own invite"&&alert(Vt.message),c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code"),ee&&ee("online-menu")):(c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code"),ee&&ee("online-menu"))}catch(hr){console.error("App: Error accepting invite:",hr),c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code")}},w.useEffect(()=>{const ee=window.location.pathname,hr=window.location.hash.includes("access_token=")||window.location.search.includes("code=");ee.includes("/auth/callback")&&!hr&&window.history.replaceState({},document.title,"/")},[]);const{board:fe,boardPieces:we,currentPlayer:_e,selectedPiece:Ye,rotation:pt,flipped:at,gameOver:et,winner:lt,usedPieces:De,moveHistory:Je,gameMode:se,isAIThinking:X,pendingMove:ye,setPendingMove:ge,currentPuzzle:ae,showHowToPlay:tt,showSettings:$,aiDifficulty:le,isGeneratingPuzzle:Ee,puzzleDifficulty:ve,aiAnimatingMove:Be,playerAnimatingMove:$e,setGameMode:F,setShowHowToPlay:pe,setShowSettings:re,setAiDifficulty:je,handleCellClick:Se,confirmMove:Wt,cancelMove:It,movePendingPiece:Fe,resetGame:dr,loadPuzzle:Ht,startNewGame:zr,selectPiece:Lr,rotatePiece:Mr,flipPiece:br,resetCurrentPuzzle:mt}=Wb();w.useEffect(()=>{if(!t)return;const Ne={null:"menu",undefined:"menu",auth:"auth","online-menu":"online","online-game":"online",matchmaking:"online",puzzle:"puzzle","puzzle-select":"puzzle","speed-puzzle":"puzzle","weekly-menu":"puzzle","weekly-challenge":"puzzle","weekly-leaderboard":"puzzle","difficulty-select":"game",ai:"game",local:"game",profile:"online",leaderboard:"online"}[String(se)]||"menu";t(Ne)},[se,t]),w.useEffect(()=>{!N&&W&&!_&&(k(!0),(O||localStorage.getItem("deadblock_pending_online_intent")==="true")&&(localStorage.removeItem("deadblock_pending_online_intent"),P(!1),S(!1),F("online-menu")))},[N,W,_,O,F]),w.useEffect(()=>{ue.current&&ue.current(F)},[l,W,te?.id,A,F]),w.useEffect(()=>{(l||localStorage.getItem("deadblock_pending_invite_code"))&&!W&&!N&&A&&se===null&&F("auth")},[l,W,N,A,se,F]),w.useEffect(()=>{const ee=localStorage.getItem("deadblock_pending_invite_code");if(L&&W&&!N&&!i){const Ne=l||ee;if(Ne&&!te?.id)return;(async()=>{B?.();const bt=O||localStorage.getItem("deadblock_pending_online_intent")==="true";if(localStorage.removeItem("deadblock_pending_online_intent"),P(!1),k(!0),S(!1),b(!1),Ne&&te?.id){try{const{inviteService:Vt}=await be(async()=>{const{inviteService:Ur}=await import("./inviteService-DhtWqPFk.js");return{inviteService:Ur}},[]),{data:_t,error:hn}=await Vt.acceptInviteByCode(Ne,te.id);if(_t?.success&&_t?.game_id){c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code"),o(!0),s(_t.game_id),F("online-game");return}else hn&&hn.message!=="Cannot accept your own invite"&&alert(hn.message)}catch(Vt){console.error("Error accepting invite:",Vt)}c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code")}o(!0),F(bt||_?"online-menu":null)})()}},[L,W,N,i,_,te,O,l,F,B]),w.useEffect(()=>{const ee=()=>{r("ontouchstart"in window||navigator.maxTouchPoints>0)};return ee(),window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[]);const Dr=ee=>{if(ee==="ai")F("difficulty-select");else if(ee==="online"){if(!A){alert("Online features are not configured. Please set up Supabase.");return}if(x&&!W){localStorage.setItem("deadblock_pending_online_intent","true"),localStorage.setItem("deadblock_pending_auth_destination","online-menu"),P(!0),j("online-menu"),b(!0);return}F(W?"online-menu":"auth")}else zr(ee)},Ka=()=>{k(!0),S(!1)},Ya=()=>{k(!0),S(!0)},ce=()=>{const ee=E||"online-menu";localStorage.removeItem("deadblock_pending_online_intent"),localStorage.removeItem("deadblock_pending_auth_destination"),P(!1),j("online-menu"),b(!1),S(!1),F(ee)},Dn=()=>{if(!A){alert("Online features are not configured. Please set up Supabase.");return}if(x&&!W){localStorage.setItem("deadblock_pending_online_intent","true"),localStorage.setItem("deadblock_pending_auth_destination","weekly-menu"),P(!0),j("weekly-menu"),b(!0);return}if(!W){F("auth");return}F("weekly-menu")},Ja=ee=>{I(ee),F("weekly-game")},Is=ee=>{I(ee),F("weekly-leaderboard")},Wi=(ee=!1)=>{zr("ai",ee)},dn=ee=>{Ht(ee)},Sg=ee=>{s(ee.id),F("online-game")},kg=ee=>{s(null),F("online-menu")},bd=ee=>{if(!ee?.id){console.error("handleResumeGame: No game ID!");return}s(ee.id),F("online-game")},_d=ee=>{K(ee),F("spectate")},Sd=ee=>{R(ee),F("replay")};w.useEffect(()=>{const ee=_t=>{if(console.log("[App] Received service worker message:",_t.data),_t.data?.type==="NOTIFICATION_CLICK"){const{data:hn}=_t.data,{gameId:Ur,type:Xa,inviteId:B_,rematchId:F_,openChat:Qa}=hn||{};if(console.log("[App] Processing notification click:",{gameId:Ur,notificationType:Xa,openChat:Qa}),!_){console.log("[App] Not past entry auth, storing for later navigation"),Ur&&sessionStorage.setItem("deadblock_pending_game_id",Ur),Qa&&sessionStorage.setItem("deadblock_open_chat","true"),Xa==="weekly_challenge"?sessionStorage.setItem("deadblock_pending_nav","weekly"):sessionStorage.setItem("deadblock_pending_nav","online"),localStorage.setItem("deadblock_pending_online_intent","true");return}Ur?(console.log("[App] Navigating to game:",Ur),Qa&&sessionStorage.setItem("deadblock_open_chat","true"),s(Ur),F("online-game")):Xa==="weekly_challenge"?(console.log("[App] Navigating to weekly challenge menu"),F("weekly-menu")):(console.log("[App] Navigating to online menu"),F("online-menu"))}};"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",ee);const Ne=new URLSearchParams(window.location.search),hr=Ne.get("navigateTo"),bt=Ne.get("gameId");Ne.get("rematchGameId");const Vt=Ne.get("openChat");return hr==="online"?(console.log("[App] URL params detected - gameId:",bt),bt&&sessionStorage.setItem("deadblock_pending_game_id",bt),Vt==="true"&&sessionStorage.setItem("deadblock_open_chat","true"),sessionStorage.setItem("deadblock_pending_nav","online"),window.history.replaceState({},document.title,"/")):hr==="weekly"&&(sessionStorage.setItem("deadblock_pending_nav","weekly"),window.history.replaceState({},document.title,"/")),()=>{"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",ee)}},[]),w.useEffect(()=>{if(!_)return;const ee=sessionStorage.getItem("deadblock_pending_nav"),Ne=sessionStorage.getItem("deadblock_pending_game_id");ee==="online"?(console.log("[App] Processing pending online navigation, gameId:",Ne),sessionStorage.removeItem("deadblock_pending_nav"),sessionStorage.removeItem("deadblock_pending_game_id"),setTimeout(()=>{Ne?(console.log("[App] Setting online game:",Ne),s(Ne),F("online-game")):F("online-menu")},100)):ee==="weekly"&&(console.log("[App] Processing pending weekly navigation"),sessionStorage.removeItem("deadblock_pending_nav"),setTimeout(()=>{F("weekly-menu")},100))},[_,F,s]);const[Eg,kd]=w.useState(!1),Ed=A&&(N||L&&!te);w.useEffect(()=>{if(Ed){const ee=setTimeout(()=>{kd(!0)},5e3),Ne=setTimeout(()=>{B&&B(),!_&&W&&k(!0),(O||localStorage.getItem("deadblock_pending_online_intent")==="true")&&(localStorage.removeItem("deadblock_pending_online_intent"),P(!1),S(!1),W&&F("online-menu"))},1e4);return()=>{clearTimeout(ee),clearTimeout(Ne)}}else kd(!1)},[Ed,B,_,W,O,F]);const jg=A&&(N||L&&!i);return L&&W&&!N&&!i?(setTimeout(()=>{o(!0),B?.(),k(!0),S(!1);const ee=O||localStorage.getItem("deadblock_pending_online_intent")==="true";localStorage.removeItem("deadblock_pending_online_intent"),P(!1),F(ee?"online-menu":null)},0),a.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center",children:[a.jsx("div",{className:"fixed inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"linear-gradient(rgba(251,191,36,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(251,191,36,0.3) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),a.jsx("div",{className:"relative z-10 mb-8",children:a.jsx(Ii,{size:"large"})}),a.jsx("div",{className:"relative z-10 w-12 h-12 border-4 border-amber-400 border-t-transparent rounded-full animate-spin mb-4"}),a.jsx("p",{className:"relative z-10 text-amber-300 text-sm font-medium tracking-wider",children:"WELCOME BACK..."})]})):jg?a.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center",children:[a.jsx("div",{className:"fixed inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"linear-gradient(rgba(251,191,36,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(251,191,36,0.3) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),a.jsx("div",{className:"relative z-10 mb-8",children:a.jsx(Ii,{size:"large"})}),a.jsx("div",{className:"relative z-10 w-12 h-12 border-4 border-amber-400 border-t-transparent rounded-full animate-spin mb-4"}),a.jsx("p",{className:"relative z-10 text-amber-300 text-sm font-medium tracking-wider",children:L?"SIGNING YOU IN...":"LOADING..."}),Eg&&a.jsxs("div",{className:"relative z-10 mt-6 text-center",children:[a.jsx("p",{className:"text-slate-400 text-xs mb-3",children:"Taking longer than expected..."}),a.jsx("button",{onClick:()=>{Object.keys(localStorage).forEach(ee=>{(ee.startsWith("sb-")||ee.includes("supabase"))&&localStorage.removeItem(ee)}),localStorage.removeItem("deadblock_pending_online_intent"),sessionStorage.clear(),window.location.replace("/")},className:"px-4 py-2 bg-slate-700 text-slate-300 rounded-lg text-sm hover:bg-slate-600",children:"Reset & Reload"})]})]}):!_&&!N&&!L&&!W?a.jsx(Fl,{onComplete:Ka,onOfflineMode:Ya}):y?a.jsx(Fl,{onComplete:ce,onOfflineMode:()=>{localStorage.removeItem("deadblock_pending_online_intent"),localStorage.removeItem("deadblock_pending_auth_destination"),P(!1),j("online-menu"),b(!1)},forceOnlineOnly:!1,intendedDestination:E}):se==null?(W&&!_&&setTimeout(()=>k(!0),0),a.jsxs(a.Fragment,{children:[a.jsx(U1,{onStartGame:Dr,onPuzzleSelect:()=>F("puzzle-select"),onWeeklyChallenge:Dn,showHowToPlay:tt,onToggleHowToPlay:pe,showSettings:$,onToggleSettings:re,isOnlineEnabled:A,isAuthenticated:W,isOfflineMode:x,onShowProfile:()=>m(!0),onSignIn:()=>F("auth"),onPuzzleHover:b_,onOnlineHover:w_,onWeeklyHover:__}),a.jsx(u_,{children:a.jsx(T_,{isOpen:g,onClose:()=>m(!1),isOffline:x})}),M&&te&&a.jsx(S_,{username:te.username||te.display_name||"Player",onClose:()=>{U(!1),C()},onEditUsername:()=>{U(!1),C(),m(!0)}})]})):se==="auth"?a.jsx(Fl,{onComplete:()=>{(l||localStorage.getItem("deadblock_pending_invite_code"))&&te?.id?F(null):F("online-menu")},onOfflineMode:()=>{c(null),d(null),v(null),localStorage.removeItem("deadblock_pending_invite_code"),F(null)},inviteInfo:u,inviteLoading:h,inviteError:p,onCancelInvite:()=>{c(null),d(null),localStorage.removeItem("deadblock_pending_invite_code"),v(null),F(null)},forceOnlineOnly:!!u}):se==="online-menu"?a.jsx(St,{message:"Loading online lobby...",children:a.jsx(vf,{onFindMatch:()=>F("matchmaking"),onViewProfile:()=>F("profile"),onViewLeaderboard:()=>F("leaderboard"),onResumeGame:bd,onSpectateGame:_d,onViewReplay:Sd,onBack:()=>F(null)})}):se==="matchmaking"?a.jsx(St,{message:"Finding opponents...",children:a.jsx(O_,{onMatchFound:Sg,onCancel:()=>F("online-menu")})}):se==="online-game"?n?a.jsx(St,{message:"Loading game...",children:a.jsx(I_,{gameId:n,onGameEnd:kg,onLeave:()=>{s(null),F("online-menu")},showTutorial:V,onTutorialClose:()=>z(!1)})}):(console.error("online-game mode but no gameId, redirecting to menu"),a.jsx(St,{message:"Loading online lobby...",children:a.jsx(vf,{onFindMatch:()=>F("matchmaking"),onViewProfile:()=>F("profile"),onViewLeaderboard:()=>F("leaderboard"),onResumeGame:bd,onSpectateGame:_d,onViewReplay:Sd,onBack:()=>F(null)})})):se==="profile"?a.jsx(St,{message:"Loading profile...",children:a.jsx(R_,{onBack:()=>F("online-menu")})}):se==="leaderboard"?a.jsx(St,{message:"Loading leaderboard...",children:a.jsx($_,{onBack:()=>F("online-menu")})}):se==="spectate"?a.jsx(St,{message:"Loading spectator view...",children:a.jsx(z_,{gameId:Z,userId:te?.id,onClose:()=>{K(null),F("online-menu")}})}):se==="replay"?a.jsx(St,{message:"Loading replay...",children:a.jsx(L_,{gameId:ne,onClose:()=>{R(null),F("online-menu")}})}):se==="difficulty-select"?a.jsx(St,{message:"Loading difficulty selector...",children:a.jsx(N_,{selectedDifficulty:le,onSelectDifficulty:je,onStartGame:Wi,onBack:()=>F(null)})}):se==="puzzle-select"?a.jsx(St,{message:"Loading puzzle mode...",children:a.jsx(E_,{onSelectPuzzle:dn,onSpeedMode:()=>F("speed-puzzle"),onBack:()=>F(null)})}):se==="speed-puzzle"?a.jsx(St,{message:"Loading speed puzzle...",children:a.jsx(j_,{onMenu:()=>F("puzzle-select"),isOfflineMode:x})}):se==="weekly-menu"?a.jsx(St,{message:"Loading weekly challenge...",children:a.jsx(C_,{onPlay:Ja,onLeaderboard:Is,onBack:()=>F(null)})}):se==="weekly-game"?a.jsx(St,{message:"Starting challenge...",children:a.jsx(P_,{challenge:D,onMenu:()=>F("weekly-menu"),onLeaderboard:Is})}):se==="weekly-leaderboard"?a.jsx(St,{message:"Loading leaderboard...",children:a.jsx(A_,{challenge:D,onBack:()=>F("weekly-menu")})}):a.jsx(t_,{board:fe,boardPieces:we,currentPlayer:_e,selectedPiece:Ye,rotation:pt,flipped:at,gameOver:et,winner:lt,usedPieces:De,moveHistory:Je,gameMode:se,isAIThinking:X,pendingMove:ye,currentPuzzle:ae,aiDifficulty:le,puzzleDifficulty:ve,isMobile:e,isGeneratingPuzzle:Ee,aiAnimatingMove:Be,playerAnimatingMove:$e,moveCount:Je.length,setPendingMove:ge,onCellClick:Se,onSelectPiece:Lr,onRotate:Mr,onFlip:br,onConfirm:Wt,onCancel:It,onMovePiece:Fe,onReset:dr,onRetryPuzzle:mt,onMenu:()=>F(null),onQuitGame:ee=>{F(null)},onDifficultySelect:()=>F(se==="puzzle"?"puzzle-select":"difficulty-select")})}function D_(){const[t,e]=w.useState("menu");return a.jsxs(Vb,{children:[a.jsx(xg,{theme:t}),a.jsx(M_,{onBgThemeChange:e}),a.jsx(k_,{})]})}Wl.createRoot(document.getElementById("root")).render(a.jsx(Pf.StrictMode,{children:a.jsx(D_,{})}));export{Qe as $,vo as A,de as B,W1 as C,yg as D,t1 as E,s1 as F,gg as G,Qs as H,as as I,cg as J,md as K,Ai as L,u1 as M,Ii as N,Ti as O,Ae as P,og as Q,ci as R,ig as S,wr as T,pg as U,A1 as V,Ga as W,ur as X,Mo as Y,Va as Z,cf as _,Ul as a,lf as a0,af as a1,C1 as a2,v1 as a3,iu as a4,ag as a5,oe as a6,Ws as a7,ug as a8,c1 as a9,o1 as aa,bn as ab,dg as ac,$1 as ad,oS as ae,Qt as af,lg as ag,Q1 as ah,os as ai,kn as aj,sS as ak,nS as al,iS as am,e1 as an,li as ao,N1 as ap,lr as b,Et as c,Lt as d,W_ as e,zc as f,yx as g,Il as h,H1 as i,a as j,F1 as k,Mt as l,Y as m,Pt as n,yd as o,Tn as p,Fi as q,w as r,J as s,Wb as t,xd as u,i1 as v,xo as w,H_ as x,Oi as y,fg as z};
